var __index = {"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"index.html","title":"Understanding OT Networks &amp; Network Security Monitoring","text":"<p>Workshop</p> <p>Instructors:</p> <ul> <li>Martin Scheu - OT Security Engineer, SWITCH</li> <li>Mischa Diehm - CTO and Network Engineer, Narrowin</li> </ul>"},{"location":"index.html#overview","title":"Overview","text":""},{"location":"index.html#lab-access-and-training-opportunities","title":"Lab Access and Training Opportunities","text":"<p>The actual labs are unfortunately not publicly published. If you are interested in accessing the labs, please contact us and lets have a chat.</p> <p>A browsable live view of the lab can be freely accessed at: Narrowin OT-Lab</p> <p>We also offer this lab as a two-day on-site training course. For more details, please visit https://www.narrowin.ch/en/courses.html. While currently delivered on-site, we are evaluating virtual training options. If you are interested, please send us a brief email.</p>"},{"location":"index.html#about-this-workshop","title":"About This Workshop","text":"<p>Operational Technology (OT) networks are fundamentally different from traditional IT networks. They connect industrial control systems, PLCs, HMIs, and field devices that control critical infrastructure and manufacturing processes. Yet many organizations struggle to gain visibility into these environments, leaving them vulnerable to security threats and compliance gaps.</p> <p>This hands-on workshop addresses the challenge of understanding and securing OT networks using practical, open-source tools. You will learn how to navigate the complexity of OT protocols, identify devices and data flows, discover blind spots, and implement effective network security monitoring tailored to industrial environments.</p> <p>Unlike vendor-centric approaches, this workshop emphasizes pragmatic solutions that can be deployed immediately in real-world OT environments.</p>"},{"location":"index.html#what-makes-ot-different","title":"What Makes OT Different","text":"<p>OT networks present unique challenges:</p> <ul> <li>Legacy protocols designed without security in mind (Modbus, S7, CIP, BACnet)</li> <li>Long lifecycles with devices that cannot be easily patched or replaced</li> <li>Real-time requirements where availability trumps confidentiality</li> <li>Limited network visibility due to flat architectures and unmanaged switches</li> <li>Heterogeneous environments mixing multiple vendors and protocols</li> <li>IT/OT convergence creating new attack surfaces</li> </ul> <p>Understanding these differences is critical for effective network segmentation and security monitoring.</p>"},{"location":"index.html#learning-objectives","title":"Learning Objectives","text":"<p>By the end of this workshop, you will be able to:</p> <ul> <li>Identify and characterize common OT protocols and their security implications</li> <li>Select monitoring points based on risk assessment and network architecture</li> <li>Configure traffic collection and forwarding for inter-zone visibility</li> <li>Discover assets and map communication patterns in OT networks</li> <li>Recognize the limits of different approaches to network security monitoring in industrial settings</li> <li>Apply segmentation techniques at IT/OT boundaries and edge devices</li> </ul>"},{"location":"index.html#course-requirements","title":"Course Requirements","text":"<p>Level: Intermediate, hands-on workshop</p> <p>What You Need to Know:</p> <ul> <li>Networking fundamentals (IP addressing, VLANs, basic routing)</li> <li>Command line basics (ssh, ping, basic file operations)</li> <li>Container concepts helpful but not required (we explain what you need)</li> </ul> <p>Lab Environment:</p> <p>The lab runs in pre-configured cloud or local environments. See the Lab Guide for setup instructions.</p>"},{"location":"index.html#pre-workshop-preparation","title":"Pre-Workshop Preparation","text":"<p>No software installation required. The lab runs in the cloud via GitHub Codespaces or locally via DevPod.</p> <p>Before the workshop:</p> <ol> <li>Ensure you have a GitHub account</li> <li>Review the Lab Guide for environment setup options</li> <li>Important: If possible, start your Codespace before the workshop. Initial setup takes 5-10 minutes to download and configure container images. Subsequent starts are under 1 minute.</li> <li>Optional: Familiarize yourself with basic Linux command line and networking concepts</li> </ol>"},{"location":"index.html#what-you-will-take-away","title":"What You Will Take Away","text":"<ul> <li>Practical experience with open-source OT lab environments</li> <li>Working knowledge of OT protocol analysis</li> <li>Detection use cases applicable to your environment</li> <li>Hands-on lab environment you can continue using after the workshop</li> <li>Network with peers facing similar OT security challenges</li> </ul>"},{"location":"index.html#questions","title":"Questions?","text":"<p>For technical questions or special requirements, contact the instructors before the workshop:</p> <ul> <li>Martin Scheu: martin.scheu@switch.ch</li> <li>Mischa Diehm: mischa.diehm@narrowin.com</li> </ul> <p>We look forward to working with you during the workshop.</p>"},{"location":"Container101.html","title":"Container101","text":""},{"location":"Container101.html#why-this-page-exists","title":"Why This Page Exists","text":"<p>You're an OT professional working with PLCs, HMIs, industrial networks, and protocols like Modbus or PROFINET. You might have heard about Docker and containers but never really needed them. Now, for this workshop, we're using Containerlab, which is built on container technology.</p> <p>This page explains what containers are, why they're perfect for our OT security and networking workshop, and why there's nothing to fear.</p>"},{"location":"Container101.html#the-simple-truth-about-containers","title":"The Simple Truth About Containers","text":"<p>Containers are just a way to package and run software that makes it easy to start, stop, and repeat the same setup every time.</p> <p>That's it. No magic. No hidden complexity. Everything the software needs is packaged together, and it runs the same way on any system. Like having a ready-to-go appliance instead of assembling components each time.</p>"},{"location":"Container101.html#why-containers-matter-for-this-workshop","title":"Why Containers Matter for This Workshop","text":"<p>We're building network security labs with PLCs, HMIs, switches, and security monitoring tools. Here's what containers give us:</p> <p>Fast and Repeatable Instead of installing software manually on each machine, we can start a complete lab in seconds. Need to restart? It takes seconds, not minutes or hours.</p> <p>Clean and Isolated Each component (PLC simulator, HMI, network tool) runs separately. If something breaks, you just restart that one piece.</p> <p>Easy to Share We can give you the exact same lab setup as everyone else. No \"it works on my machine\" problems.</p> <p>Lightweight You can run multiple PLCs, switches, and tools on your laptop without it melting. Containers use much less memory and CPU than traditional virtual machines.</p>"},{"location":"Container101.html#github-free-plan-what-you-get","title":"GitHub Free Plan: What You Get","text":"<p>This workshop leverages GitHub's free plan, which provides powerful tools for learning and development at no cost.</p>"},{"location":"Container101.html#github-codespaces","title":"GitHub Codespaces","text":"<p>What are Codespaces? Cloud-based development environments that run in your browser. Think of it as a complete computer with VS Code, Docker, and all workshop tools pre-installed, accessible from anywhere.</p> <p>Free Plan Includes:</p> <ul> <li>120 core-hours per month</li> <li>15 GB storage</li> <li>4-core machines available</li> </ul> <p>For this workshop: A 4-core Codespace runs this entire lab environment. 120 hours means you can run the lab for multiple full days each month at no cost.</p>"},{"location":"Container101.html#private-repositories","title":"Private Repositories","text":"<p>What you get for free:</p> <ul> <li>Unlimited private repositories</li> <li>Unlimited collaborators</li> <li>Full version control and collaboration features</li> </ul>"},{"location":"Container101.html#github-copilot","title":"GitHub Copilot","text":"<p>What it is: AI-powered coding assistant that helps you write code, understand configurations, and troubleshoot issues.</p> <p>Free for:</p> <ul> <li>Students (verified via GitHub Student Developer Pack)</li> <li>Maintainers of popular open-source projects</li> <li>Free trial available for everyone</li> </ul> <p>For this workshop: Copilot can help you understand topology files, write automation scripts, and debug network configurations. Especially useful when extending labs after the workshop.</p>"},{"location":"Container101.html#why-this-matters-for-ot-professionals","title":"Why This Matters for OT Professionals","text":"<p>You get enterprise-grade development tools without cost. No budget approval needed to start learning and experimenting with OT security labs.</p> <p>Run complete industrial network simulations in the cloud, accessible from any device. Perfect for learning at your own pace, wherever you are.</p>"},{"location":"Container101.html#security-notice-production-data","title":"Security Notice: Production Data","text":"<p>Never use production or company data with Codespaces or Copilot.</p> <p>GitHub Codespaces runs in the cloud. GitHub Copilot processes code to provide suggestions. While GitHub has security measures in place, your organization's security policies likely prohibit uploading sensitive data to external services.</p> <p>Do not use:</p> <ul> <li>Real PLC configurations from your plant</li> <li>Actual network diagrams with real IP addresses</li> <li>Production passwords or credentials</li> <li>Company-specific code or configurations</li> <li>Any data covered by NDAs or confidentiality agreements</li> </ul> <p>This workshop uses only simulated, generic lab data. Perfect for learning without security concerns.</p> <p>If you need to work with real company data, use local development environments on company-managed infrastructure, not cloud services.</p>"},{"location":"Container101.html#containers-vs-virtual-machines-what-you-need-to-know","title":"Containers vs Virtual Machines: What You Need to Know","text":"<p>You might be familiar with virtual machines (VMs). Containers are similar but much lighter.</p>"},{"location":"Container101.html#virtual-machines","title":"Virtual Machines","text":"<ul> <li>Complete operating system for each VM</li> <li>Takes minutes to start</li> <li>Uses lots of memory and disk space</li> <li>Good isolation but heavy</li> </ul>"},{"location":"Container101.html#containers","title":"Containers","text":"<ul> <li>Share the underlying operating system</li> <li>Start in seconds</li> <li>Use much less memory and disk</li> <li>Light but still isolated enough for labs</li> </ul> <p>For this workshop: Think of containers as \"lightweight VMs that start instantly.\" That's close enough.</p>"},{"location":"Container101.html#simple-comparison-table","title":"Simple Comparison Table","text":"What You Need Virtual Machine Container Start a PLC simulator Wait 2-3 minutes Ready in 2-3 seconds Run 10 different devices Heavy on your laptop Comfortable on your laptop Reset to clean state Slow shutdown and restart Instant Share exact setup with colleagues Large VM images to transfer Small container images"},{"location":"Container101.html#what-happens-in-this-workshop","title":"What Happens in This Workshop","text":"<p>You will use Containerlab through a VS Code extension. No complex commands to type. No deep technical knowledge required.</p>"},{"location":"Container101.html#what-youll-actually-do","title":"What You'll Actually Do","text":"<ol> <li>Open a topology file - A simple text file describing your lab network (which PLCs, switches, HMIs you want)</li> <li>Click \"Deploy\" in VS Code - The extension starts your entire lab</li> <li>Use your lab - Connect to devices, run security tests, capture traffic</li> <li>Click \"Destroy\" when done - Everything is removed cleanly</li> </ol> <p>That's the complete workflow. Four steps. Simple.</p>"},{"location":"Container101.html#whats-happening-behind-the-scenes-but-you-dont-need-to-worry-about-it","title":"What's Happening Behind the Scenes (But You Don't Need to Worry About It)","text":"<p>When you click \"Deploy\", Containerlab:</p> <ul> <li>Reads your topology file</li> <li>Downloads or uses pre-built container images for your devices</li> <li>Starts each device as a container</li> <li>Connects them together with virtual network cables</li> <li>Gives you access to each device</li> </ul> <p>When you're done and click \"Destroy\", everything is removed cleanly. No leftover files or configurations.</p>"},{"location":"Container101.html#common-questions-from-ot-professionals","title":"Common Questions from OT Professionals","text":"<p>Q: Is this secure enough for our lab? Yes. Containers provide good isolation for training and testing. They're used by millions of developers and companies worldwide. For our workshop, they're more than adequate.</p> <p>Q: Do I need to learn Docker commands? No. We're using the Containerlab VS Code extension, which gives you buttons to click instead of commands to type.</p> <p>Q: Can containers handle industrial protocols like Modbus, S7, or PROFINET? Yes. Containers can run any software, including industrial protocol stacks and simulators. The network traffic works exactly as you'd expect.</p> <p>Q: What if something crashes? Just redeploy that component. It's fast and gets you back to a clean state instantly.</p> <p>Q: Is this like the \"cloud\"? No. Everything runs locally on your laptop. No internet required (after initial setup). You have full control.</p> <p>Q: Can I use this after the workshop for my own testing? Absolutely. That's one of the goals - give you a tool you can use to build your own OT security and networking test labs.</p> <p>Q: Will this mess up my computer? No. Containers are isolated. When you remove them, they're completely gone. Nothing is left behind on your system.</p>"},{"location":"Container101.html#why-containerlab-specifically","title":"Why Containerlab Specifically?","text":"<p>Containerlab was designed by network engineers for network engineers. It solves the problem of quickly testing network configurations and topologies.</p> <p>Why it's perfect for OT work:</p> <ul> <li>Define your entire network topology in a simple text file</li> <li>Supports both network devices (switches, routers) and end devices (PLCs, HMIs)</li> <li>Deploy in seconds, tear down just as fast</li> <li>Works seamlessly with VS Code</li> <li>Share labs easily - just send the topology file to colleagues</li> <li>Free and open source</li> </ul> <p>Network engineers at major vendors like Nokia, Cisco, and Juniper use Containerlab daily. It's battle-tested and reliable.</p>"},{"location":"Container101.html#real-world-perspective-old-way-vs-new-way","title":"Real-World Perspective: Old Way vs New Way","text":"<p>Traditional approach: Set up physical lab or configure multiple VMs. Takes hours or days. Breaks easily. Hard to share. Painful to reset.</p> <p>Container approach: Write a text file describing your network. Click deploy. Lab ready in 30 seconds. Break something? Redeploy in 30 seconds. Share the file with colleagues who get the identical setup instantly.</p> <p>The difference: You spend time learning OT security and networking instead of fighting with infrastructure.</p>"},{"location":"Container101.html#the-truth-about-learning-curves","title":"The Truth About Learning Curves","text":"<p>You don't need to become a container expert.</p> <p>What you need to know:</p> <ul> <li>How to deploy a lab (click a button)</li> <li>How to connect to devices in the lab (same as always)</li> <li>How to destroy the lab when done (click another button)</li> </ul> <p>That's it. The Containerlab VS Code extension handles everything else.</p> <p>After this workshop, if you want to dive deeper, excellent resources exist. But for now, focus on OT security and networking. Container technology is just the tool that makes the labs work.</p>"},{"location":"Container101.html#what-makes-containers-work-for-ot-labs","title":"What Makes Containers Work for OT Labs","text":"<p>Containers excel at simulating OT environments:</p> <p>Network Behavior is Realistic Virtual network connections behave exactly like real Ethernet cables. Industrial protocols work identically. Network traffic looks the same to your monitoring tools.</p> <p>Performance is Sufficient A modern laptop comfortably runs 10-20 containerized devices. That's enough for realistic OT network topologies with multiple zones.</p> <p>State Can Be Preserved Keep your PLC configuration between sessions or start fresh each time. Your choice.</p> <p>Timing is Predictable Not suitable for hard real-time control, but perfect for testing network protocols, security monitoring, and attack scenarios.</p>"},{"location":"Container101.html#important-limitations-being-honest","title":"Important Limitations (Being Honest)","text":"<p>Let's be clear about what this is and isn't:</p> <p>Not for production These are simulations and test environments. Never put this in your actual plant network.</p> <p>Not real-time control Perfect for testing protocols and security. Not suitable for safety-critical control systems that require hard real-time guarantees.</p> <p>Not identical to real devices We use simulators that behave like your PLCs and HMIs, but they're not running your exact production firmware.</p> <p>Bottom line: For training and testing - perfect. For production control - use real, certified hardware.</p>"},{"location":"Container101.html#your-workshop-learning-path","title":"Your Workshop Learning Path","text":"<p>Before the workshop:</p> <ul> <li>Don't stress about containers. They're just a tool.</li> <li>Ensure Docker Desktop and VS Code are installed (we'll guide you).</li> <li>Trust that millions of people use this daily.</li> </ul> <p>During the workshop:</p> <ul> <li>Focus on OT security and networking, not container technology.</li> <li>Use the VS Code extension - point and click interface.</li> <li>Ask questions anytime something's unclear.</li> </ul> <p>After the workshop:</p> <ul> <li>You'll confidently build your own test labs.</li> <li>Explore more advanced features if interested.</li> <li>Understand why containers are popular in OT security and networking testing.</li> </ul>"},{"location":"Container101.html#want-to-learn-more-optional","title":"Want to Learn More? (Optional)","text":"<p>If you want to dive deeper after the workshop, these resources have helped millions of people understand containers. All are beginner-friendly:</p>"},{"location":"Container101.html#highly-recommended-videos-start-here","title":"Highly Recommended Videos (Start Here)","text":"<p>Docker in 100 Seconds by Fireship https://www.youtube.com/watch?v=Gjnup-PuquQ Quick, visual, and perfect for understanding the basics.</p> <p>you need to learn Docker RIGHT NOW by NetworkChuck https://www.youtube.com/watch?v=eGz9DS-aIeY Fun, practical, and beginner-friendly introduction.</p>"},{"location":"Container101.html#official-docker-resources","title":"Official Docker Resources","text":"<p>Docker Get Started Guide https://docs.docker.com/get-started/ Official Docker documentation, well-structured and clear.</p> <p>Docker 101 Interactive Tutorial https://www.docker.com/101-tutorial Hands-on tutorial you can do in your browser or on your machine.</p> <p>What is a Container? (Docker's explanation) https://www.docker.com/resources/what-container/ Docker's own beginner-friendly explanation.</p>"},{"location":"Container101.html#containerlab-specific","title":"Containerlab Specific","text":"<p>Containerlab Quick Start https://containerlab.dev/quickstart/ The official quick start guide - very accessible.</p> <p>Containerlab VS Code Extension https://containerlab.dev/manual/vsc-extension/ Documentation for the extension we'll use in the workshop.</p> <p>Containerlab YouTube Channel https://www.youtube.com/@containerlab Video tutorials and demonstrations.</p>"},{"location":"Container101.html#for-visual-learners","title":"For Visual Learners","text":"<p>Play with Docker https://labs.play-with-docker.com/ Free online environment to try Docker commands without installing anything.</p> <p>Docker Curriculum by Prakhar Srivastav https://docker-curriculum.com/ Beginner-friendly tutorial with clear explanations and examples.</p>"},{"location":"Container101.html#if-you-want-to-compare-with-vms","title":"If You Want to Compare with VMs","text":"<p>Containers vs Virtual Machines (IBM Technology) https://www.youtube.com/watch?v=cjXI-yxqGTI Clear video explanation of the differences.</p>"},{"location":"Container101.html#bottom-line-for-this-workshop","title":"Bottom Line for This Workshop","text":"<p>You don't need to be a container expert. You just need to know that containers are mature, proven technology used by millions of developers and companies worldwide.</p> <p>The VS Code extension does the heavy lifting. You focus on OT security and networking.</p> <p>Containers are simply the tool that lets us build fast, repeatable, shareable OT security and networking labs. That's their purpose here. They do it well.</p> <p>Ready to dive into OT security and networking? Let's go.</p>"},{"location":"agenda.html","title":"Workshop 2 Agenda (ISC-CPH \u2013 Wednesday)","text":"<p>Track: Workshop 2</p> <p>Technical Level: Intermediate</p> <p>Speakers: Martin Scheu (Switch) &amp; Mischa Diehm (Narrowin)</p>"},{"location":"agenda.html#11101150-part-1-understanding-ot-networks","title":"11:10\u201311:50 \u2014 Part 1: Understanding OT Networks","text":"<ul> <li>Title (conference): Understanding OT Networks &amp; Unfold the OT Network Jungle</li> <li>What we\u2019ll cover: OT protocols and characteristics, tools overview, basic discovery and packet capture</li> <li>Hands-on: See Lab \u2192 Part 1<ul> <li>Link: Lab Part 1</li> </ul> </li> </ul>"},{"location":"agenda.html#12501330-part-2-ot-network-security-monitoring","title":"12:50\u201313:30 \u2014 Part 2: OT Network Security Monitoring","text":"<ul> <li>Title (conference): OT Network Security Monitoring (second part of the workshop)</li> <li>What we\u2019ll cover: Monitoring points and visibility strategy; inter-zone traffic; IT/OT bridge; validating monitoring and spotting blind spots</li> <li>Hands-on: See Lab \u2192 Part 2<ul> <li>Link: Lab Part 2</li> </ul> </li> </ul>"},{"location":"agenda.html#13551430-part-3-getting-started-with-ot-network-security-monitoring","title":"13:55\u201314:30 \u2014 Part 3: Getting started with OT Network Security Monitoring","text":"<ul> <li>Title (conference): Getting started with OT Network Security Monitoring (third part of the workshop)</li> <li>What we\u2019ll cover: Detection cycle (use cases \u2192 detection \u2192 alerting \u2192 playbook \u2192 tuning); techniques to discover assets and communication patterns; testing and validating</li> <li>Hands-on: See Lab \u2192 Part 3<ul> <li>Link: Lab Part 3</li> </ul> </li> </ul> <p>Notes: - Breaks and room logistics follow the conference program (Lunch at 11:50, Refreshments at 13:30, Short Break at 14:30) - Advanced tasks are optional and marked as such in the lab guide - Aim to stay within timeboxes; instructors will call checkpoints</p>"},{"location":"automation.html","title":"Network Automation","text":""},{"location":"automation.html#why-automate","title":"Why Automate?","text":"<p>Network automation reduces manual errors, saves time, and ensures consistency across your infrastructure. After exploring this lab environment manually, you can start automating common tasks like:</p> <ul> <li>Running diagnostic commands across multiple devices</li> <li>Backing up configurations regularly</li> <li>Collecting system information for analysis</li> <li>Managing firmware updates</li> </ul> <p>This guide shows you an example on how to get started using the fully open source tool networka, a multi-vendor network automation CLI toolkit.</p>"},{"location":"automation.html#step-1-install-networka","title":"Step 1: Install networka","text":"<p>Install networka using uv or pipx:</p> <pre><code>uv tool install git+https://github.com/narrowin/networka.git\n</code></pre> <p>Verify the installation:</p> <pre><code>nw --version\n</code></pre>"},{"location":"automation.html#step-2-initialize-configuration","title":"Step 2: Initialize Configuration","text":"<p>Run the initialization command:</p> <pre><code>nw config init\n</code></pre> <p>This creates a configuration directory at <code>~/.config/networka</code> (Linux/macOS) with:</p> <ul> <li><code>devices/</code> - Device definitions</li> <li><code>groups/</code> - Device groups and tags  </li> <li><code>sequences/</code> - Reusable command sequences</li> <li><code>.env</code> - Credentials</li> </ul> <p>Follow the prompts to install shell completions and optional vendor sequences.</p>"},{"location":"automation.html#step-3-define-your-lab-devices","title":"Step 3: Define Your Lab Devices","text":"<p>Edit <code>~/.config/networka/devices/devices.yml</code> to add the lab devices:</p> <pre><code>devices:\n  router1:\n    host: 192.168.100.11\n    device_type: mikrotik_routeros\n    platform: x86\n    description: \"Gateway router\"\n    tags:\n      - gateway\n      - critical\n\n  switch1:\n    host: 192.168.100.12\n    device_type: mikrotik_routeros\n    platform: x86\n    description: \"Access switch\"\n    tags:\n      - switch\n      - access\n</code></pre> <p>Verify your devices are loaded:</p> <pre><code>nw list devices\n</code></pre> <p>You should see both devices with their IP addresses and descriptions.</p>"},{"location":"automation.html#step-4-run-your-first-command","title":"Step 4: Run Your First Command","text":"<p>Check interface status on the router using a predefined sequence:</p> <pre><code>nw run router1 interface_status\n</code></pre> <p>This connects to the device and runs multiple commands to show:</p> <ul> <li>All interfaces with their status and configuration</li> <li>Traffic statistics (packets, bytes, errors, drops)</li> <li>Ethernet port details and speeds</li> <li>Current throughput for each interface</li> </ul> <p>The output is formatted and easy to read, with clear sections for each command result.</p>"},{"location":"automation.html#step-5-explore-more-sequences","title":"Step 5: Explore More Sequences","text":"<p>Networka includes many built-in sequences for common operations. View available sequences:</p> <pre><code>nw run router1 &lt;TAB&gt;\n</code></pre> <p>Try these useful sequences:</p> <pre><code># Quick device overview\nnw run router1 quick_status\n\n# Detailed system information\nnw run router1 system_info\n\n# Check routing table\nnw run router1 routing_info\n\n# Full health check\nnw run router1 health_check\n</code></pre>"},{"location":"automation.html#step-6-back-up-configurations","title":"Step 6: Back Up Configurations","text":"<p>Create configuration backups with vendor-aware handling:</p> <pre><code># Configuration export\nnw backup config router1\n\n# Comprehensive backup (config + system data)\nnw backup comprehensive router1\n</code></pre> <p>The backups are saved to your results directory with timestamps.</p>"},{"location":"automation.html#step-7-work-with-multiple-devices","title":"Step 7: Work with Multiple Devices","text":"<p>Run commands on multiple devices at once:</p> <pre><code># Comma-separated list\nnw run router1,switch1 quick_status\n\n# Run a command across devices\nnw run router1,switch1 \"/system/resource/print\"\n</code></pre> <p>For production use, create device groups and run commands across entire groups efficiently.</p>"},{"location":"automation.html#whats-next","title":"What's Next?","text":"<p>Once comfortable with these basics:</p> <ol> <li>Create custom sequences - Define your own command workflows in YAML</li> <li>Set up device groups - Organize devices by role, location, or function</li> <li>Schedule backups - Use cron or systemd timers for automated backups</li> <li>Explore multi-vendor - networka supports MikroTik, Cisco, Arista, Juniper, and more</li> </ol> <p>Read the full documentation for advanced features like:</p> <ul> <li>Custom command sequences</li> <li>Tag-based device filtering</li> <li>Results storage and analysis</li> <li>CI/CD integration</li> <li>Multi-vendor workflows</li> </ul>"},{"location":"cheatsheet.html","title":"Workshop Cheatsheet","text":""},{"location":"cheatsheet.html#credentials","title":"Credentials","text":"<pre><code>Username: admin\nPassword: admin\n</code></pre>"},{"location":"cheatsheet.html#start-and-stop-lab","title":"Start and Stop Lab","text":"<p>Use the VS Code Containerlab extension with the Graph TopoViewer. Right click on <code>ot-sec-segmented.clab.yml</code> (or <code>ot-sec-flat.clab.yml</code>) and select <code>Graph Topoviewer</code>.</p> <p>To start the lab press the play button in the TopoViewer navigation.</p> <p>Or use the command line:</p> <pre><code>clab deploy --topo ot-sec-segmented.clab.yml\nclab destroy --topo ot-sec-segmented.clab.yml\n</code></pre>"},{"location":"cheatsheet.html#connect-to-devices","title":"Connect to Devices","text":"<p>Quick SSH (use device name):</p> <pre><code>ssh clab-ot-sec-flat-proxmox-jumphost\nssh clab-ot-sec-flat-wago-plc2a-vlan10\nssh clab-ot-sec-flat-wago-plc2b-vlan10\nssh clab-ot-sec-flat-abb-800xa-vlan40\n</code></pre> <p>Or SSH by IP address:</p> <pre><code>ssh admin@192.168.100.52   # jumphost\nssh admin@192.168.100.53   # WAGO PLC 2A\nssh admin@192.168.100.54   # WAGO PLC 2B\nssh admin@192.168.100.57   # ABB 800XA\n</code></pre>"},{"location":"cheatsheet.html#web-access","title":"Web Access","text":"<p>HMI Desktop:</p> <p>http://192.168.100.60:5800</p> <p>ABB System:</p> <p>http://192.168.100.57:8080</p>"},{"location":"cheatsheet.html#plc-web-interfaces","title":"PLC Web Interfaces","text":"<p>Use management IPs directly; PLC web UIs (if enabled) listen on port 8080 inside the lab network.</p> Device URL (if enabled) Purpose abb-800xa-vlan40 http://10.40.0.11:8080 HMI/control interface overview wago-plc2a-vlan10 http://10.10.0.11:8080 PLC web interface wago-plc2b-vlan10 http://10.10.0.12:8080 PLC web interface (not yet working) ctrlx-plc3-vlan20 http://10.20.0.11:8080 PLC web interface schneider-plc4-vlan30 http://10.30.0.11:8080 PLC web interface"},{"location":"cheatsheet.html#commands-on-plc","title":"Commands on PLC","text":"<p>Check if CODESYS runtime is running:</p> <pre><code>pgrep -f codesyscontrol.bin\n# or\nsudo /etc/init.d/codesyscontrol status\n</code></pre> <p>Restart the runtime:</p> <pre><code>sudo /etc/init.d/codesyscontrol restart\n</code></pre> <p>Ping test:</p> <pre><code>ping 10.10.0.1\n</code></pre> <p>Capture network traffic:</p> <pre><code>sudo tcpdump -lnei eth1\n</code></pre>"},{"location":"cheatsheet.html#scan-network-from-jumphost","title":"Scan Network from Jumphost","text":"<p>Find devices:</p> <pre><code>nmap 10.10.0.0/24\n</code></pre> <p>Check if PLC port is open:</p> <pre><code>nc -zv 10.10.0.11 1217\n</code></pre>"},{"location":"exercises.html","title":"OT Security Lab Exercises","text":""},{"location":"exercises.html#overview","title":"Overview","text":"<p>These hands-on exercises provide practical experience with OT network security concepts. Each exercise focuses on fundamental network security principles commonly encountered in industrial control system environments.</p> <p>Total Time: 2-3 hours for all exercises</p> <p>Lab Requirements: You need a running lab environment (GitHub Codespaces or DevPod). See the Lab Environment page for setup instructions.</p> <p>Exercise Approach: Exercises are independent and can be completed in any order, though following the sequence provides a logical progression of concepts.</p>"},{"location":"exercises.html#prerequisites","title":"Prerequisites","text":""},{"location":"exercises.html#required-knowledge","title":"Required Knowledge","text":"<ul> <li>Basic Linux command line</li> <li>Network fundamentals (IP addressing, VLANs, routing)</li> <li>SSH basics</li> <li>Wireshark basics</li> </ul>"},{"location":"exercises.html#lab-access","title":"Lab Access","text":"<p>Before starting, ensure you can:</p> <ol> <li>Access your lab environment (Codespaces or DevPod)</li> <li>Deploy a lab topology using Containerlab extension</li> <li>SSH into lab devices</li> <li>Capture traffic using Wireshark via Edgeshark</li> </ol>"},{"location":"exercises.html#topology-selection","title":"Topology Selection","text":"<p>These exercises use two lab topologies:</p> <ul> <li><code>ot-sec-flat.clab.yml</code> - Flat network with VLANs but minimal segmentation</li> <li><code>ot-sec-segmented.clab.yml</code> - Segmented network with firewall and bonding</li> </ul> <p>Each exercise specifies which topology to use.</p>"},{"location":"exercises.html#exercise-list","title":"Exercise List","text":"Exercise Topic Time Topology Difficulty 1 VLAN Discovery 20-30 min Both Beginner 2 ARP Spoofing Attack 30-40 min Both (flat easier) Intermediate 3 Spanning Tree Analysis 25-35 min Both Intermediate 4 Link Aggregation 20-30 min Segmented only Intermediate 5 Remote Access Assessment 35-45 min Both Intermediate"},{"location":"exercises.html#exercise-1-vlan-discovery-and-traffic-analysis","title":"Exercise 1: VLAN Discovery and Traffic Analysis","text":"<p>Time Estimate: 20-30 minutes</p> <p>Lab Topology: <code>ot-sec-flat</code> or <code>ot-sec-segmented</code></p> <p>Difficulty: Beginner</p>"},{"location":"exercises.html#learning-objectives","title":"Learning Objectives","text":"<ul> <li>Understand 802.1Q VLAN tagging on trunk ports</li> <li>Differentiate between trunk and access port behavior</li> <li>Recognize VLAN isolation in packet captures</li> <li>Identify security implications of VLAN segmentation</li> </ul>"},{"location":"exercises.html#prerequisites_1","title":"Prerequisites","text":"<ul> <li>Lab deployed and running</li> <li>Basic Wireshark knowledge</li> <li>Understanding of ping command</li> </ul>"},{"location":"exercises.html#scenario","title":"Scenario","text":"<p>Industrial networks use VLANs to logically segment different operational zones. In this lab, VLANs separate hygiene systems (VLAN 10), process control (VLAN 20), disposal systems (VLAN 30), control room (VLAN 40), and engineering workstations (VLAN 50). Understanding how VLANs work and how to identify them in traffic is essential for OT security monitoring.</p>"},{"location":"exercises.html#tasks","title":"Tasks","text":""},{"location":"exercises.html#task-1-verify-plc-connectivity-within-same-vlan","title":"Task 1: Verify PLC connectivity within same VLAN","text":"<ol> <li>SSH into <code>wago-plc2a-vlan10</code>:</li> </ol> <pre><code>ssh admin@192.168.100.53\n</code></pre> <p>Password: <code>admin</code></p> <ol> <li>Test connectivity to another device in VLAN 10:</li> </ol> <pre><code>ping -c 4 10.10.0.12\n</code></pre> <ol> <li>Test connectivity to device in different VLAN:</li> </ol> <pre><code>ping -c 4 10.20.0.11\n</code></pre> <p>Question: Do both pings succeed? Why or why not?</p>"},{"location":"exercises.html#task-2-capture-traffic-on-trunk-port-between-switches","title":"Task 2: Capture traffic on trunk port between switches","text":"<ol> <li>In Containerlab extension TopoViewer, right-click on the link between <code>sw-dist</code> and <code>sw-acc1</code></li> <li>Select capture from <code>sw-dist</code> side</li> <li> <p>Wireshark opens via Edgeshark</p> </li> <li> <p>Apply Wireshark filter:</p> </li> </ol> <pre><code>vlan\n</code></pre> <ol> <li>Generate traffic by pinging from a PLC (use existing SSH session):</li> </ol> <pre><code>ping -c 10 10.10.0.1\n</code></pre> <p>Questions:</p> <ul> <li>Which VLANs do you see in the captures?</li> <li>Look at the Ethernet frame details - where is the VLAN tag located?</li> <li>What is the VLAN ID field value?</li> </ul>"},{"location":"exercises.html#task-3-capture-traffic-on-access-port","title":"Task 3: Capture traffic on access port","text":"<ol> <li>Stop the previous capture</li> <li>Right-click on link between <code>sw-acc1</code> and <code>wago-plc2a-vlan10</code></li> <li>Select capture from switch side</li> <li>Generate traffic again:</li> </ol> <pre><code>ping -c 10 10.10.0.1\n</code></pre> <ol> <li>Apply same filter: <code>vlan</code></li> </ol> <p>Questions:</p> <ul> <li>Do you see any VLAN tags now?</li> <li>What is the difference between trunk and access ports regarding VLAN tags?</li> <li>Why does the switch remove VLAN tags on access ports?</li> </ul>"},{"location":"exercises.html#verification","title":"Verification","text":"<p>Success indicators:</p> <ul> <li>Pings within same VLAN succeed</li> <li>Pings across VLANs succeed (flat) or fail (segmented with firewall)</li> <li>Trunk port captures show 802.1Q headers</li> <li>Access port captures show untagged frames</li> <li>Multiple VLAN IDs visible on trunk (10, 20, 30, 40, 50)</li> </ul>"},{"location":"exercises.html#questions-to-consider","title":"Questions to Consider","text":"<ol> <li>If an attacker gains access to a trunk port, what additional attack surface does this create?</li> <li>How would you detect unauthorized VLAN access?</li> <li>What is VLAN hopping and how could it be prevented?</li> </ol>"},{"location":"exercises.html#common-issues","title":"Common Issues","text":"<ul> <li>Issue: Cannot see VLAN tags in capture</li> <li> <p>Solution: Make sure you are capturing on trunk port between switches, not on access port to device</p> </li> <li> <p>Issue: Wireshark does not open</p> </li> <li> <p>Solution: First time may require accepting Edgeshark prompt. Close and retry.</p> </li> <li> <p>Issue: Pings fail within same VLAN</p> </li> <li>Solution: Check lab is fully deployed. Run <code>scripts/lab-test.py ot-sec-flat</code> to verify.</li> </ul> Solution: Exercise 1 - VLAN Discovery"},{"location":"exercises.html#task-1-connectivity-testing","title":"Task 1: Connectivity testing","text":"<p>SSH to wago-plc2a-vlan10:</p> <pre><code>ssh admin@192.168.100.53\n</code></pre> <p>Ping within VLAN 10 - SUCCEEDS:</p> <pre><code>ping -c 4 10.10.0.12\n</code></pre> <p>Expected output:</p> <pre><code>PING 10.10.0.12 (10.10.0.12) 56(84) bytes of data.\n64 bytes from 10.10.0.12: icmp_seq=1 ttl=64 time=0.521 ms\n64 bytes from 10.10.0.12: icmp_seq=2 ttl=64 time=0.389 ms\n64 bytes from 10.10.0.12: icmp_seq=3 ttl=64 time=0.412 ms\n64 bytes from 10.10.0.12: icmp_seq=4 ttl=64 time=0.398 ms\n\n--- 10.10.0.12 ping statistics ---\n4 packets transmitted, 4 received, 0% packet loss\n</code></pre> <p>Ping to VLAN 20 - SUCCESS (flat) or FAIL (segmented with firewall):</p> <pre><code>ping -c 4 10.20.0.11\n</code></pre> <p>In <code>ot-sec-flat</code>: Succeeds because no firewall blocks inter-VLAN traffic. In <code>ot-sec-segmented</code>: May fail if firewall rules block this communication.</p>"},{"location":"exercises.html#task-2-trunk-port-capture","title":"Task 2: Trunk port capture","text":"<p>In Wireshark on trunk link between switches, with filter <code>vlan</code>:</p> <p>Observed: 802.1Q headers visible with VLAN ID 10 for traffic from VLAN 10 devices.</p> <p>Frame structure:</p> <pre><code>Ethernet II\n    Destination: [MAC]\n    Source: [MAC]\n    Type: 802.1Q (0x8100)\n802.1Q Virtual LAN\n    Priority: 0\n    CFI: 0\n    ID: 10\n    Type: IPv4 (0x0800)\n</code></pre>"},{"location":"exercises.html#task-3-access-port-capture","title":"Task 3: Access port capture","text":"<p>On access port to <code>wago-plc2a-vlan10</code>, filter <code>vlan</code> shows NO results.</p> <p>Frames are untagged. Switch adds VLAN tag when forwarding to trunk, removes it when forwarding to access port.</p> <p>Answers to questions:</p> <ul> <li>Trunk ports show multiple VLANs: 10, 20, 30, 40, 50</li> <li>VLAN tag is inserted after source MAC, before EtherType</li> <li>Access ports have no VLAN tags - switch handles tagging</li> <li>This allows end devices to be VLAN-unaware</li> </ul>"},{"location":"exercises.html#exercise-2-arp-spoofing-attack","title":"Exercise 2: ARP Spoofing Attack","text":"<p>Time Estimate: 30-40 minutes</p> <p>Lab Topology: <code>ot-sec-flat</code> (recommended) or <code>ot-sec-segmented</code></p> <p>Difficulty: Intermediate</p>"},{"location":"exercises.html#learning-objectives_1","title":"Learning Objectives","text":"<ul> <li>Execute a Layer 2 man-in-the-middle attack</li> <li>Understand ARP protocol vulnerabilities</li> <li>Capture cleartext traffic during MITM attack</li> <li>Learn detection and mitigation strategies</li> </ul>"},{"location":"exercises.html#prerequisites_2","title":"Prerequisites","text":"<ul> <li>Understanding of ARP protocol</li> <li>Basic knowledge of network attacks</li> <li>Wireshark experience</li> <li>Root/sudo concepts</li> </ul>"},{"location":"exercises.html#scenario_1","title":"Scenario","text":"<p>ARP (Address Resolution Protocol) maps IP addresses to MAC addresses on local networks. Because ARP has no authentication, an attacker can send false ARP replies to poison the ARP cache of target devices. This redirects traffic through the attacker's system, enabling man-in-the-middle attacks. In OT environments, this can intercept PLC communications, engineering workstation traffic, or HMI connections.</p>"},{"location":"exercises.html#tasks_1","title":"Tasks","text":""},{"location":"exercises.html#task-1-observe-normal-arp-behavior","title":"Task 1: Observe normal ARP behavior","text":"<ol> <li>SSH into victim PLC <code>wago-plc2b-vlan10</code>:</li> </ol> <pre><code>ssh admin@192.168.100.54\n</code></pre> <ol> <li>View current ARP table:</li> </ol> <pre><code>arp -n\n</code></pre> <ol> <li> <p>Note the MAC address for gateway <code>10.10.0.1</code></p> </li> <li> <p>Start continuous ping to external network:</p> </li> </ol> <pre><code>ping 1.1.1.1\n</code></pre> <p>Leave this running (do not press Ctrl+C).</p>"},{"location":"exercises.html#task-2-set-up-traffic-capture","title":"Task 2: Set up traffic capture","text":"<ol> <li>Open new terminal/SSH session</li> <li>SSH into attacker PLC <code>wago-plc2a-vlan10</code>:</li> </ol> <pre><code>ssh admin@192.168.100.53\n</code></pre> <ol> <li>Start Wireshark capture on link between <code>wago-plc2a-vlan10</code> and <code>sw-acc1</code></li> <li>Apply filter:</li> </ol> <pre><code>icmp\n</code></pre> <p>Observation: Currently you should see NO traffic because ping is not going through the attacker.</p>"},{"location":"exercises.html#task-3-execute-arp-spoofing-attack","title":"Task 3: Execute ARP spoofing attack","text":"<ol> <li>On attacker (<code>wago-plc2a-vlan10</code>), run the ARP spoofing script:</li> </ol> <pre><code>sudo /home/admin/arp_spoofing-simple.sh eth1 10.10.0.12 10.10.0.1\n</code></pre> <p>Parameters:</p> <ul> <li><code>eth1</code> - interface connected to network</li> <li><code>10.10.0.12</code> - victim IP (wago-plc2b-vlan10)</li> <li><code>10.10.0.1</code> - gateway IP</li> </ul> <p>Expected output:</p> <pre><code>[*] Enabling IP forwarding...\n[*] Poisoning 10.10.0.12 (telling it we are 10.10.0.1)...\n[*] Poisoning 10.10.0.1 (telling it we are 10.10.0.12)...\n</code></pre> <ol> <li> <p>Check Wireshark - you should now see ICMP echo requests and replies flowing through attacker</p> </li> <li> <p>On victim, check ARP table again:</p> </li> </ol> <pre><code>arp -n\n</code></pre> <p>Question: Has the MAC address for <code>10.10.0.1</code> changed? Compare to original.</p>"},{"location":"exercises.html#task-4-capture-cleartext-credentials","title":"Task 4: Capture cleartext credentials","text":"<ol> <li>Stop the ARP spoofing script (Ctrl+C on attacker)</li> <li>On victim, start netcat connection:</li> </ol> <pre><code>echo \"username:admin password:secretpass123\" | nc 10.20.0.11 1234\n</code></pre> <ol> <li>On attacker, restart ARP spoofing:</li> </ol> <pre><code>sudo /home/admin/arp_spoofing-simple.sh eth1 10.10.0.12 10.10.0.1\n</code></pre> <ol> <li>From victim, send credentials again:</li> </ol> <pre><code>echo \"username:admin password:secretpass123\" | nc 10.20.0.11 1234\n</code></pre> <ol> <li>In Wireshark, remove ICMP filter and look for TCP traffic</li> <li>Follow TCP stream to see cleartext data</li> </ol>"},{"location":"exercises.html#verification_1","title":"Verification","text":"<p>Success indicators:</p> <ul> <li>Attacker sees victim's ping traffic in Wireshark</li> <li>Victim's ARP table shows attacker's MAC for gateway</li> <li>Script output shows poisoning messages</li> <li>TCP stream reveals cleartext credentials</li> </ul>"},{"location":"exercises.html#questions-to-consider_1","title":"Questions to Consider","text":"<ol> <li>How can you detect ARP spoofing on a production network?</li> <li>What mitigation strategies exist (DAI, port security, static ARP)?</li> <li>Why is this attack particularly dangerous in OT environments?</li> <li>What protocols are vulnerable to MITM credential theft?</li> </ol>"},{"location":"exercises.html#common-issues_1","title":"Common Issues","text":"<ul> <li>Issue: Script fails with \"must be run as root\"</li> <li> <p>Solution: Use <code>sudo</code> before the script command</p> </li> <li> <p>Issue: No traffic visible in Wireshark during attack</p> </li> <li> <p>Solution: Check IP forwarding is enabled (script does this automatically)</p> </li> <li> <p>Issue: Attack does not work in segmented topology</p> </li> <li>Solution: Firewall rules may block inter-VLAN traffic. Use flat topology for easier testing.</li> </ul>"},{"location":"exercises.html#advanced-challenge","title":"Advanced Challenge","text":"<p>Use <code>dsniff</code> tool to automatically capture credentials:</p> <pre><code>sudo dsniff -i eth1\n</code></pre> <p>While running, generate HTTP or FTP traffic and observe automatic credential extraction.</p> Solution: Exercise 2 - ARP Spoofing"},{"location":"exercises.html#pre-attack-state","title":"Pre-attack state","text":"<p>Victim's ARP table before attack:</p> <pre><code>arp -n\n</code></pre> <p>Output shows:</p> <pre><code>Address          HWtype  HWaddress           Flags Mask   Iface\n10.10.0.1        ether   02:42:ac:14:00:0b   C            eth1\n</code></pre> <p>Note this MAC address.</p>"},{"location":"exercises.html#attack-execution","title":"Attack execution","text":"<p>From attacker <code>wago-plc2a-vlan10</code>:</p> <pre><code>sudo /home/admin/arp_spoofing-simple.sh eth1 10.10.0.12 10.10.0.1\n</code></pre> <p>Output:</p> <pre><code>[*] Enabling IP forwarding...\n[*] Poisoning 10.10.0.12 (telling it we are 10.10.0.1)...\n[*] Poisoning 10.10.0.1 (telling it we are 10.10.0.12)...\n</code></pre> <p>Script continues running.</p>"},{"location":"exercises.html#verification_2","title":"Verification","text":"<p>On victim, check ARP again:</p> <pre><code>arp -n\n</code></pre> <p>MAC for <code>10.10.0.1</code> now shows attacker's MAC instead of real gateway MAC.</p> <p>In Wireshark on attacker's interface, ICMP traffic from victim now visible.</p>"},{"location":"exercises.html#detection-methods","title":"Detection methods","text":"<ol> <li>Monitor ARP tables for unexpected changes</li> <li>Detect gratuitous ARP packets</li> <li>Use ARP monitoring tools (arpwatch)</li> <li>Compare MAC-to-IP mappings against known good state</li> </ol>"},{"location":"exercises.html#mitigation-strategies","title":"Mitigation strategies","text":"<ol> <li>Dynamic ARP Inspection (DAI) on switches</li> <li>Port security limiting MAC addresses per port</li> <li>Static ARP entries for critical infrastructure</li> <li>Network segmentation reducing attack scope</li> <li>802.1X authentication before network access</li> </ol>"},{"location":"exercises.html#exercise-3-spanning-tree-protocol-analysis","title":"Exercise 3: Spanning Tree Protocol Analysis","text":"<p>Time Estimate: 25-35 minutes</p> <p>Lab Topology: <code>ot-sec-flat</code> or <code>ot-sec-segmented</code></p> <p>Difficulty: Intermediate</p>"},{"location":"exercises.html#learning-objectives_2","title":"Learning Objectives","text":"<ul> <li>Understand Spanning Tree Protocol operation</li> <li>Identify root bridge and port states</li> <li>Observe STP BPDU exchange</li> <li>(Segmented only) Analyze LACP bonding with STP</li> </ul>"},{"location":"exercises.html#prerequisites_3","title":"Prerequisites","text":"<ul> <li>Understanding of Layer 2 switching</li> <li>Knowledge of STP/RSTP concepts</li> <li>Basic MikroTik RouterOS commands</li> <li>SSH access to switches</li> </ul>"},{"location":"exercises.html#scenario_2","title":"Scenario","text":"<p>Spanning Tree Protocol (STP) prevents loops in switched networks by blocking redundant paths. Industrial networks use RSTP (Rapid Spanning Tree Protocol) for faster convergence. Both lab topologies run STP on all switches. The segmented lab additionally uses LACP (Link Aggregation Control Protocol) bonding between switches, which works in coordination with STP for both redundancy and increased bandwidth.</p>"},{"location":"exercises.html#tasks_2","title":"Tasks","text":""},{"location":"exercises.html#task-1-identify-switch-topology","title":"Task 1: Identify switch topology","text":"<ol> <li>SSH into distribution switch:</li> </ol> <pre><code>ssh admin@192.168.100.12\n</code></pre> <p>Password: <code>admin</code></p> <ol> <li>View bridge configuration:</li> </ol> <pre><code>/interface bridge print\n</code></pre> <ol> <li>List all bridge ports:</li> </ol> <pre><code>/interface bridge port print\n</code></pre> <p>Questions:</p> <ul> <li>What is the bridge name?</li> <li>Which interfaces are bridge members?</li> <li>Which interfaces have VLAN filtering enabled?</li> </ul>"},{"location":"exercises.html#task-2-examine-link-topology","title":"Task 2: Examine link topology","text":"<ol> <li>Check which interfaces connect to other switches:</li> </ol> <pre><code>/interface bridge port print\n</code></pre> <ol> <li>Segmented topology only: Check bonding configuration:</li> </ol> <pre><code>/interface bonding print detail\n</code></pre> <p>Expected in segmented:</p> <ul> <li>Bond name: <code>bond-sw-acc1</code></li> <li>Mode: <code>802.3ad</code> (LACP)</li> <li>Slaves: <code>ether9</code>, <code>ether10</code></li> </ul> <p>Expected in flat:</p> <ul> <li>No bonding interfaces</li> <li>Single link: ether10 connects to sw-acc1</li> </ul> <p>Questions:</p> <ul> <li>How many links connect sw-dist to sw-acc1?</li> <li>(Segmented) Are both bond members active?</li> </ul>"},{"location":"exercises.html#task-3-capture-bpdu-frames","title":"Task 3: Capture BPDU frames","text":"<ol> <li>In TopoViewer, start Wireshark capture on link between <code>sw-dist</code> and <code>sw-acc1</code></li> <li>Apply filter:</li> </ol> <pre><code>stp\n</code></pre> <p>Or alternatively:</p> <pre><code>eth.dst == 01:80:c2:00:00:00\n</code></pre> <p>Observations:</p> <ul> <li>BPDUs sent to multicast address <code>01:80:c2:00:00:00</code></li> <li>Root bridge identifier</li> <li>Port roles (designated, root)</li> <li> <p>Bridge priority values</p> </li> <li> <p>Check bridge settings on both switches:</p> </li> </ul> <p>On <code>sw-dist</code>:</p> <pre><code>/interface bridge print detail\n</code></pre> <p>On <code>sw-acc1</code> (SSH to 192.168.100.13):</p> <pre><code>/interface bridge print detail\n</code></pre> <p>Question: Which switch has lower priority and becomes root bridge?</p>"},{"location":"exercises.html#task-4-understand-redundancy-approach","title":"Task 4: Understand redundancy approach","text":"<p>In flat topology:</p> <ul> <li>Single link between switches</li> <li>STP prevents loops between other switch connections</li> <li>No link-level redundancy between sw-dist and sw-acc1</li> </ul> <p>In segmented topology:</p> <ul> <li>LACP bond provides link redundancy</li> <li>STP still runs on other ports</li> <li>Two complementary redundancy mechanisms</li> </ul> <p>From distribution switch, check configuration:</p> <pre><code>/interface ethernet print\n/interface bridge port print\n</code></pre> <p>Question: What happens if the single uplink fails in flat topology?</p>"},{"location":"exercises.html#verification_3","title":"Verification","text":"<p>Success indicators:</p> <ul> <li>Bridge configuration shows vlan-filtering enabled</li> <li>BPDU frames visible in Wireshark captures</li> <li>Root bridge identified from bridge settings</li> <li>(Segmented) Bond interface exists with LACP active</li> <li>(Flat) Single link topology documented</li> <li>Understanding of how STP prevents loops</li> </ul>"},{"location":"exercises.html#questions-to-consider_2","title":"Questions to Consider","text":"<ol> <li>Why does STP run even when there's no redundant path (flat)?</li> <li>(Segmented) What happens if one bond member fails?</li> <li>How quickly does STP reconverge after topology change?</li> <li>What security risks does STP present (BPDU attacks)?</li> </ol>"},{"location":"exercises.html#common-issues_2","title":"Common Issues","text":"<ul> <li>Issue: No bonding interface visible in flat</li> <li> <p>Solution: Correct - flat topology has no bonding, only single links</p> </li> <li> <p>Issue: Cannot SSH to switches</p> </li> <li> <p>Solution: Use management IPs 192.168.100.11-14, not data plane IPs</p> </li> <li> <p>Issue: No BPDUs in capture</p> </li> <li> <p>Solution: BPDUs are sent periodically (every 2 seconds). Wait or generate topology change.</p> </li> <li> <p>Issue: Exercise says \"segmented only\" but I'm in flat</p> </li> <li>Solution: Exercise 3 works in both topologies - bonding tasks are marked as segmented-only within the exercise</li> </ul> Solution: Exercise 3 - STP Analysis"},{"location":"exercises.html#bridge-configuration","title":"Bridge configuration","text":"<p>SSH to <code>sw-dist</code>:</p> <pre><code>ssh admin@192.168.100.12\n</code></pre> <p>View bridge:</p> <pre><code>/interface bridge print\n</code></pre> <p>Output:</p> <pre><code>Flags: X - disabled, R - running\n 0 R name=\"bridge\" mtu=auto actual-mtu=1500 l2mtu=65535 arp=enabled \n     arp-timeout=auto mac-address=XX:XX:XX:XX:XX:XX auto-mac=no \n     protocol-mode=rstp vlan-filtering=yes\n</code></pre> <p>Bridge ports:</p> <pre><code>/interface bridge port print\n</code></pre> <p>Flat topology shows ether10, ether12, ether8, ether2 as bridge members with VLAN settings.</p> <p>Segmented topology shows ether12, bond-sw-acc1, ether8, ether2 as bridge members with VLAN settings.</p>"},{"location":"exercises.html#bonding-verification-segmented-topology-only","title":"Bonding verification (Segmented topology only)","text":"<pre><code>/interface bonding print detail\n</code></pre> <p>Output shows:</p> <pre><code>0   name=\"bond-sw-acc1\" mtu=auto mode=802.3ad primary=none \n    slaves=ether9,ether10 link-monitoring=mii arp-interval=100ms \n    lacp-rate=30secs transmit-hash-policy=layer-2-and-3\n</code></pre> <p>Monitor status:</p> <pre><code>/interface bonding monitor bond-sw-acc1 once\n</code></pre> <p>Output:</p> <pre><code>              mode: 802.3ad\n            active: yes\n      active-ports: ether9 ether10\n   lacp-negotiated: yes\n</code></pre> <p>In flat topology, bonding is not used - each switch connects via a single physical interface.</p>"},{"location":"exercises.html#root-bridge-identification","title":"Root bridge identification","text":"<p>Check priority on both switches. Lower priority wins. Default priority is 32768.</p> <p>BPDU captures show root bridge ID in protocol fields.</p>"},{"location":"exercises.html#exercise-4-link-aggregation-and-load-balancing","title":"Exercise 4: Link Aggregation and Load Balancing","text":"<p>Time Estimate: 20-30 minutes</p> <p>Lab Topology: <code>ot-sec-segmented</code> only</p> <p>Difficulty: Intermediate</p>"},{"location":"exercises.html#learning-objectives_3","title":"Learning Objectives","text":"<ul> <li>Analyze LACP link aggregation operation</li> <li>Observe traffic distribution across bonded links</li> <li>Test link failover behavior</li> <li>Understand load balancing algorithms</li> </ul>"},{"location":"exercises.html#prerequisites_4","title":"Prerequisites","text":"<ul> <li>Completed Exercise 3 (STP Analysis)</li> <li>Understanding of LACP concepts</li> <li>Wireshark experience</li> <li>Basic MikroTik commands</li> </ul>"},{"location":"exercises.html#scenario_3","title":"Scenario","text":"<p>Link aggregation combines multiple physical links into one logical link for increased bandwidth and redundancy. LACP (802.3ad) dynamically negotiates bonding. Traffic is distributed across member links using a hash algorithm based on source/destination MAC, IP, or ports. Understanding how this works is important for capacity planning and troubleshooting in OT networks.</p>"},{"location":"exercises.html#tasks_3","title":"Tasks","text":""},{"location":"exercises.html#task-1-verify-lacp-negotiation","title":"Task 1: Verify LACP negotiation","text":"<ol> <li>SSH to <code>sw-dist</code>:</li> </ol> <pre><code>ssh admin@192.168.100.12\n</code></pre> <ol> <li>Monitor LACP protocol operation:</li> </ol> <pre><code>/interface bonding monitor bond-sw-acc1 once\n</code></pre> <p>Expected output includes:</p> <ul> <li><code>lacp-partner-system-id</code> - MAC of partner switch</li> <li><code>active-ports</code> - Number of active links</li> <li> <p><code>lacp-negotiated</code> - True/false</p> </li> <li> <p>Check detailed bonding configuration:</p> </li> </ul> <pre><code>/interface bonding print detail where name=bond-sw-acc1\n</code></pre> <p>Questions:</p> <ul> <li>What is the bonding mode?</li> <li>Which physical interfaces are slaves?</li> <li>What is the transmit hash policy?</li> </ul>"},{"location":"exercises.html#task-2-observe-traffic-distribution","title":"Task 2: Observe traffic distribution","text":"<ol> <li>Start Wireshark captures on BOTH bond member links:</li> <li>Capture link <code>sw-dist</code> ether9 to <code>sw-acc1</code></li> <li> <p>Open second Wireshark for ether10</p> </li> <li> <p>SSH to <code>wago-plc2a-vlan10</code>:</p> </li> </ol> <pre><code>ssh admin@192.168.100.53\n</code></pre> <ol> <li>Generate continuous traffic with varying sources:</li> </ol> <pre><code>ping -f 1.1.1.1\n</code></pre> <p>Use <code>-f</code> (flood) for high packet rate to see distribution.</p> <ol> <li>Observe both Wireshark captures</li> </ol> <p>Questions:</p> <ul> <li>Is traffic balanced equally across both links?</li> <li>Do you see traffic on both links or just one?</li> <li>What determines which link is used for specific flows?</li> </ul>"},{"location":"exercises.html#task-3-test-hash-algorithm","title":"Task 3: Test hash algorithm","text":"<ol> <li>Stop flood ping</li> <li>Generate traffic from multiple sources:</li> </ol> <p>Terminal 1 - <code>wago-plc2a-vlan10</code>:</p> <pre><code>ping -i 0.2 1.1.1.1\n</code></pre> <p>Terminal 2 - <code>wago-plc2b-vlan10</code>:</p> <pre><code>ssh admin@192.168.100.54\nping -i 0.2 1.1.1.1\n</code></pre> <ol> <li>Check packet counts on bond members:</li> </ol> <pre><code>/interface monitor-traffic ether9,ether10\n</code></pre> <p>Question: Are different source IPs distributed to different links?</p>"},{"location":"exercises.html#task-4-test-link-failover","title":"Task 4: Test link failover","text":"<ol> <li>Keep pings running from previous step</li> <li>On <code>sw-dist</code>, disable one bond member:</li> </ol> <pre><code>/interface ethernet disable ether9\n</code></pre> <ol> <li>Observe:</li> <li>Do pings continue without interruption?</li> <li>How quickly does failover occur?</li> <li> <p>Check Wireshark on remaining active link</p> </li> <li> <p>Re-enable the interface:</p> </li> </ol> <pre><code>/interface ethernet enable ether9\n</code></pre> <ol> <li>Check bond status:</li> </ol> <pre><code>/interface bonding monitor bond-sw-acc1 once\n</code></pre> <p>Question: Does both links return to active state automatically?</p>"},{"location":"exercises.html#verification_4","title":"Verification","text":"<p>Success indicators:</p> <ul> <li>LACP shows negotiated status</li> <li>Both bond members active</li> <li>Traffic visible on member links</li> <li>Failover occurs in under 1 second</li> <li>Disabled link automatically rejoins when enabled</li> <li>Packet count increases on both interfaces</li> </ul>"},{"location":"exercises.html#questions-to-consider_3","title":"Questions to Consider","text":"<ol> <li>Why might traffic use only one link for a specific flow?</li> <li>What are advantages and disadvantages of different hash algorithms?</li> <li>How does LACP compare to static bonding?</li> <li>What happens if LACP hello packets are lost?</li> </ol>"},{"location":"exercises.html#common-issues_3","title":"Common Issues","text":"<ul> <li>Issue: Traffic only uses one link</li> <li> <p>Solution: Hash algorithm makes per-flow decisions. Single source/destination uses one link. Use multiple sources to see distribution.</p> </li> <li> <p>Issue: Cannot monitor traffic on interface</p> </li> <li> <p>Solution: Use <code>/interface monitor-traffic ether9,ether10</code> command format</p> </li> <li> <p>Issue: Failover takes several seconds</p> </li> <li>Solution: This is normal for LACP. RSTP must also reconverge.</li> </ul> Solution: Exercise 4 - Link Aggregation"},{"location":"exercises.html#traffic-distribution-observation","title":"Traffic distribution observation","text":"<p>With single source ping, traffic typically uses one link consistently due to hash algorithm using source/destination IPs.</p> <p>With multiple sources (different source IPs), traffic distributes across links.</p> <p>Hash policy <code>layer-2-and-3</code> uses source/dest MAC and IP addresses.</p>"},{"location":"exercises.html#packet-count-verification","title":"Packet count verification","text":"<pre><code>/interface monitor-traffic ether9,ether10\n</code></pre> <p>Shows rx-packets-per-second and tx-packets-per-second for each interface.</p> <p>With diverse traffic, both interfaces show increasing packet counts.</p>"},{"location":"exercises.html#failover-test","title":"Failover test","text":"<p>Disable one member:</p> <pre><code>/interface ethernet disable ether9\n</code></pre> <p>Pings continue without interruption. All traffic switches to ether10.</p> <p>Re-enable:</p> <pre><code>/interface ethernet enable ether9\n</code></pre> <p>LACP renegotiates (takes few seconds), then both links active again.</p> <p>Failover is subsecond for established flows.</p>"},{"location":"exercises.html#exercise-5-remote-access-and-security-assessment","title":"Exercise 5: Remote Access and Security Assessment","text":"<p>Time Estimate: 35-45 minutes</p> <p>Lab Topology: <code>ot-sec-flat</code> (easier) or <code>ot-sec-segmented</code> (realistic)</p> <p>Difficulty: Intermediate</p>"},{"location":"exercises.html#learning-objectives_4","title":"Learning Objectives","text":"<ul> <li>Conduct remote access testing from DMZ jumphost</li> <li>Identify exposed services using port scanning</li> <li>Discover potential security vulnerabilities</li> <li>Practice professional security assessment methodology</li> </ul>"},{"location":"exercises.html#prerequisites_5","title":"Prerequisites","text":"<ul> <li>Understanding of TCP/IP fundamentals</li> <li>Basic nmap knowledge</li> <li>SSH and service concepts</li> <li>Security assessment awareness</li> </ul>"},{"location":"exercises.html#scenario_4","title":"Scenario","text":"<p>A security assessor has remote access to the jumphost in the DMZ. The objective is to map the OT network, identify running services, and document potential security issues. This simulates real-world remote access scenarios where engineers or attackers gain initial foothold and attempt to expand access into OT zones.</p>"},{"location":"exercises.html#tasks_4","title":"Tasks","text":""},{"location":"exercises.html#task-1-initial-remote-access-from-jumphost","title":"Task 1: Initial remote access from jumphost","text":"<ol> <li>SSH to jumphost:</li> </ol> <pre><code>ssh admin@192.168.100.52\n</code></pre> <p>Password: <code>admin</code></p> <ol> <li>Check your network position:</li> </ol> <pre><code>ip addr show\nip route show\n</code></pre> <p>Questions:</p> <ul> <li>What IP address does the jumphost have?</li> <li> <p>What networks are reachable according to routing table?</p> </li> <li> <p>Test basic connectivity:</p> </li> </ul> <pre><code>ping -c 3 10.10.0.1\nping -c 3 10.10.0.11\n</code></pre> <p>Note: In segmented topology, firewall may block some traffic.</p>"},{"location":"exercises.html#task-2-host-discovery","title":"Task 2: Host discovery","text":"<ol> <li>Scan VLAN 10 (Hygiene) for live hosts:</li> </ol> <pre><code>nmap -sn 10.10.0.0/24\n</code></pre> <p><code>-sn</code> performs ping scan (no port scan)</p> <p>Expected output:</p> <pre><code>Nmap scan report for 10.10.0.1\nHost is up.\n\nNmap scan report for 10.10.0.11\nHost is up.\n\nNmap scan report for 10.10.0.12\nHost is up.\n</code></pre> <ol> <li>Try other VLANs:</li> </ol> <pre><code>nmap -sn 10.20.0.0/24\nnmap -sn 10.40.0.0/24\n</code></pre> <p>Question: Which VLANs are accessible from jumphost?</p>"},{"location":"exercises.html#task-3-service-identification","title":"Task 3: Service identification","text":"<ol> <li>Scan common OT ports on discovered PLC:</li> </ol> <pre><code>nmap -sV -p22,80,502,8080,2455 10.10.0.11\n</code></pre> <p>Port reference:</p> <ul> <li>22: SSH</li> <li>80: HTTP</li> <li>502: Modbus TCP</li> <li>8080: CODESYS WebVisu</li> <li>2455: CODESYS runtime</li> </ul> <p>Expected output:</p> <pre><code>PORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 8.x\n8080/tcp open  http    nginx\n</code></pre> <ol> <li>Scan all PLCs in VLAN 10:</li> </ol> <pre><code>nmap -p8080 10.10.0.11-12\n</code></pre> <p>Questions:</p> <ul> <li>Which services are exposed?</li> <li>Are any services running that should not be?</li> <li>What can you infer about the devices from service banners?</li> </ul>"},{"location":"exercises.html#task-4-access-testing","title":"Task 4: Access testing","text":"<ol> <li>Test SSH access to PLC:</li> </ol> <pre><code>ssh admin@10.10.0.11\n</code></pre> <p>Try password: <code>admin</code></p> <p>Question: Does this succeed? Should PLCs be directly accessible via SSH from jumphost?</p> <ol> <li>Test web interface access:</li> </ol> <pre><code>curl -I http://10.10.0.11:8080\n</code></pre> <p>Observation: Check HTTP response headers for version information.</p> <ol> <li>If <code>nc</code> available, test Modbus port:</li> </ol> <pre><code>nc -zv 10.10.0.11 502\n</code></pre>"},{"location":"exercises.html#task-5-document-findings","title":"Task 5: Document findings","text":"<p>Create a simple report of findings:</p> <pre><code>cat &gt; assessment_findings.txt &lt;&lt; 'EOF'\nOT Network Security Assessment\n\nDate: $(date)\nAssessor: $(whoami)\n\nFINDINGS:\n\n1. Accessible Networks:\n   - VLAN 10: [list discovered hosts]\n   - VLAN 20: [accessible? yes/no]\n\n2. Exposed Services:\n   - Host 10.10.0.11:\n     * Port 22 (SSH): OPEN\n     * Port 8080 (HTTP): OPEN\n     * Port 502 (Modbus): [status]\n\n3. Security Issues:\n   - [List any concerns]\n\n4. Recommendations:\n   - [Suggested mitigations]\nEOF\n\ncat assessment_findings.txt\n</code></pre>"},{"location":"exercises.html#verification_5","title":"Verification","text":"<p>Success indicators:</p> <ul> <li>Host discovery identifies live PLCs</li> <li>Service scans reveal open ports</li> <li>SSH access tested (may succeed or fail depending on firewall)</li> <li>HTTP interfaces discovered</li> <li>Findings documented</li> </ul>"},{"location":"exercises.html#questions-to-consider_4","title":"Questions to Consider","text":"<ol> <li>What services should never be directly accessible from DMZ?</li> <li>How would you restrict jumphost access in production?</li> <li>What additional security controls would improve this architecture?</li> <li>How could these remote access activities be detected?</li> </ol>"},{"location":"exercises.html#common-issues_4","title":"Common Issues","text":"<ul> <li>Issue: nmap command not found</li> <li> <p>Solution: Use <code>apt-get update &amp;&amp; apt-get install nmap</code> or tool is pre-installed</p> </li> <li> <p>Issue: All hosts appear down</p> </li> <li> <p>Solution: In segmented topology, firewall may block ICMP. Use <code>-Pn</code> flag to skip ping.</p> </li> <li> <p>Issue: Cannot reach any 10.x networks</p> </li> <li>Solution: Check routing with <code>ip route</code>. Verify lab deployed correctly.</li> </ul>"},{"location":"exercises.html#advanced-challenge_1","title":"Advanced Challenge","text":"<ol> <li>Write a shell script to automate discovery of all VLANs</li> <li>Generate a CSV report of all discovered services</li> <li>Test for default credentials on discovered services</li> <li>Create network diagram based on discovered topology</li> </ol> Solution: Exercise 5 - Remote Access"},{"location":"exercises.html#host-discovery-results","title":"Host discovery results","text":"<p>From jumphost:</p> <pre><code>nmap -sn 10.10.0.0/24\n</code></pre> <p>Expected discoveries in flat topology:</p> <pre><code>10.10.0.1 (gateway)\n10.10.0.11 (wago-plc2a-vlan10)\n10.10.0.12 (wago-plc2b-vlan10)\n</code></pre> <p>Segmented topology may show fewer hosts due to firewall rules.</p>"},{"location":"exercises.html#service-scan-results","title":"Service scan results","text":"<pre><code>nmap -sV -p22,80,502,8080,2455 10.10.0.11\n</code></pre> <p>Expected output:</p> <pre><code>PORT     STATE SERVICE  VERSION\n22/tcp   open  ssh      OpenSSH 8.2p1 Ubuntu\n8080/tcp open  http     nginx 1.18.0\n</code></pre> <p>Other ports may be filtered or closed depending on PLC configuration.</p>"},{"location":"exercises.html#access-testing","title":"Access testing","text":"<p>SSH to PLC:</p> <pre><code>ssh admin@10.10.0.11\n</code></pre> <p>In flat topology: Likely succeeds with password <code>admin</code>. In segmented topology: May be blocked by firewall rules.</p> <p>Web interface:</p> <pre><code>curl -I http://10.10.0.11:8080\n</code></pre> <p>Returns HTTP headers showing CODESYS WebVisu interface.</p>"},{"location":"exercises.html#security-findings","title":"Security findings","text":"<p>Typical issues discovered:</p> <ol> <li>PLCs accessible via SSH with default credentials</li> <li>Web interfaces exposed without authentication</li> <li>Modbus TCP accessible without authentication</li> <li>No network segmentation (flat topology)</li> <li>Default passwords in use</li> <li>Unnecessary services running</li> </ol>"},{"location":"exercises.html#recommended-mitigations","title":"Recommended mitigations","text":"<ol> <li>Implement zero-trust network segmentation</li> <li>Require multi-factor authentication for remote access</li> <li>Disable unused services on PLCs</li> <li>Change default credentials</li> <li>Implement application-aware firewall rules</li> <li>Deploy IDS/IPS for anomaly detection</li> <li>Require VPN for remote access</li> <li>Implement jump host hardening</li> </ol>"},{"location":"exercises.html#appendix-wireshark-filters-quick-reference","title":"Appendix: Wireshark Filters Quick Reference","text":""},{"location":"exercises.html#vlan-analysis","title":"VLAN Analysis","text":"<pre><code>vlan                          # All 802.1Q tagged frames\nvlan.id == 10                 # Only VLAN 10 traffic\nvlan.id in {10 20 30}        # Multiple VLANs\n</code></pre>"},{"location":"exercises.html#arp-analysis","title":"ARP Analysis","text":"<pre><code>arp                           # All ARP traffic\narp.opcode == 1               # ARP requests only\narp.opcode == 2               # ARP replies only\narp.duplicate-address-detected  # ARP conflicts\n</code></pre>"},{"location":"exercises.html#stprstp","title":"STP/RSTP","text":"<pre><code>stp                           # All spanning tree\nrstp                          # Rapid spanning tree only\neth.dst == 01:80:c2:00:00:00  # STP multicast address\n</code></pre>"},{"location":"exercises.html#protocol-specific","title":"Protocol-Specific","text":"<pre><code>icmp                          # ICMP (ping) traffic\ntcp.port == 502               # Modbus TCP\ntcp.port == 2455              # CODESYS\ntcp.port == 8080              # Web interfaces\n</code></pre>"},{"location":"exercises.html#combining-filters","title":"Combining Filters","text":"<pre><code>vlan.id == 10 &amp;&amp; icmp         # VLAN 10 ICMP traffic\ntcp &amp;&amp; !tcp.port == 22        # All TCP except SSH\nip.src == 10.10.0.11 || ip.dst == 10.10.0.11  # Specific host\n</code></pre>"},{"location":"exercises.html#troubleshooting-common-issues","title":"Troubleshooting Common Issues","text":""},{"location":"exercises.html#lab-not-starting","title":"Lab Not Starting","text":"<p>Symptom: Containers fail to start or remain unhealthy</p> <p>Solutions:</p> <ol> <li>Check container status: <code>docker ps -a | grep clab</code></li> <li>View container logs: <code>docker logs &lt;container-name&gt;</code></li> <li>Verify images pulled: <code>docker images | grep narrowin</code></li> <li>Run health check: <code>scripts/lab-test.py ot-sec-flat</code></li> </ol>"},{"location":"exercises.html#cannot-ssh-to-devices","title":"Cannot SSH to Devices","text":"<p>Symptom: Connection refused or timeout</p> <p>Solutions:</p> <ol> <li>Verify using management IP (192.168.100.x), not data plane IP</li> <li>Wait 2-3 minutes after lab deploy for SSH to start</li> <li>Check container is running: <code>docker ps | grep &lt;device-name&gt;</code></li> <li>Test from VS Code terminal, not external system</li> </ol>"},{"location":"exercises.html#wireshark-not-opening","title":"Wireshark Not Opening","text":"<p>Symptom: Edgeshark does not launch</p> <p>Solutions:</p> <ol> <li>Accept VS Code prompt to open with Edgeshark</li> <li>Close and retry capture</li> <li>Check Edgeshark extension installed</li> <li>View container logs for errors</li> </ol>"},{"location":"exercises.html#no-traffic-in-captures","title":"No Traffic in Captures","text":"<p>Symptom: Wireshark shows no packets</p> <p>Solutions:</p> <ol> <li>Verify capture started before generating traffic</li> <li>Check capturing on correct interface/link</li> <li>Remove display filters temporarily</li> <li>Verify devices can actually communicate (ping test)</li> </ol>"},{"location":"exercises.html#ping-failures","title":"Ping Failures","text":"<p>Symptom: Destination unreachable</p> <p>Solutions:</p> <ol> <li>Check routing: <code>ip route show</code></li> <li>Verify VLAN assignment</li> <li>In segmented topology, check if firewall blocks traffic</li> <li>Confirm both devices in same VLAN or proper routing configured</li> </ol>"},{"location":"exercises.html#additional-resources","title":"Additional Resources","text":"<ul> <li>Containerlab Documentation</li> <li>MikroTik RouterOS Manual</li> <li>Wireshark User Guide</li> <li>CODESYS Documentation</li> <li>IEC 62443 Standards Overview</li> </ul> <p>Document Version: 1.0 Last Updated: 2025-11-19 Lab Compatibility: ot-sec-flat v1.x, ot-sec-segmented v1.x</p>"},{"location":"feedback.html","title":"Workshop Feedback","text":"<p>Thank you for participating in the OT Network Security Monitoring workshop at ISC CPH 2025.</p> <p>Your feedback helps us improve future workshops. Takes 2 minutes.</p>"},{"location":"feedback.html#submit-your-feedback","title":"Submit Your Feedback","text":"<p>Send Feedback Email</p> <p>Clicking the button opens your email client with a pre-filled template. Just fill in your ratings and send.</p>"},{"location":"feedback.html#feedback-questions","title":"Feedback Questions","text":"<p>Rate from 1 (Poor) to 5 (Excellent):</p> <ol> <li>Overall workshop experience</li> <li>Content relevance to your OT work</li> <li>Lab environment and exercises</li> <li>Documentation quality</li> <li>Instructor delivery</li> <li>Would you recommend this workshop? (Yes/No)</li> </ol> <p>Optional:</p> <ul> <li>What worked well?</li> <li>What needs improvement?</li> <li>Other suggestions?</li> </ul>"},{"location":"feedback.html#thank-you","title":"Thank You","text":"<p>Your feedback directly impacts how we develop and deliver OT security training.</p> <p>Questions? Contact:</p> <ul> <li>Martin Scheu - martin.scheu@switch.ch</li> <li>Mischa Diehm - mischa.diehm@narrowin.ch</li> </ul>"},{"location":"lab.html","title":"Lab Environment","text":""},{"location":"lab.html#overview","title":"Overview","text":"<p>This workshop uses a realistic OT network lab environment built with Containerlab. The lab simulates a typical industrial facility with multiple security zones, PLCs, network segmentation, and monitoring points that can mirror real-world deployments.</p> <p>This lab is vendor-neutral and uses only open-source and free tools. All components run in containers, allowing for rapid deployment, experimentation, and reset capabilities during hands-on exercises.</p> <p></p>"},{"location":"lab.html#getting-started","title":"Getting Started","text":""},{"location":"lab.html#starting-the-lab-environment","title":"Starting the Lab Environment","text":"<p>The lab runs in a development container with all required tools pre-installed. Choose one option:</p> <p>Option 1: GitHub Codespaces (Recommended)</p> <p>GitHub Codespaces provides a cloud-based environment accessible through your browser. No local installation required.</p> <ol> <li>Go to github.com/narrowin-labs/ot-lab</li> <li>Click \"Codespaces Open in Codespaces\"</li> <li>Wait 5-10 minutes for the initial setup (first-time only)</li> </ol> <p>Initial Setup Time: The first time you create a Codespace, it needs to download and configure all container images. This takes approximately 5-10 minutes. You'll know the setup is complete when you see the docker images list in your terminal:</p> <pre><code>\u276f docker images\nREPOSITORY                                    TAG       IMAGE ID       CREATED         SIZE\nghcr.io/narrowin/ot-sec-lab-hmi               latest    96b8774dc7e4   5 days ago      731MB\nghcr.io/narrowin/ot-sec-lab-plc               latest    9f7db1f2f47d   7 days ago      333MB\nghcr.io/kaelemc/wireshark-vnc-docker          latest    4cebbe954b93   3 months ago    554MB\nghcr.io/narrowin/ot-sec-lab-linux             latest    643864c992c6   4 months ago    908MB\nghcr.io/narrowin/vrnetlab_mikrotik_routeros   7.18      50052d2a79a1   6 months ago    1.01GB\nghcr.io/siemens/ghostwire                     latest    18664310d22f   15 months ago   36.5MB\nghcr.io/siemens/packetflix                    latest    6bed7a0d2a95   20 months ago   122MB\n</code></pre> <p>Subsequent starts will be much faster (under 1 minute).</p> <p>Documentation: docs.github.com/codespaces</p>"},{"location":"lab.html#starting-a-lab","title":"Starting a Lab","text":"<p>Navigate to the Containerlab extension on the left, right-click on one of the two labs and select \"Edit topology (TopoViewer)\":</p> <p></p> <p>Click the play button to initiate the <code>deploy</code> of the lab. This starts the lab and you need to wait 3-5 minutes for the lab to be fully operational. Once all nodes are green:</p> <p></p> <p>run in the terminal: <code>scripts/lab-test.py ot-sec-flat</code> or <code>scripts/lab-test.py ot-sec-segmented</code> depending on what you started. When all check of the test script are green you are ready to go.</p>"},{"location":"lab.html#water-treatment-frontend","title":"Water Treatment Frontend","text":"<p>Navigate to the Ports section in the lower panel, right-click <code>HMI WeChromium bVNC</code> or <code>ABB 800xA HMI Interface</code> and select <code>Open in Browser</code>. </p> <p>Start experimenting with your OT equipment (: </p>"},{"location":"lab.html#viewing-traffic-with-wireshark","title":"Viewing Traffic with Wireshark","text":"<p>Once the lab is running, you can effortlessly monitor ANY communication with live packet captures. The easiest is to right-click on a link in the TopoViewer and select on which side of the link you want to capture. This opens a Wireshark inside VS Code, allowing you to analyze your traffic.</p> <p></p> <p>The first time you will be asked by VS Code if you want to open with Edgeshark: select yes.</p> <p></p> <p>On first start it can happen that the new created window starts with an error. Just close it and try again then.</p>"},{"location":"lab.html#quick-reference","title":"Quick Reference","text":""},{"location":"lab.html#understanding-the-management-network","title":"Understanding the Management Network","text":"<p>The lab has two separate network layers:</p>"},{"location":"lab.html#management-layer-192168100024","title":"Management Layer (192.168.100.0/24)","text":"<ul> <li>Created automatically by Containerlab</li> <li>Lets you access containers from your host</li> <li>Use these IPs to SSH or open web interfaces</li> <li>This simulates out-of-band management in real networks</li> </ul>"},{"location":"lab.html#lab-topology-layer-100008","title":"Lab Topology Layer (10.0.0.0/8)","text":"<ul> <li>The actual network you are testing</li> <li>How containers communicate with each other</li> <li>Where your network segmentation and security policies apply</li> </ul> <pre><code>Your Host Machine / Browser\n         |\n         | Exported Ports\n         | :5800 -&gt; HMI WebVNC (chromium browser inside lab)\n         | :8080 -&gt; ABB 800xA HMI (10.40.0.11:8080)\n         | :8000 -&gt; MkDocs Documentation\n         |\n         | Direct access via Docker bridge\n         |\n    +----v--------------------------------------------+\n    |  Management Network: 192.168.100.0/24           |\n    |  (Containerlab creates this automatically)      |\n    |                                                 |\n    |  .11      .12      .13      .52      .53   .57  |\n    |  [gw]    [sw]    [sw]    [jump]   [plc]  [abb]  |\n    +----+------+-------+--------+--------+------+----+\n         |      |       |        |        |      |\n         |      |       |        |        |      |\n    +----+------+-------+--------+--------+------+----+\n    |  Lab Topology Networks                          |\n    |  10.10.0.0/24, 10.20.0.0/24, 10.30.0.0/24, etc. |\n    |  (Your actual network under test)               |\n    +-------------------------------------------------+\n</code></pre> <p>When you SSH to a device using 192.168.100.x, you are accessing it through the management layer, not through the lab topology. This mirrors how real industrial networks use separate management networks.</p>"},{"location":"lab.html#plc-web-interfaces","title":"PLC Web Interfaces","text":"<p>For a complete list of PLC web interfaces and their URLs, see the Cheatsheet.</p>"},{"location":"lab.html#accessing-plc-web-interfaces-in-codespaces","title":"Accessing PLC Web Interfaces in Codespaces","text":"<p>When running in GitHub Codespaces, all PLC web interfaces are accessible through the integrated Chromium HMI WebVNC browser:</p> <ol> <li>Navigate to the Ports panel in VS Code (bottom panel)</li> <li>Find the HMI WeChromium bVNC (5800) port</li> <li>Right-click and select Open in Browser</li> <li>A browser window opens with a browser inside showing the lab documentation</li> <li>Click on any PLC link in the documentation to open the web interface directly</li> </ol> <p>This approach allows you to access all PLC web interfaces without individual port forwarding, and the browser runs inside the lab network with direct access to all devices.</p> <p>Alternative Direct Port Access:</p> <p>Individual ports can also be accessed directly through port forwarding:</p> <ul> <li>Port 8080 forwards to the ABB 800xA HMI interface (10.40.0.11:8080)</li> <li>Click the globe icon next to any forwarded port in the Ports panel</li> <li>Forwarded ports are private by default (GitHub authentication required)</li> </ul>"},{"location":"lab.html#default-credentials","title":"Default Credentials","text":"<p>All lab devices use standardized credentials:</p> <pre><code>Username: admin\nPassword: admin\n</code></pre>"},{"location":"lab.html#first-5-minutes","title":"First 5 Minutes","text":"<ol> <li>SSH to the jumphost: <code>ssh admin@192.168.100.52</code></li> <li>Ping a PLC (VLAN 10): <code>ping 10.10.0.11</code></li> <li>Inspect deployed lab: <code>sudo containerlab inspect -t ot-sec-segmented.clab.yml</code></li> <li>Optional: Open a PLC web UI: <code>http://10.10.0.11:8080</code> (if enabled)</li> <li>Confirm you can SSH to a PLC: <code>ssh admin@192.168.100.53</code></li> </ol>"},{"location":"lab.html#lab-architecture","title":"Lab Architecture","text":""},{"location":"lab.html#network-topology","title":"Network Topology","text":"<p>The lab implements a defense-in-depth architecture with the following components:</p>"},{"location":"lab.html#network-devices","title":"Network Devices","text":"Device Role Function <code>gw-firewall</code> Gateway Firewall IT/OT boundary protection and routing <code>sw-dist</code> Distribution Switch Core OT network aggregation <code>sw-acc1</code> Access Switch 1 Zone-level switching for VLANs 10/20/30 <code>sw-acc2</code> Access Switch 2 Zone-level switching for VLANs 10/40/50"},{"location":"lab.html#operational-technology-assets","title":"Operational Technology Assets","text":"Device Vendor Location Function <code>wago-plc2a-vlan10</code> WAGO VLAN 10 (Hygiene) PLC <code>wago-plc2b-vlan10</code> WAGO VLAN 10 (Hygiene) PLC <code>ctrlx-plc3-vlan20</code> Bosch Rexroth (ctrlX) VLAN 20 (Process) PLC <code>schneider-plc4-vlan30</code> Schneider Electric VLAN 30 (Disposal) PLC <code>abb-800xa-vlan40</code> ABB VLAN 40 (Control Room) HMI/Control <code>dell-ews1-vlan50</code> Dell Engineering Workstation VLAN 50 (Parameterization) EWS <code>hirschmann-edge1-vlan50</code> Hirschmann Edge Gateway VLAN 50 (Parameterization) Edge gateway"},{"location":"lab.html#support-infrastructure","title":"Support Infrastructure","text":"Device Function <code>proxmox-jumphost</code> Remote access gateway in DMZ <code>panasonic-toughbook-internet</code> External connectivity simulation"},{"location":"lab.html#security-zones-and-segmentation","title":"Security Zones and Segmentation","text":"<p>The lab implements IEC 62443-based security zones with defined Security Levels (SL):</p> Zone Function Typical Assets SL Rationale OT-DMZ Demilitarized zone between IT and OT Jump hosts, patch servers, update proxies, historians, remote access gateways 2 Protects against intentional misuse; bridges SL 1 (IT) and SL 3 (OT core) OT-Operations: Hygiene Sanitation and auxiliary systems PLCs, valves, sensors (VLAN 10) 3 Safety or compliance-relevant; requires higher assurance OT-Operations: Process Core production control Main PLCs, sensors, actuators (VLAN 20) 2 Core process control; protection against skilled attackers OT-Engineering: Network Management Infrastructure management Management servers, SNMP, backup systems 3 Sensitive infrastructure; strong authentication required OT-Engineering: Parameterization Engineering and programming Engineering workstations, Codesys, laptops 2 Limited access; focus on integrity and controlled connections <p>Note: Security Level (SL) according to IEC 62443 standard</p>"},{"location":"lab.html#authorized-data-flows","title":"Authorized Data Flows","text":"<p>The lab implements controlled communication paths between zones:</p> From To Purpose Internet (IT) OT-DMZ (Jumphost) Remote access for engineers OT-DMZ (Jumphost) OT-Operations (Process/Control) Engineering access to PLCs OT-DMZ (Jumphost) OT-Engineering (Network Management) Network device management OT-Engineering (Param) OT-Operations (Process) PLC programming and updates OT-Operations (Process) OT-Operations (Hygiene) Inter-process communication"},{"location":"lab.html#lab-components","title":"Lab Components","text":""},{"location":"lab.html#plc-containers","title":"PLC Containers","text":"<p>Each PLC in the lab runs CODESYS runtime and simulates a real industrial controller.</p>"},{"location":"lab.html#plc-capabilities","title":"PLC Capabilities","text":"<p>All PLCs are containerized Ubuntu systems with:</p> <ul> <li>CODESYS Control Linux SL (IEC 61131-3-compliant SoftPLC with soft real-time properties)</li> <li>Modbus TCP, PROFINET, EtherNET/IP and OPC-UA support</li> <li>Web-based HMI (port 8080)</li> <li>SSH access for configuration</li> <li>Simulated I/O and process data</li> </ul>"},{"location":"lab.html#network-configuration","title":"Network Configuration","text":"Network Subnet VLAN Purpose Hygiene (VLAN 10) <code>10.10.0.0/24</code> 10 Sanitation systems Process (VLAN 20) <code>10.20.0.0/24</code> 20 Core production control Disposal (VLAN 30) <code>10.30.0.0/24</code> 30 Waste disposal systems Control Room (VLAN 40) <code>10.40.0.0/24</code> 40 HMI and control systems Parameterization (VLAN 50) <code>10.50.0.0/24</code> 50 Engineering workstations"},{"location":"lab.html#network-infrastructure","title":"Network Infrastructure","text":"<p>All network devices run MikroTik RouterOS 7.18 in virtualized containers.</p>"},{"location":"lab.html#device-capabilities","title":"Device Capabilities","text":"Feature Description VLAN tagging Full 802.1Q VLAN support for network segmentation Port mirroring SPAN ports for non-intrusive traffic capture Firewall Stateful packet filtering and access control Routing Inter-zone routing with policy-based forwarding SNMP monitoring Network management and monitoring integration MAC management MAC address table and security features"},{"location":"lab.html#strategic-monitoring-points","title":"Strategic Monitoring Points","text":"Location Visibility Use Case Gateway firewall OT-Internet boundary External threats, remote access monitoring Distribution switch Inter-zone traffic Zone-to-zone communication patterns Access switches Zone-internal traffic Device-level communication within zones"},{"location":"lab.html#support-systems","title":"Support Systems","text":""},{"location":"lab.html#proxmox-jumphost","title":"proxmox-jumphost","text":"Feature Description Role Remote access gateway in DMZ Tools Pre-installed network tools for exercises Access SSH from your laptop; use for all commands unless stated otherwise"},{"location":"lab.html#network-addressing","title":"Network Addressing","text":""},{"location":"lab.html#management-network-192168100024","title":"Management Network: 192.168.100.0/24","text":"<p>All lab devices are accessible via the management network.</p>"},{"location":"lab.html#network-devices_1","title":"Network Devices","text":"Device Management IP Container Name Access Gateway Firewall <code>192.168.100.11</code> <code>clab-ot-sec-segmented-gw-firewall</code> SSH, Web Distribution Switch <code>192.168.100.12</code> <code>clab-ot-sec-segmented-sw-dist</code> SSH, Web Access Switch 1 <code>192.168.100.13</code> <code>clab-ot-sec-segmented-sw-acc1</code> SSH, Web Access Switch 2 <code>192.168.100.14</code> <code>clab-ot-sec-segmented-sw-acc2</code> SSH, Web"},{"location":"lab.html#host-systems","title":"Host Systems","text":"Device Management IP Container Name Access Internet <code>192.168.100.51</code> <code>clab-ot-sec-segmented-panasonic-toughbook-internet</code> SSH Jumphost <code>192.168.100.52</code> <code>clab-ot-sec-segmented-proxmox-jumphost</code> SSH wago-plc2a-vlan10 <code>192.168.100.53</code> <code>clab-ot-sec-segmented-wago-plc2a-vlan10</code> SSH, Web wago-plc2b-vlan10 <code>192.168.100.54</code> <code>clab-ot-sec-segmented-wago-plc2b-vlan10</code> SSH, Web ctrlx-plc3-vlan20 <code>192.168.100.55</code> <code>clab-ot-sec-segmented-ctrlx-plc3-vlan20</code> SSH, Web schneider-plc4-vlan30 <code>192.168.100.56</code> <code>clab-ot-sec-segmented-schneider-plc4-vlan30</code> SSH, Web abb-800xa-vlan40 <code>192.168.100.57</code> <code>clab-ot-sec-segmented-abb-800xa-vlan40</code> SSH, Web dell-ews1-vlan50 <code>192.168.100.58</code> <code>clab-ot-sec-segmented-dell-ews1-vlan50</code> SSH hirschmann-edge1-vlan50 <code>192.168.100.59</code> <code>clab-ot-sec-segmented-hirschmann-edge1-vlan50</code> Edge gateway"},{"location":"lab.html#vlan-10-hygiene-network-10100024","title":"VLAN 10 - Hygiene Network: 10.10.0.0/24","text":"Device IP Address Function Gateway <code>10.10.0.1</code> Default gateway (gw-firewall) wago-plc2a-vlan10 <code>10.10.0.11</code> Hygiene PLC wago-plc2b-vlan10 <code>10.10.0.12</code> Hygiene PLC"},{"location":"lab.html#vlan-20-process-network-10200024","title":"VLAN 20 - Process Network: 10.20.0.0/24","text":"Device IP Address Function Gateway <code>10.20.0.1</code> Default gateway (gw-firewall) ctrlx-plc3-vlan20 <code>10.20.0.11</code> Process PLC"},{"location":"lab.html#vlan-30-disposal-network-10300024","title":"VLAN 30 - Disposal Network: 10.30.0.0/24","text":"Device IP Address Function Gateway <code>10.30.0.1</code> Default gateway (gw-firewall) schneider-plc4-vlan30 <code>10.30.0.11</code> Disposal PLC"},{"location":"lab.html#vlan-40-control-room-network-10400024","title":"VLAN 40 - Control Room Network: 10.40.0.0/24","text":"Device IP Address Function Gateway <code>10.40.0.1</code> Default gateway (gw-firewall) abb-800xa-vlan40 <code>10.40.0.11</code> HMI/Control system"},{"location":"lab.html#vlan-50-parameterization-network-10500024","title":"VLAN 50 - Parameterization Network: 10.50.0.0/24","text":"Device IP Address Function Gateway <code>10.50.0.1</code> Default gateway (gw-firewall) dell-ews1-vlan50 <code>10.50.0.11</code> Engineering workstation hirschmann-edge1-vlan50 <code>10.50.0.12</code> Edge gateway"},{"location":"lab.html#dmz-network-222024","title":"DMZ Network: 2.2.2.0/24","text":"Device IP Address Function Gateway <code>2.2.2.1</code> Firewall DMZ interface proxmox-jumphost <code>2.2.2.2</code> Remote access gateway"},{"location":"lab.html#internet-simulation-111024","title":"Internet Simulation: 1.1.1.0/24","text":"Device IP Address Function panasonic-toughbook-internet <code>1.1.1.1</code> External network simulation Firewall External <code>1.1.1.2</code> Firewall WAN interface"},{"location":"lab.html#lab-access","title":"Lab Access","text":""},{"location":"lab.html#connection-methods","title":"Connection Methods","text":""},{"location":"lab.html#access-via-vs-code-containerlab-extension","title":"Access via VS Code Containerlab Extension","text":"<p>The lab includes VS Code integration for easy device access:</p> <ol> <li>Right-click on device in Containerlab extension</li> <li>Select SSH connection</li> <li>Or use Topology Viewer: Click device, then Action \u2192 SSH</li> </ol>"},{"location":"lab.html#available-tools","title":"Available Tools","text":""},{"location":"lab.html#network-analysis-tools","title":"Network Analysis Tools","text":"Tool Purpose Usage Example <code>ping</code> Test network connectivity <code>ping 10.10.0.11</code> <code>nmap</code> Network and port scanning <code>nmap -sV 10.10.0.0/24</code> <code>tcpdump</code> Command-line packet capture <code>tcpdump -i eth0 -w capture.pcap</code> <code>arp</code> Display ARP table <code>arp -a</code> <code>nc</code> TCP/UDP client/server <code>nc -l 5000</code> <code>ssh</code> Remote login <code>ssh admin@192.168.100.53</code>"},{"location":"lab.html#dsniff-suite","title":"Dsniff Suite","text":"<p>Dsniff provides tools for network auditing and penetration testing.</p> Tool Purpose Example <code>dsniff</code> Capture clear-text credentials (FTP, HTTP, SMTP) <code>dsniff -i eth0</code> <code>filesnarf</code> Extract files from network traffic <code>filesnarf -i eth0</code> <code>mailsnarf</code> Reconstruct email messages <code>mailsnarf -i eth0</code> <code>urlsnarf</code> Log all HTTP URLs <code>urlsnarf -i eth0</code> <code>arpspoof</code> ARP spoofing for MITM attacks <code>arpspoof -i eth0 -t 10.10.0.11 10.10.0.1</code> <code>dnsspoof</code> DNS hijacking <code>dnsspoof -i eth0 -f hosts.txt</code> <code>macof</code> Flood switch CAM table <code>macof -i eth0</code> <code>tcpkill</code> Terminate TCP connections <code>tcpkill -i eth0 host 10.10.0.11</code> <code>tcpnice</code> Slow down TCP connections <code>tcpnice -i eth0 host 10.10.0.11</code> <p>Important: Enable IP forwarding for MITM attacks: <pre><code>echo 1 &gt; /proc/sys/net/ipv4/ip_forward\n</code></pre></p>"},{"location":"lab.html#workshop-lab-exercises","title":"Workshop Lab Exercises","text":"<p>The hands-on exercises have been moved to a dedicated section.</p> <p>Go to Exercises </p> <p>The exercises cover:</p> <ol> <li>VLAN Discovery</li> <li>ARP Spoofing</li> <li>Spanning Tree Analysis</li> <li>Link Aggregation</li> <li>Remote Access Assessment</li> <li>OT Protocol Discovery</li> <li>Network Segmentation and Firewall Design</li> </ol>"},{"location":"lab.html#debugging-and-verification","title":"Debugging and Verification","text":""},{"location":"lab.html#lab-health-check-script","title":"Lab Health Check Script","text":"<p>The lab includes a comprehensive health check script that verifies all components are running correctly.</p> <p>When to use:</p> <ul> <li>After deploying the lab for the first time</li> <li>When something seems wrong and you need to identify the issue</li> <li>Before starting exercises to ensure everything is ready</li> <li>After making configuration changes</li> </ul> <p>Run the health check:</p> <pre><code>./scripts/lab-test.py ot-sec-segmented\n# or for flat topology\n./scripts/lab-test.py ot-sec-flat\n</code></pre> <p>What it checks:</p> <p>The script verifies all critical lab components in organized categories:</p> <ul> <li>Infrastructure - Containerlab deployment, all containers running</li> <li>Network Devices - MikroTik switches and gateway responsiveness</li> <li>PLC Runtimes - CODESYS processes and program execution state</li> <li>Host Ports - Exposed services (8080, 5800, 1218) with source containers</li> <li>Container Ports - HTTP services on all devices</li> <li>Connectivity - Network reachability from jumphost, inter-node communication, gateway access</li> <li>Storage - Required bind mounts for PLC configurations</li> </ul> <p>Understanding results:</p> <ul> <li>PASS - Component working correctly</li> <li>FAIL - Critical issue requiring attention</li> <li>WARN - Non-critical issue (no longer shown for optional components)</li> </ul> <p>Common issues:</p> <p>If containers show as not running:</p> <pre><code>clab inspect -t ot-sec-segmented.clab.yml\ndocker ps -a | grep clab-ot-sec\n</code></pre> <p>If connectivity tests fail, check network device status:</p> <pre><code>ssh admin@192.168.100.11  # gateway\nssh admin@192.168.100.12  # distribution switch\n</code></pre> <p>If PLC runtimes fail, check process status inside container:</p> <pre><code>docker exec clab-ot-sec-segmented-wago-plc2a-vlan10 pgrep -f codesyscontrol\n</code></pre>"},{"location":"lab.html#extension-ideas","title":"Extension Ideas","text":"<ol> <li>Advanced Monitoring</li> <li>Deploy Zeek for protocol analysis</li> <li>Set up Suricata IDS with custom rules</li> <li> <p>Integrate ELK stack for log aggregation</p> </li> <li> <p>Security Testing</p> </li> <li>Implement firewall rulesets</li> <li>Test network segmentation effectiveness</li> <li> <p>Simulate attack scenarios</p> </li> <li> <p>Protocol Analysis</p> </li> <li>Analyze additional OT protocols</li> <li>Create custom Wireshark dissectors</li> <li> <p>Document protocol behaviors</p> </li> <li> <p>Automation</p> </li> <li>Script deployment processes</li> <li>Automate configuration backups</li> <li>Create testing frameworks</li> </ol>"},{"location":"slides.html","title":"Workshop Slides","text":""},{"location":"slides.html#main-workshop-presentation","title":"Main Workshop Presentation","text":"<p>Download the presentation slides for this workshop:</p> <p>Download Workshop Slides (PDF)</p> <p>Copenhagen 2025: Unfold the OT Network Jungle Presented by Mischa Diehm and Martin Scheu</p> <p>This deck covers:</p> <ul> <li>Introduction to OT Networks</li> <li>Network Security Monitoring Fundamentals</li> <li>Hands-on Lab Overview</li> <li>Containerlab and Network Simulation</li> <li>Best Practices and Takeaways</li> </ul>"},{"location":"slides.html#reference-material","title":"Reference Material","text":"<p>For additional context on the Containerlab approach and digital twin concepts:</p> <p>Download Reference: Digital Twin with Containerlab (PDF)</p> <p>This reference presentation provides deeper insights into:</p> <ul> <li>Building network digital twins with Containerlab</li> <li>Lab environment architecture</li> <li>Advanced simulation techniques</li> <li>Real-world applications</li> </ul>"},{"location":"exercises/index.html","title":"OT Security Lab Exercises","text":""},{"location":"exercises/index.html#overview","title":"Overview","text":"<p>These hands-on exercises provide practical experience with OT network security concepts. Each exercise focuses on fundamental network security principles commonly encountered in industrial control system environments.</p> <p>Total Time: 3-4 hours for all exercises</p> <p>Lab Requirements: You need a running lab environment (GitHub Codespaces or DevPod). See the Lab Environment page for setup instructions.</p> <p>Exercise Approach: Exercises are independent and can be completed in any order, though following the sequence provides a logical progression of concepts.</p>"},{"location":"exercises/index.html#prerequisites","title":"Prerequisites","text":""},{"location":"exercises/index.html#required-knowledge","title":"Required Knowledge","text":"<ul> <li>Basic Linux command line</li> <li>Network fundamentals (IP addressing, VLANs, routing)</li> <li>SSH basics</li> <li>Wireshark basics</li> </ul>"},{"location":"exercises/index.html#lab-access","title":"Lab Access","text":"<p>Before starting, ensure you can:</p> <ol> <li>Access your lab environment (Codespaces or DevPod)</li> <li>Deploy a lab topology using Containerlab extension</li> <li>SSH into lab devices</li> <li>Capture traffic using Wireshark via Edgeshark</li> </ol>"},{"location":"exercises/index.html#topology-selection","title":"Topology Selection","text":"<p>These exercises use two lab topologies:</p> <ul> <li><code>ot-sec-flat.clab.yml</code> - Flat network with VLANs but minimal segmentation</li> <li><code>ot-sec-segmented.clab.yml</code> - Segmented network with firewall rules</li> </ul> <p>Each exercise specifies which topology to use.</p>"},{"location":"exercises/index.html#exercise-list","title":"Exercise List","text":"# Exercise Time Topology Difficulty Link 1 VLAN Discovery 20-30 min Both Beginner Start  2 ARP Spoofing Attack 30-40 min Both (flat easier) Intermediate Start  3 Spanning Tree Analysis 25-35 min Both Intermediate Start  4 Link Aggregation 20-30 min Segmented only Intermediate Start  5 Remote Access Assessment 35-45 min Both Intermediate Start  6 OT Protocol Discovery 45-50 min Both (flat easier) Intermediate Start  7 Segmentation &amp; Firewall Design 35-45 min Segmented (primary) Intermediate/Advanced Start"},{"location":"exercises/index.html#additional-resources","title":"Additional Resources","text":"<ul> <li>Appendix: Wireshark Filters</li> <li>Troubleshooting Guide</li> <li>External Resources</li> </ul>"},{"location":"exercises/appendix.html","title":"Appendix: Reference Materials","text":""},{"location":"exercises/appendix.html#wireshark-filters-quick-reference","title":"Wireshark Filters Quick Reference","text":""},{"location":"exercises/appendix.html#vlan-analysis","title":"VLAN Analysis","text":"<pre><code>vlan                          # All 802.1Q tagged frames\nvlan.id == 10                 # Only VLAN 10 traffic\nvlan.id in {10 20 30}        # Multiple VLANs\n</code></pre>"},{"location":"exercises/appendix.html#arp-analysis","title":"ARP Analysis","text":"<pre><code>arp                           # All ARP traffic\narp.opcode == 1               # ARP requests only\narp.opcode == 2               # ARP replies only\narp.duplicate-address-detected  # ARP conflicts\n</code></pre>"},{"location":"exercises/appendix.html#stprstp","title":"STP/RSTP","text":"<pre><code>stp                           # All spanning tree\nrstp                          # Rapid spanning tree only\neth.dst == 01:80:c2:00:00:00  # STP multicast address\n</code></pre>"},{"location":"exercises/appendix.html#protocol-specific","title":"Protocol-Specific","text":"<pre><code>icmp                          # ICMP (ping) traffic\ntcp.port == 502               # Modbus TCP\ntcp.port == 2455              # CODESYS\ntcp.port == 8080              # Web interfaces\n</code></pre>"},{"location":"exercises/appendix.html#combining-filters","title":"Combining Filters","text":"<pre><code>vlan.id == 10 &amp;&amp; icmp         # VLAN 10 ICMP traffic\ntcp &amp;&amp; !tcp.port == 22        # All TCP except SSH\nip.src == 10.10.0.11 || ip.dst == 10.10.0.11  # Specific host\n</code></pre>"},{"location":"exercises/appendix.html#troubleshooting-common-issues","title":"Troubleshooting Common Issues","text":""},{"location":"exercises/appendix.html#lab-not-starting","title":"Lab Not Starting","text":"<p>Symptom: Containers fail to start or remain unhealthy</p> <p>Solutions:</p> <ol> <li>Check container status: <code>docker ps -a | grep clab</code></li> <li>View container logs: <code>docker logs &lt;container-name&gt;</code></li> <li>Verify images pulled: <code>docker images | grep narrowin</code></li> <li>Run health check: <code>scripts/lab-test.py ot-sec-flat</code></li> </ol>"},{"location":"exercises/appendix.html#cannot-ssh-to-devices","title":"Cannot SSH to Devices","text":"<p>Symptom: Connection refused or timeout</p> <p>Solutions:</p> <ol> <li>Verify using management IP (192.168.100.x), not data plane IP</li> <li>Wait 2-3 minutes after lab deploy for SSH to start</li> <li>Check container is running: <code>docker ps | grep &lt;device-name&gt;</code></li> <li>Test from VS Code terminal, not external system</li> </ol>"},{"location":"exercises/appendix.html#wireshark-not-opening","title":"Wireshark Not Opening","text":"<p>Symptom: Edgeshark does not launch</p> <p>Solutions:</p> <ol> <li>Accept VS Code prompt to open with Edgeshark</li> <li>Close and retry capture</li> <li>Check Edgeshark extension installed</li> <li>View container logs for errors</li> </ol>"},{"location":"exercises/appendix.html#no-traffic-in-captures","title":"No Traffic in Captures","text":"<p>Symptom: Wireshark shows no packets</p> <p>Solutions:</p> <ol> <li>Verify capture started before generating traffic</li> <li>Check capturing on correct interface/link</li> <li>Remove display filters temporarily</li> <li>Verify devices can actually communicate (ping test)</li> </ol>"},{"location":"exercises/appendix.html#ping-failures","title":"Ping Failures","text":"<p>Symptom: Destination unreachable</p> <p>Solutions:</p> <ol> <li>Check routing: <code>ip route show</code></li> <li>Verify VLAN assignment</li> <li>In segmented topology, check if firewall blocks traffic</li> <li>Confirm both devices in same VLAN or proper routing configured</li> </ol>"},{"location":"exercises/appendix.html#additional-resources","title":"Additional Resources","text":""},{"location":"exercises/appendix.html#documentation","title":"Documentation","text":"<ul> <li>Containerlab Documentation - Network lab automation</li> <li>MikroTik RouterOS Manual - Switch configuration reference</li> <li>Wireshark User Guide - Packet analysis</li> <li>CODESYS Documentation - PLC programming</li> </ul>"},{"location":"exercises/appendix.html#standards-and-best-practices","title":"Standards and Best Practices","text":"<ul> <li>IEC 62443 Standards - Industrial cybersecurity framework</li> <li>NIST Cybersecurity Framework - Security best practices</li> </ul>"},{"location":"exercises/appendix.html#tools","title":"Tools","text":"<ul> <li>nmap - Network discovery and security auditing</li> <li>tcpdump - Command-line packet analyzer</li> <li>Edgeshark - Container network traffic capture</li> </ul>"},{"location":"exercises/appendix.html#advanced-topics-and-extensions","title":"Advanced Topics and Extensions","text":"<p>These topics are mentioned in the original workshop objectives but are considered advanced or require additional infrastructure not currently present in the standard lab environment.</p>"},{"location":"exercises/appendix.html#idsips-deployment","title":"IDS/IPS Deployment","text":"<ul> <li>Zeek: Deploying Zeek for deep protocol analysis and logging.</li> <li>Suricata: Setting up Suricata IDS with custom rules for OT protocols.</li> </ul>"},{"location":"exercises/appendix.html#advanced-monitoring","title":"Advanced Monitoring","text":"<ul> <li>ELK Stack: Integrating Elasticsearch, Logstash, and Kibana for centralized log management.</li> <li>SIEM: Concepts of integrating OT logs into a Security Information and Event Management system.</li> </ul>"},{"location":"exercises/appendix.html#operational-security","title":"Operational Security","text":"<ul> <li>Detection Rules: Configuring specific detection rules for anomalies (e.g., \"New device detected\", \"PLC stop command\").</li> <li>Alerting: Setting up email or webhook alerts for security events.</li> <li>Playbooks: Creating response playbooks for detected incidents.</li> <li>Tuning: Methodologies for reducing false positives in detection rules.</li> <li>Firewall Management: Tools and processes for managing complex firewall rulesets over time.</li> </ul> <p>Document Version: 1.0 Last Updated: 2025-11-19 Lab Compatibility: ot-sec-flat v1.x, ot-sec-segmented v1.x</p>"},{"location":"exercises/ex1-vlan-discovery.html","title":"Exercise 1: VLAN Discovery and Traffic Analysis","text":"<p>Time Estimate: 20-30 minutes Lab Topology: <code>ot-sec-flat</code> or <code>ot-sec-segmented</code> Difficulty:  Beginner</p>"},{"location":"exercises/ex1-vlan-discovery.html#learning-objectives","title":"Learning Objectives","text":"<ul> <li>Understand 802.1Q VLAN tagging on trunk ports</li> <li>Differentiate between trunk and access port behavior</li> <li>Recognize VLAN isolation in packet captures</li> <li>Identify security implications of VLAN segmentation</li> </ul>"},{"location":"exercises/ex1-vlan-discovery.html#prerequisites","title":"Prerequisites","text":"<ul> <li>Lab deployed and running</li> <li>Basic Wireshark knowledge</li> <li>Understanding of ping command</li> </ul>"},{"location":"exercises/ex1-vlan-discovery.html#scenario","title":"Scenario","text":"<p>Industrial networks use VLANs to logically segment different operational zones. In this lab, VLANs separate hygiene systems (VLAN 10), process control (VLAN 20), disposal systems (VLAN 30), control room (VLAN 40), and engineering workstations (VLAN 50). Understanding how VLANs work and how to identify them in traffic is essential for OT security monitoring.</p>"},{"location":"exercises/ex1-vlan-discovery.html#tasks","title":"Tasks","text":""},{"location":"exercises/ex1-vlan-discovery.html#task-1-verify-plc-connectivity-within-same-vlan","title":"Task 1: Verify PLC connectivity within same VLAN","text":"<ol> <li>SSH into <code>wago-plc2a-vlan10</code>:</li> </ol> <pre><code>ssh admin@192.168.100.53\n</code></pre> <p>Default Credentials</p> <p>Password: <code>admin</code></p> <ol> <li>Test connectivity to another device in VLAN 10:</li> </ol> <pre><code>ping -c 4 10.10.0.12\n</code></pre> <ol> <li>Test connectivity to device in different VLAN:</li> </ol> <pre><code>ping -c 4 10.20.0.11\n</code></pre> <p>Question: Do both pings succeed? Why or why not?</p>"},{"location":"exercises/ex1-vlan-discovery.html#task-2-capture-traffic-on-trunk-port-between-switches","title":"Task 2: Capture traffic on trunk port between switches","text":"<ol> <li>In Containerlab extension TopoViewer, right-click on the link between <code>sw-dist</code> and <code>sw-acc1</code></li> <li>Select capture from <code>sw-dist</code> side</li> <li> <p>Wireshark opens via Edgeshark</p> </li> <li> <p>Apply Wireshark filter:</p> </li> </ol> <pre><code>vlan\n</code></pre> <ol> <li>Generate traffic by pinging from a PLC (use existing SSH session):</li> </ol> <pre><code>ping -c 10 10.10.0.1\n</code></pre> <p>Questions:</p> <ul> <li>Which VLANs do you see in the captures?</li> <li>Look at the Ethernet frame details - where is the VLAN tag located?</li> <li>What is the VLAN ID field value?</li> </ul>"},{"location":"exercises/ex1-vlan-discovery.html#task-3-capture-traffic-on-access-port","title":"Task 3: Capture traffic on access port","text":"<ol> <li>Stop the previous capture</li> <li>Right-click on link between <code>sw-acc1</code> and <code>wago-plc2a-vlan10</code></li> <li>Select capture from switch side</li> <li>Generate traffic again:</li> </ol> <pre><code>ping -c 10 10.10.0.1\n</code></pre> <ol> <li>Apply same filter:</li> </ol> <pre><code>vlan\n</code></pre> <p>Questions:</p> <ul> <li>Do you see any VLAN tags now?</li> <li>What is the difference between trunk and access ports regarding VLAN tags?</li> <li>Why does the switch remove VLAN tags on access ports?</li> </ul>"},{"location":"exercises/ex1-vlan-discovery.html#verification","title":"Verification","text":"<p>Success indicators:</p> <ul> <li>Pings within same VLAN succeed</li> <li>Pings across VLANs succeed (flat) or fail (segmented with firewall)</li> <li>Trunk port captures show 802.1Q headers</li> <li>Access port captures show untagged frames</li> <li>Multiple VLAN IDs visible on trunk (10, 20, 30, 40, 50)</li> </ul>"},{"location":"exercises/ex1-vlan-discovery.html#questions-to-consider","title":"Questions to Consider","text":"<ol> <li>If an attacker gains access to a trunk port, what additional attack surface does this create?</li> <li>How would you detect unauthorized VLAN access?</li> <li>What is VLAN hopping and how could it be prevented?</li> </ol>"},{"location":"exercises/ex1-vlan-discovery.html#common-issues","title":"Common Issues","text":"<ul> <li>Issue: Cannot see VLAN tags in capture</li> <li> <p>Solution: Make sure you are capturing on trunk port between switches, not on access port to device</p> </li> <li> <p>Issue: Wireshark does not open</p> </li> <li> <p>Solution: First time may require accepting Edgeshark prompt. Close and retry.</p> </li> <li> <p>Issue: Pings fail within same VLAN</p> </li> <li>Solution: Check lab is fully deployed. Run <code>scripts/lab-test.py ot-sec-flat</code> to verify.</li> </ul>"},{"location":"exercises/ex1-vlan-discovery.html#solution","title":"Solution","text":"Click to reveal solution"},{"location":"exercises/ex1-vlan-discovery.html#task-1-connectivity-testing","title":"Task 1: Connectivity testing","text":"<p>SSH to wago-plc2a-vlan10:</p> <pre><code>ssh admin@192.168.100.53\n</code></pre> <p>Ping within VLAN 10 - SUCCEEDS:</p> <pre><code>ping -c 4 10.10.0.12\n</code></pre> <p>Expected output:</p> <pre><code>PING 10.10.0.12 (10.10.0.12) 56(84) bytes of data.\n64 bytes from 10.10.0.12: icmp_seq=1 ttl=64 time=0.521 ms\n64 bytes from 10.10.0.12: icmp_seq=2 ttl=64 time=0.389 ms\n64 bytes from 10.10.0.12: icmp_seq=3 ttl=64 time=0.412 ms\n64 bytes from 10.10.0.12: icmp_seq=4 ttl=64 time=0.398 ms\n\n--- 10.10.0.12 ping statistics ---\n4 packets transmitted, 4 received, 0% packet loss\n</code></pre> <p>Ping to VLAN 20 - SUCCESS (flat) or FAIL (segmented with firewall):</p> <pre><code>ping -c 4 10.20.0.11\n</code></pre> <p>In <code>ot-sec-flat</code>: Succeeds because no firewall blocks inter-VLAN traffic. In <code>ot-sec-segmented</code>: May fail if firewall rules block this communication.</p>"},{"location":"exercises/ex1-vlan-discovery.html#task-2-trunk-port-capture","title":"Task 2: Trunk port capture","text":"<p>In Wireshark on trunk link between switches, with filter <code>vlan</code>:</p> <p>Observed: 802.1Q headers visible with VLAN ID 10 for traffic from VLAN 10 devices.</p> <p>Frame structure:</p> <pre><code>Ethernet II\n    Destination: [MAC]\n    Source: [MAC]\n    Type: 802.1Q (0x8100)\n802.1Q Virtual LAN\n    Priority: 0\n    CFI: 0\n    ID: 10\n    Type: IPv4 (0x0800)\n</code></pre>"},{"location":"exercises/ex1-vlan-discovery.html#task-3-access-port-capture","title":"Task 3: Access port capture","text":"<p>On access port to <code>wago-plc2a-vlan10</code>, filter <code>vlan</code> shows NO results.</p> <p>Frames are untagged. Switch adds VLAN tag when forwarding to trunk, removes it when forwarding to access port.</p> <p>Answers to questions:</p> <ul> <li>Trunk ports show multiple VLANs: 10, 20, 30, 40, 50</li> <li>VLAN tag is inserted after source MAC, before EtherType</li> <li>Access ports have no VLAN tags - switch handles tagging</li> <li>This allows end devices to be VLAN-unaware</li> </ul>"},{"location":"exercises/ex2-arp-spoofing.html","title":"Exercise 2: ARP Spoofing Attack","text":"<p>Time Estimate: 30-40 minutes Lab Topology: <code>ot-sec-flat</code> (recommended) or <code>ot-sec-segmented</code> Difficulty:  Intermediate</p>"},{"location":"exercises/ex2-arp-spoofing.html#learning-objectives","title":"Learning Objectives","text":"<ul> <li>Execute a Layer 2 man-in-the-middle attack</li> <li>Understand ARP protocol vulnerabilities</li> <li>Capture cleartext traffic during MITM attack</li> <li>Learn detection and mitigation strategies</li> </ul>"},{"location":"exercises/ex2-arp-spoofing.html#prerequisites","title":"Prerequisites","text":"<ul> <li>Understanding of ARP protocol</li> <li>Basic knowledge of network attacks</li> <li>Wireshark experience</li> <li>Root/sudo concepts</li> </ul>"},{"location":"exercises/ex2-arp-spoofing.html#scenario","title":"Scenario","text":"<p>ARP (Address Resolution Protocol) maps IP addresses to MAC addresses on local networks. Because ARP has no authentication, an attacker can send false ARP replies to poison the ARP cache of target devices. This redirects traffic through the attacker's system, enabling man-in-the-middle attacks. In OT environments, this can intercept PLC communications, engineering workstation traffic, or HMI connections.</p>"},{"location":"exercises/ex2-arp-spoofing.html#tasks","title":"Tasks","text":""},{"location":"exercises/ex2-arp-spoofing.html#task-1-observe-normal-arp-behavior","title":"Task 1: Observe normal ARP behavior","text":"<ol> <li>SSH into victim PLC <code>wago-plc2b-vlan10</code>:</li> </ol> <pre><code>ssh admin@192.168.100.54\n</code></pre> <p>Default Credentials</p> <p>Password: <code>admin</code></p> <ol> <li>View current ARP table:</li> </ol> <pre><code>ip neighbor\n</code></pre> <ol> <li> <p>Note the MAC address for gateway <code>10.10.0.1</code></p> </li> <li> <p>Start continuous ping to external network:</p> </li> </ol> <pre><code>ping 1.1.1.1\n</code></pre> <p>Leave this running (do not press Ctrl+C).</p>"},{"location":"exercises/ex2-arp-spoofing.html#task-2-set-up-traffic-capture","title":"Task 2: Set up traffic capture","text":"<ol> <li>Open new terminal/SSH session</li> <li>SSH into attacker PLC <code>wago-plc2a-vlan10</code>:</li> </ol> <pre><code>ssh admin@192.168.100.53\n</code></pre> <ol> <li>Start Wireshark capture on link between <code>wago-plc2a-vlan10</code> and <code>sw-acc1</code></li> <li>Apply filter:</li> </ol> <pre><code>icmp\n</code></pre> <p>Observation: Currently you should see NO traffic because ping is not going through the attacker.</p>"},{"location":"exercises/ex2-arp-spoofing.html#task-3-execute-arp-spoofing-attack","title":"Task 3: Execute ARP spoofing attack","text":"<ol> <li>On attacker (<code>wago-plc2a-vlan10</code>), run the ARP spoofing script:</li> </ol> <pre><code>sudo /home/admin/arp_spoofing-simple.sh eth1 10.10.0.12 10.10.0.1\n</code></pre> <p>Parameters:</p> <ul> <li><code>eth1</code> - interface connected to network</li> <li><code>10.10.0.12</code> - victim IP (wago-plc2b-vlan10)</li> <li><code>10.10.0.1</code> - gateway IP</li> </ul> <p>Expected output:</p> <pre><code>[*] Enabling IP forwarding...\n[*] Poisoning 10.10.0.12 (telling it we are 10.10.0.1)...\n[*] Poisoning 10.10.0.1 (telling it we are 10.10.0.12)...\n</code></pre> <ol> <li> <p>Check Wireshark - you should now see ICMP echo requests and replies flowing through attacker</p> </li> <li> <p>On victim, check ARP table again:</p> </li> </ol> <pre><code>ip neighbor\n</code></pre> <p>Question: Has the MAC address for <code>10.10.0.1</code> changed? Compare to original.</p>"},{"location":"exercises/ex2-arp-spoofing.html#task-4-capture-cleartext-credentials","title":"Task 4: Capture cleartext credentials","text":"<ol> <li>Stop the ARP spoofing script (Ctrl+C on attacker)</li> <li> <p>Open new terminal and SSH into internet node <code>panasonic-toughbook-internet</code>:</p> <pre><code>ssh admin@192.168.100.51\n</code></pre> </li> <li> <p>On internet node, start netcat listener on port 2323:</p> <pre><code>nc -l -k 2323\n</code></pre> <p>Leave this running to receive incoming connections.</p> </li> <li> <p>On victim (<code>wago-plc2b-vlan10</code>), send test credentials:</p> <pre><code>echo \"username:admin password:secretpass123\" | nc 1.1.1.1 2323\n</code></pre> </li> <li> <p>On attacker, restart ARP spoofing:</p> <pre><code>sudo /home/admin/arp_spoofing-simple.sh eth1 10.10.0.12 10.10.0.1\n</code></pre> </li> <li> <p>From victim, send credentials again:</p> <pre><code>echo \"username:admin password:secretpass123\" | nc 1.1.1.1 2323\n</code></pre> </li> <li> <p>In Wireshark, remove ICMP filter and look for TCP traffic to port 2323</p> </li> <li>Follow TCP stream to see cleartext data</li> <li>Check the netcat listener on internet node - it should display the received credentials</li> </ol>"},{"location":"exercises/ex2-arp-spoofing.html#verification","title":"Verification","text":"<p>Success indicators:</p> <ul> <li>Attacker sees victim's ping traffic in Wireshark</li> <li>Victim's ARP table shows attacker's MAC for gateway</li> <li>Script output shows poisoning messages</li> <li>TCP stream reveals cleartext credentials</li> </ul>"},{"location":"exercises/ex2-arp-spoofing.html#questions-to-consider","title":"Questions to Consider","text":"<ol> <li>How can you detect ARP spoofing on a production network?</li> <li>What mitigation strategies exist (DAI, port security, static ARP)?</li> <li>Why is this attack particularly dangerous in OT environments?</li> <li>What protocols are vulnerable to MITM credential theft?</li> </ol>"},{"location":"exercises/ex2-arp-spoofing.html#common-issues","title":"Common Issues","text":"<ul> <li>Issue: Script fails with \"must be run as root\"</li> <li> <p>Solution: Use <code>sudo</code> before the script command</p> </li> <li> <p>Issue: No traffic visible in Wireshark during attack</p> </li> <li>Solution: Check IP forwarding is enabled (script does this automatically)</li> </ul>"},{"location":"exercises/ex2-arp-spoofing.html#advanced-challenge","title":"Advanced Challenge","text":"<p>Use <code>dsniff</code> tool to automatically capture credentials:</p> <pre><code>sudo dsniff -i eth1\n</code></pre> <p>While running, generate HTTP or FTP traffic and observe automatic credential extraction.</p>"},{"location":"exercises/ex2-arp-spoofing.html#solution","title":"Solution","text":"Click to reveal solution"},{"location":"exercises/ex2-arp-spoofing.html#pre-attack-state","title":"Pre-attack state","text":"<p>Victim's ARP table before attack:</p> <pre><code>ip neighbor\n</code></pre> <p>Output shows:</p> <pre><code>10.10.0.1 dev eth1 lladdr 02:42:ac:14:00:0b REACHABLE\n</code></pre> <p>Note this MAC address.</p>"},{"location":"exercises/ex2-arp-spoofing.html#attack-execution","title":"Attack execution","text":"<p>From attacker <code>wago-plc2a-vlan10</code>:</p> <pre><code>sudo /home/admin/arp_spoofing-simple.sh eth1 10.10.0.12 10.10.0.1\n</code></pre> <p>Output:</p> <pre><code>[*] Enabling IP forwarding...\n[*] Poisoning 10.10.0.12 (telling it we are 10.10.0.1)...\n[*] Poisoning 10.10.0.1 (telling it we are 10.10.0.12)...\n</code></pre> <p>Script continues running.</p>"},{"location":"exercises/ex2-arp-spoofing.html#verification_1","title":"Verification","text":"<p>On victim, check ARP again:</p> <pre><code>ip neighbor\n</code></pre> <p>MAC for <code>10.10.0.1</code> now shows attacker's MAC instead of real gateway MAC.</p> <p>In Wireshark on attacker's interface, ICMP traffic from victim now visible.</p>"},{"location":"exercises/ex2-arp-spoofing.html#detection-methods","title":"Detection methods","text":"<ol> <li>Monitor ARP tables for unexpected changes</li> <li>Detect gratuitous ARP packets</li> <li>Use ARP monitoring tools (arpwatch)</li> <li>Compare MAC-to-IP mappings against known good state</li> </ol>"},{"location":"exercises/ex2-arp-spoofing.html#mitigation-strategies","title":"Mitigation strategies","text":"<ol> <li>Dynamic ARP Inspection (DAI) on switches</li> <li>Port security limiting MAC addresses per port</li> <li>Static ARP entries for critical infrastructure</li> <li>Network segmentation reducing attack scope</li> <li>802.1X authentication before network access</li> </ol>"},{"location":"exercises/ex3-spanning-tree.html","title":"Exercise 3: Spanning Tree Protocol Analysis","text":"<p>Time Estimate: 25-35 minutes Lab Topology: <code>ot-sec-flat</code> or <code>ot-sec-segmented</code> Difficulty:  Intermediate</p>"},{"location":"exercises/ex3-spanning-tree.html#learning-objectives","title":"Learning Objectives","text":"<ul> <li>Understand Spanning Tree Protocol operation</li> <li>Identify root bridge and port states</li> <li>Observe STP BPDU exchange</li> <li>(Segmented only) Analyze LACP bonding with STP</li> </ul>"},{"location":"exercises/ex3-spanning-tree.html#prerequisites","title":"Prerequisites","text":"<ul> <li>Understanding of Layer 2 switching</li> <li>Knowledge of STP/RSTP concepts</li> <li>Basic MikroTik RouterOS commands</li> <li>SSH access to switches</li> </ul>"},{"location":"exercises/ex3-spanning-tree.html#scenario","title":"Scenario","text":"<p>Spanning Tree Protocol (STP) prevents loops in switched networks by blocking redundant paths. Industrial networks use RSTP (Rapid Spanning Tree Protocol) for faster convergence. Both lab topologies run STP on all switches. The segmented lab additionally uses LACP (Link Aggregation Control Protocol) bonding between switches, which works in coordination with STP for both redundancy and increased bandwidth.</p>"},{"location":"exercises/ex3-spanning-tree.html#tasks","title":"Tasks","text":""},{"location":"exercises/ex3-spanning-tree.html#task-1-identify-switch-topology","title":"Task 1: Identify switch topology","text":"<ol> <li>SSH into distribution switch:</li> </ol> <pre><code>ssh admin@192.168.100.12\n</code></pre> <p>Default Credentials</p> <p>Password: <code>admin</code></p> <ol> <li>View bridge configuration:</li> </ol> <pre><code>/interface bridge print\n</code></pre> <ol> <li>List all bridge ports:</li> </ol> <pre><code>/interface bridge port print\n</code></pre> <p>Questions:</p> <ul> <li>What is the bridge name?</li> <li>Which interfaces are bridge members?</li> <li>Which interfaces have VLAN filtering enabled?</li> </ul>"},{"location":"exercises/ex3-spanning-tree.html#task-2-examine-link-topology","title":"Task 2: Examine link topology","text":"<ol> <li>Check which interfaces connect to other switches:</li> </ol> <pre><code>/interface bridge port print\n</code></pre> <p>Expected output:</p> <ul> <li>Flat topology: ether10, ether12, ether8, ether2 as bridge members</li> <li>Segmented topology: ether12, ether10, ether8, ether2 as bridge members</li> </ul> <p>Questions:</p> <ul> <li>How many links connect sw-dist to sw-acc1?</li> <li>(Segmented) Are both bond members active?</li> </ul>"},{"location":"exercises/ex3-spanning-tree.html#task-3-capture-bpdu-frames","title":"Task 3: Capture BPDU frames","text":"<ol> <li>In TopoViewer, start Wireshark capture on link between <code>sw-dist</code> and <code>sw-acc1</code></li> <li>Apply filter:</li> </ol> <pre><code>stp\n</code></pre> <p>Or alternatively:</p> <pre><code>eth.dst == 01:80:c2:00:00:00\n</code></pre> <p>Observations:</p> <ul> <li>BPDUs sent to multicast address <code>01:80:c2:00:00:00</code></li> <li>Root bridge identifier</li> <li>Port roles (designated, root)</li> <li> <p>Bridge priority values</p> </li> <li> <p>Check bridge settings on both switches:</p> </li> </ul> <p>On <code>sw-dist</code>:</p> <pre><code>/interface bridge print detail\n</code></pre> <p>On <code>sw-acc1</code> (SSH to 192.168.100.13):</p> <pre><code>/interface bridge print detail\n</code></pre> <p>Question: Which switch has lower priority and becomes root bridge?</p>"},{"location":"exercises/ex3-spanning-tree.html#task-4-understand-redundancy-approach","title":"Task 4: Understand redundancy approach","text":"<p>In flat topology:</p> <ul> <li>Single link between switches</li> <li>STP prevents loops between other switch connections</li> <li>No link-level redundancy between sw-dist and sw-acc1</li> </ul> <p>In segmented topology:</p> <ul> <li>LACP bond provides link redundancy</li> <li>STP still runs on other ports</li> <li>Two complementary redundancy mechanisms</li> </ul> <p>From distribution switch, check configuration:</p> <pre><code>/interface ethernet print\n/interface bridge port print\n</code></pre> <p>Question: What happens if the single uplink fails in flat topology?</p>"},{"location":"exercises/ex3-spanning-tree.html#verification","title":"Verification","text":"<p>Success indicators:</p> <ul> <li>Bridge configuration shows vlan-filtering enabled</li> <li>BPDU frames visible in Wireshark captures</li> <li>Root bridge identified from bridge settings</li> <li>(Segmented) Bond interface exists with LACP active</li> <li>(Flat) Single link topology documented</li> <li>Understanding of how STP prevents loops</li> </ul>"},{"location":"exercises/ex3-spanning-tree.html#questions-to-consider","title":"Questions to Consider","text":"<ol> <li>Why does STP run even when there's no redundant path (flat)?</li> <li>(Segmented) What happens if one bond member fails?</li> <li>How quickly does STP reconverge after topology change?</li> <li>What security risks does STP present (BPDU attacks)?</li> </ol>"},{"location":"exercises/ex3-spanning-tree.html#common-issues","title":"Common Issues","text":"<ul> <li>Issue: No bonding interface visible in flat</li> <li> <p>Solution: Correct - flat topology has no bonding, only single links</p> </li> <li> <p>Issue: Cannot SSH to switches</p> </li> <li> <p>Solution: Use management IPs 192.168.100.11-14, not data plane IPs</p> </li> <li> <p>Issue: No BPDUs in capture</p> </li> <li> <p>Solution: BPDUs are sent periodically (every 2 seconds). Wait or generate topology change.</p> </li> <li> <p>Issue: Exercise says \"segmented only\" but I'm in flat</p> </li> <li>Solution: Exercise 3 works in both topologies - bonding tasks are marked as segmented-only within the exercise</li> </ul>"},{"location":"exercises/ex3-spanning-tree.html#solution","title":"Solution","text":"Click to reveal solution"},{"location":"exercises/ex3-spanning-tree.html#bridge-configuration","title":"Bridge configuration","text":"<p>OT-LAB RSTP Topology</p> <p>SSH to <code>sw-dist</code>:</p> <pre><code>ssh admin@192.168.100.12\n</code></pre> <p>View bridge:</p> <pre><code>/interface bridge print\n</code></pre> <p>Output:</p> <pre><code>Flags: X - disabled, R - running\n 0 R name=\"bridge\" mtu=auto actual-mtu=1500 l2mtu=65535 arp=enabled \n     arp-timeout=auto mac-address=XX:XX:XX:XX:XX:XX auto-mac=no \n     protocol-mode=rstp vlan-filtering=yes\n</code></pre> <p>Bridge ports:</p> <pre><code>/interface bridge port print\n</code></pre> <p>Flat topology shows ether10, ether12, ether8, ether2 as bridge members with VLAN settings.</p> <p>Segmented topology shows ether12, ether10, ether8, ether2 as bridge members with VLAN settings.</p> <p>Bonding not configured</p> <p>Link aggregation (bonding) is currently not configured in any lab topology. In both topologies, each switch connects via individual physical interfaces.</p>"},{"location":"exercises/ex3-spanning-tree.html#root-bridge-identification","title":"Root bridge identification","text":"<p>Check priority on both switches. Lower priority wins. Default priority is 32768.</p> <p>BPDU captures show root bridge ID in protocol fields.</p>"},{"location":"exercises/ex4-link-aggregation.html","title":"Exercise 4: Link Aggregation and Load Balancing","text":"<p>Time Estimate: 20-30 minutes Lab Topology: <code>ot-sec-segmented</code> only Difficulty:  Intermediate</p> <p>Exercise Not Yet Available</p> <p>Link aggregation is not currently configured in any lab topology. This exercise is planned for a future lab version.</p>"},{"location":"exercises/ex4-link-aggregation.html#learning-objectives","title":"Learning Objectives","text":"<ul> <li>Analyze LACP link aggregation operation</li> <li>Observe traffic distribution across bonded links</li> <li>Test link failover behavior</li> <li>Understand load balancing algorithms</li> </ul>"},{"location":"exercises/ex4-link-aggregation.html#prerequisites","title":"Prerequisites","text":"<ul> <li>Completed Exercise 3 (STP Analysis)</li> <li>Understanding of LACP concepts</li> <li>Wireshark experience</li> <li>Basic MikroTik commands</li> </ul>"},{"location":"exercises/ex4-link-aggregation.html#scenario","title":"Scenario","text":"<p>Link aggregation combines multiple physical links into one logical link for increased bandwidth and redundancy. LACP (802.3ad) dynamically negotiates bonding. Traffic is distributed across member links using a hash algorithm based on source/destination MAC, IP, or ports. Understanding how this works is important for capacity planning and troubleshooting in OT networks.</p>"},{"location":"exercises/ex4-link-aggregation.html#tasks","title":"Tasks","text":""},{"location":"exercises/ex4-link-aggregation.html#task-1-verify-lacp-negotiation","title":"Task 1: Verify LACP negotiation","text":"<ol> <li>SSH to <code>sw-dist</code>:</li> </ol> <pre><code>ssh admin@192.168.100.12\n</code></pre> <p>Default Credentials</p> <p>Password: <code>admin</code></p> <ol> <li>Monitor LACP protocol operation:</li> </ol> <pre><code>/interface bonding monitor bond-sw-acc1 once\n</code></pre> <p>Expected output includes:</p> <ul> <li><code>lacp-partner-system-id</code> - MAC of partner switch</li> <li><code>active-ports</code> - Number of active links</li> <li> <p><code>lacp-negotiated</code> - True/false</p> </li> <li> <p>Check detailed bonding configuration:</p> </li> </ul> <pre><code>/interface bonding print detail where name=bond-sw-acc1\n</code></pre> <p>Questions:</p> <ul> <li>What is the bonding mode?</li> <li>Which physical interfaces are slaves?</li> <li>What is the transmit hash policy?</li> </ul>"},{"location":"exercises/ex4-link-aggregation.html#task-2-observe-traffic-distribution","title":"Task 2: Observe traffic distribution","text":"<ol> <li>Start Wireshark captures on BOTH bond member links:</li> <li>Capture link <code>sw-dist</code> ether9 to <code>sw-acc1</code></li> <li> <p>Open second Wireshark for ether10</p> </li> <li> <p>SSH to <code>wago-plc2a-vlan10</code>:</p> </li> </ol> <pre><code>ssh admin@192.168.100.53\n</code></pre> <ol> <li>Generate continuous traffic with varying sources:</li> </ol> <pre><code>ping -f 1.1.1.1\n</code></pre> <p>Use <code>-f</code> (flood) for high packet rate to see distribution.</p> <ol> <li>Observe both Wireshark captures</li> </ol> <p>Questions:</p> <ul> <li>Is traffic balanced equally across both links?</li> <li>Do you see traffic on both links or just one?</li> <li>What determines which link is used for specific flows?</li> </ul>"},{"location":"exercises/ex4-link-aggregation.html#task-3-test-hash-algorithm","title":"Task 3: Test hash algorithm","text":"<ol> <li>Stop flood ping</li> <li>Generate traffic from multiple sources:</li> </ol> <p>Terminal 1 - <code>wago-plc2a-vlan10</code>:</p> <pre><code>ping -i 0.2 1.1.1.1\n</code></pre> <p>Terminal 2 - <code>wago-plc2b-vlan10</code>:</p> <pre><code>ssh admin@192.168.100.54\nping -i 0.2 1.1.1.1\n</code></pre> <ol> <li>Check packet counts on bond members:</li> </ol> <pre><code>/interface monitor-traffic ether9,ether10\n</code></pre> <p>Question: Are different source IPs distributed to different links?</p>"},{"location":"exercises/ex4-link-aggregation.html#task-4-test-link-failover","title":"Task 4: Test link failover","text":"<ol> <li>Keep pings running from previous step</li> <li>On <code>sw-dist</code>, disable one bond member:</li> </ol> <pre><code>/interface ethernet disable ether9\n</code></pre> <ol> <li>Observe:</li> <li>Do pings continue without interruption?</li> <li>How quickly does failover occur?</li> <li> <p>Check Wireshark on remaining active link</p> </li> <li> <p>Re-enable the interface:</p> </li> </ol> <pre><code>/interface ethernet enable ether9\n</code></pre> <ol> <li>Check bond status:</li> </ol> <pre><code>/interface bonding monitor bond-sw-acc1 once\n</code></pre> <p>Question: Does both links return to active state automatically?</p>"},{"location":"exercises/ex4-link-aggregation.html#verification","title":"Verification","text":"<p>Success indicators:</p> <ul> <li>LACP shows negotiated status</li> <li>Both bond members active</li> <li>Traffic visible on member links</li> <li>Failover occurs in under 1 second</li> <li>Disabled link automatically rejoins when enabled</li> <li>Packet count increases on both interfaces</li> </ul>"},{"location":"exercises/ex4-link-aggregation.html#questions-to-consider","title":"Questions to Consider","text":"<ol> <li>Why might traffic use only one link for a specific flow?</li> <li>What are advantages and disadvantages of different hash algorithms?</li> <li>How does LACP compare to static bonding?</li> <li>What happens if LACP hello packets are lost?</li> </ol>"},{"location":"exercises/ex4-link-aggregation.html#common-issues","title":"Common Issues","text":"<ul> <li>Issue: Traffic only uses one link</li> <li> <p>Solution: Hash algorithm makes per-flow decisions. Single source/destination uses one link. Use multiple sources to see distribution.</p> </li> <li> <p>Issue: Cannot monitor traffic on interface</p> </li> <li> <p>Solution: Use <code>/interface monitor-traffic ether9,ether10</code> command format</p> </li> <li> <p>Issue: Failover takes several seconds</p> </li> <li>Solution: This is normal for LACP. RSTP must also reconverge.</li> </ul>"},{"location":"exercises/ex4-link-aggregation.html#solution","title":"Solution","text":"Click to reveal solution"},{"location":"exercises/ex4-link-aggregation.html#traffic-distribution-observation","title":"Traffic distribution observation","text":"<p>With single source ping, traffic typically uses one link consistently due to hash algorithm using source/destination IPs.</p> <p>With multiple sources (different source IPs), traffic distributes across links.</p> <p>Hash policy <code>layer-2-and-3</code> uses source/dest MAC and IP addresses.</p>"},{"location":"exercises/ex4-link-aggregation.html#packet-count-verification","title":"Packet count verification","text":"<pre><code>/interface monitor-traffic ether9,ether10\n</code></pre> <p>Shows rx-packets-per-second and tx-packets-per-second for each interface.</p> <p>With diverse traffic, both interfaces show increasing packet counts.</p>"},{"location":"exercises/ex4-link-aggregation.html#failover-test","title":"Failover test","text":"<p>Disable one member:</p> <pre><code>/interface ethernet disable ether9\n</code></pre> <p>Pings continue without interruption. All traffic switches to ether10.</p> <p>Re-enable:</p> <pre><code>/interface ethernet enable ether9\n</code></pre> <p>LACP renegotiates (takes few seconds), then both links active again.</p> <p>Failover is subsecond for established flows.</p>"},{"location":"exercises/ex5-reconnaissance.html","title":"Exercise 5: Remote Access and Security Assessment","text":"<p>Time Estimate: 35-45 minutes Lab Topology: <code>ot-sec-flat</code> (easier) or <code>ot-sec-segmented</code> (realistic) Difficulty:  Intermediate</p>"},{"location":"exercises/ex5-reconnaissance.html#learning-objectives","title":"Learning Objectives","text":"<ul> <li>Conduct remote access testing from DMZ jumphost</li> <li>Identify exposed services via port scanning</li> <li>Discover potential security vulnerabilities</li> <li>Practice professional security assessment methodology</li> </ul>"},{"location":"exercises/ex5-reconnaissance.html#prerequisites","title":"Prerequisites","text":"<ul> <li>Understanding of TCP/IP fundamentals</li> <li>Basic nmap knowledge</li> <li>SSH and service concepts</li> <li>Security assessment awareness</li> </ul>"},{"location":"exercises/ex5-reconnaissance.html#scenario","title":"Scenario","text":"<p>A security assessor has remote access to the jumphost in the DMZ. The objective is to map the OT network, identify running services, and document potential security issues. This simulates real-world remote access scenarios where engineers or attackers gain initial foothold and attempt to expand access into OT zones.</p>"},{"location":"exercises/ex5-reconnaissance.html#tasks","title":"Tasks","text":""},{"location":"exercises/ex5-reconnaissance.html#task-1-initial-remote-access-from-jumphost","title":"Task 1: Initial remote access from jumphost","text":"<ol> <li>SSH to jumphost:</li> </ol> <pre><code>ssh admin@192.168.100.52\n</code></pre> <p>Default Credentials</p> <p>Password: <code>admin</code></p> <ol> <li>Check your network position:</li> </ol> <pre><code>ip addr show\nip route show\n</code></pre> <p>Questions:</p> <ul> <li>What IP address does the jumphost have?</li> <li> <p>What networks are reachable according to routing table?</p> </li> <li> <p>Test basic connectivity:</p> </li> </ul> <pre><code>ping -c 3 10.10.0.1\nping -c 3 10.10.0.11\n</code></pre> <p>Note: In segmented topology, firewall may block some traffic.</p>"},{"location":"exercises/ex5-reconnaissance.html#task-2-host-discovery","title":"Task 2: Host discovery","text":"<ol> <li>Scan VLAN 10 (Hygiene) for live hosts:</li> </ol> <pre><code>nmap -sn 10.10.0.0/24\n</code></pre> <p><code>-sn</code> performs ping scan (no port scan)</p> <p>Expected output:</p> <pre><code>Nmap scan report for 10.10.0.1\nHost is up.\n\nNmap scan report for 10.10.0.11\nHost is up.\n\nNmap scan report for 10.10.0.12\nHost is up.\n</code></pre> <ol> <li>Try other VLANs:</li> </ol> <pre><code>nmap -sn 10.20.0.0/24\nnmap -sn 10.40.0.0/24\n</code></pre> <p>Question: Which VLANs are accessible from jumphost?</p>"},{"location":"exercises/ex5-reconnaissance.html#task-3-service-identification","title":"Task 3: Service identification","text":"<ol> <li>Scan common OT ports on discovered PLC:</li> </ol> <pre><code>nmap -sV -p22,80,502,8080,2455 10.10.0.11\n</code></pre> <p>Port reference:</p> <ul> <li>22: SSH</li> <li>80: HTTP</li> <li>502: Modbus TCP</li> <li>8080: CODESYS WebVisu</li> <li>2455: CODESYS runtime</li> </ul> <p>Expected output:</p> <pre><code>PORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 8.x\n8080/tcp open  http    nginx\n</code></pre> <ol> <li>Scan all PLCs in VLAN 10:</li> </ol> <pre><code>nmap -p8080 10.10.0.11-12\n</code></pre> <p>Questions:</p> <ul> <li>Which services are exposed?</li> <li>Are any services running that should not be?</li> <li>What can you infer about the devices from service banners?</li> </ul>"},{"location":"exercises/ex5-reconnaissance.html#task-4-access-testing","title":"Task 4: Access testing","text":"<ol> <li>Test SSH access to PLC:</li> </ol> <pre><code>ssh admin@10.10.0.11\n</code></pre> <p>Try password: <code>admin</code></p> <p>Question: Does this succeed? Should PLCs be directly accessible via SSH from jumphost?</p> <ol> <li>Test web interface access:</li> </ol> <pre><code>curl -I http://10.10.0.11:8080\n</code></pre> <p>Observation: Check HTTP response headers for version information.</p> <ol> <li>If <code>nc</code> available, test Modbus port:</li> </ol> <pre><code>nc -zv 10.10.0.11 502\n</code></pre>"},{"location":"exercises/ex5-reconnaissance.html#task-5-document-findings","title":"Task 5: Document findings","text":"<p>Create a simple report of findings:</p> <pre><code>cat &gt; assessment_findings.txt &lt;&lt; 'EOF'\nOT Network Security Assessment\n\nDate: $(date)\nAssessor: $(whoami)\n\nFINDINGS:\n\n1. Accessible Networks:\n   - VLAN 10: [list discovered hosts]\n   - VLAN 20: [accessible? yes/no]\n\n2. Exposed Services:\n   - Host 10.10.0.11:\n     * Port 22 (SSH): OPEN\n     * Port 8080 (HTTP): OPEN\n     * Port 502 (Modbus): [status]\n\n3. Security Issues:\n   - [List any concerns]\n\n4. Recommendations:\n   - [Suggested mitigations]\nEOF\n\ncat assessment_findings.txt\n</code></pre>"},{"location":"exercises/ex5-reconnaissance.html#verification","title":"Verification","text":"<p>Success indicators:</p> <ul> <li>Host discovery identifies live PLCs</li> <li>Service scans reveal open ports</li> <li>SSH access tested (may succeed or fail depending on firewall)</li> <li>HTTP interfaces discovered</li> <li>Findings documented</li> </ul>"},{"location":"exercises/ex5-reconnaissance.html#questions-to-consider","title":"Questions to Consider","text":"<ol> <li>What services should never be directly accessible from DMZ?</li> <li>How would you restrict jumphost access in production?</li> <li>What additional security controls would improve this architecture?</li> <li>How could these remote access activities be detected?</li> </ol>"},{"location":"exercises/ex5-reconnaissance.html#common-issues","title":"Common Issues","text":"<ul> <li>Issue: nmap command not found</li> <li> <p>Solution: Use <code>apt-get update &amp;&amp; apt-get install nmap</code> or tool is pre-installed</p> </li> <li> <p>Issue: All hosts appear down</p> </li> <li> <p>Solution: In segmented topology, firewall may block ICMP. Use <code>-Pn</code> flag to skip ping.</p> </li> <li> <p>Issue: Cannot reach any 10.x networks</p> </li> <li>Solution: Check routing with <code>ip route</code>. Verify lab deployed correctly.</li> </ul>"},{"location":"exercises/ex5-reconnaissance.html#advanced-challenge","title":"Advanced Challenge","text":"<ol> <li>Write a shell script to automate discovery of all VLANs</li> <li>Generate a CSV report of all discovered services</li> <li>Test for default credentials on discovered services</li> <li>Create network diagram based on discovered topology</li> </ol>"},{"location":"exercises/ex5-reconnaissance.html#solution","title":"Solution","text":"Click to reveal solution"},{"location":"exercises/ex5-reconnaissance.html#host-discovery-results","title":"Host discovery results","text":"<p>From jumphost:</p> <pre><code>nmap -sn 10.10.0.0/24\n</code></pre> <p>Expected discoveries in flat topology:</p> <pre><code>10.10.0.1 (gateway)\n10.10.0.11 (wago-plc2a-vlan10)\n10.10.0.12 (wago-plc2b-vlan10)\n</code></pre> <p>Segmented topology may show fewer hosts due to firewall rules.</p>"},{"location":"exercises/ex5-reconnaissance.html#service-scan-results","title":"Service scan results","text":"<pre><code>nmap -sV -p22,80,502,8080,2455 10.10.0.11\n</code></pre> <p>Expected output:</p> <pre><code>PORT     STATE SERVICE  VERSION\n22/tcp   open  ssh      OpenSSH 8.2p1 Ubuntu\n8080/tcp open  http     nginx 1.18.0\n</code></pre> <p>Other ports may be filtered or closed depending on PLC configuration.</p>"},{"location":"exercises/ex5-reconnaissance.html#access-testing","title":"Access testing","text":"<p>SSH to PLC:</p> <pre><code>ssh admin@10.10.0.11\n</code></pre> <p>In flat topology: Likely succeeds with password <code>admin</code>. In segmented topology: May be blocked by firewall rules.</p> <p>Web interface:</p> <pre><code>curl -I http://10.10.0.11:8080\n</code></pre> <p>Returns HTTP headers showing CODESYS WebVisu interface.</p>"},{"location":"exercises/ex5-reconnaissance.html#security-findings","title":"Security findings","text":"<p>Typical issues discovered:</p> <ol> <li>PLCs accessible via SSH with default credentials</li> <li>Web interfaces exposed without authentication</li> <li>Modbus TCP accessible without authentication</li> <li>No network segmentation (flat topology)</li> <li>Default passwords in use</li> <li>Unnecessary services running</li> </ol>"},{"location":"exercises/ex5-reconnaissance.html#recommended-mitigations","title":"Recommended mitigations","text":"<ol> <li>Implement zero-trust network segmentation</li> <li>Require multi-factor authentication for remote access</li> <li>Disable unused services on PLCs</li> <li>Change default credentials</li> <li>Implement application-aware firewall rules</li> <li>Deploy IDS/IPS for anomaly detection</li> <li>Require VPN for remote access</li> <li>Implement jump host hardening</li> </ol>"},{"location":"exercises/ex6-protocol-discovery.html","title":"Exercise 6: OT Protocol Discovery","text":"<p>Time Estimate: 45-50 minutes Lab Topology: <code>ot-sec-flat</code> (recommended) or <code>ot-sec-segmented</code> Difficulty:  Intermediate</p>"},{"location":"exercises/ex6-protocol-discovery.html#learning-objectives","title":"Learning Objectives","text":"<ul> <li>Discover OT protocols in live traffic</li> <li>Identify Modbus TCP communication</li> <li>Analyze CODESYS runtime protocol</li> <li>Assess OPC UA security configurations</li> <li>Recognize PROFINET characteristics</li> <li>Understand security implications of cleartext protocols</li> </ul>"},{"location":"exercises/ex6-protocol-discovery.html#prerequisites","title":"Prerequisites","text":"<ul> <li>Exercise 1 (Wireshark basics)</li> <li>Basic understanding of TCP/IP</li> </ul>"},{"location":"exercises/ex6-protocol-discovery.html#scenario","title":"Scenario","text":"<p>In an OT environment, visibility is key. Unlike IT networks where HTTPS and SSH dominate, OT networks often rely on cleartext protocols like Modbus TCP and proprietary protocols like CODESYS. In this exercise, you will generate traffic between an HMI and a PLC, capture it, and analyze the protocol details to understand what an attacker could see.</p>"},{"location":"exercises/ex6-protocol-discovery.html#tasks","title":"Tasks","text":""},{"location":"exercises/ex6-protocol-discovery.html#task-1-generate-ot-traffic","title":"Task 1: Generate OT Traffic","text":"<p>To analyze traffic, we first need to generate it. We will use the HMI to interact with a PLC's web visualization.</p> <ol> <li> <p>Under Ports goto: HMI Chromium browser</p> </li> <li> <p>On the HMI desktop, open the Chromium web browser.</p> </li> <li> <p>Navigate to the WebVisu of <code>wago-plc2a-vlan10</code>:</p> <ul> <li>URL: <code>http://10.10.0.11:8080/webvisu.htm</code></li> <li>(If that doesn't load, try <code>http://10.10.0.11:8080</code>)</li> </ul> </li> <li> <p>Interact with the visualization (click buttons, toggle switches) to generate traffic.</p> </li> </ol>"},{"location":"exercises/ex6-protocol-discovery.html#task-2-capture-traffic-with-wireshark","title":"Task 2: Capture Traffic with Wireshark","text":"<p>Now we will capture the traffic flowing to the PLC using the integrated lab tools.</p> <ol> <li> <p>In VS Code, go to the Containerlab extension (TopoViewer).</p> </li> <li> <p>Locate the link between <code>wago-plc2a-vlan10</code> and <code>sw-acc1</code>.</p> </li> <li> <p>Right-click the link (or the interface dot on the PLC side) and select Wireshark Capture.</p> <ul> <li>This will launch a Wireshark instance directly in your browser/editor via Edgeshark.</li> </ul> </li> <li> <p>Go back to the HMI (VNC) and interact with the WebVisu again for 10-15 seconds (click buttons, toggle switches).</p> </li> <li> <p>Return to the Wireshark window. You should see packets appearing in real-time.</p> </li> <li> <p>Stop the capture (red square button in Wireshark toolbar) to analyze the data.</p> </li> </ol>"},{"location":"exercises/ex6-protocol-discovery.html#task-3-analyze-modbus-tcp","title":"Task 3: Analyze Modbus TCP","text":"<ol> <li> <p>In Wireshark, filter for Modbus TCP traffic:</p> <pre><code>mbtcp\n</code></pre> <p>Note: If you don't see <code>mbtcp</code>, try filtering for port <code>tcp.port == 502</code>.</p> </li> <li> <p>Select a packet. Expand the Modbus section in the packet details.</p> </li> <li> <p>Questions:</p> <ul> <li>What Function Codes do you see? (e.g., Read Holding Registers, Write Single Coil)</li> <li>Can you see the values being read or written?</li> <li>Is there any encryption or authentication?</li> </ul> </li> </ol>"},{"location":"exercises/ex6-protocol-discovery.html#task-4-analyze-codesys-protocol","title":"Task 4: Analyze CODESYS Protocol","text":"<p>The WebVisu communicates with the runtime, often using proprietary protocols or HTTP/XML. However, the engineering workstation would use the CODESYS protocol. Let's look for that or other management traffic.</p> <ol> <li> <p>Clear the filter and look for traffic on port 2455 (UDP) or 1217 (TCP).</p> <pre><code>udp.port == 2455 || tcp.port == 1217\n</code></pre> </li> <li> <p>If you don't see this traffic, it might be because we are only using WebVisu. To generate CODESYS engineering traffic, we would need the CODESYS IDE.</p> <p>Alternative: Look for the HTTP traffic for the WebVisu.</p> <pre><code>http &amp;&amp; ip.addr == 10.10.0.11\n</code></pre> </li> <li> <p>Analyze the HTTP streams.</p> <ul> <li>Right-click a packet -&gt; Follow -&gt; HTTP Stream.</li> <li>Observe that the visualization data is transferred in cleartext (unless HTTPS is configured, which is often not the default in older setups).</li> </ul> </li> </ol>"},{"location":"exercises/ex6-protocol-discovery.html#task-5-analyze-opc-ua-security-configuration","title":"Task 5: Analyze OPC UA Security Configuration","text":"<p>OPC UA is the modern Industry 4.0 protocol standard. Unlike Modbus, it was designed with security features, but these are often disabled in production environments. Your job as an OT security professional is to assess whether security is properly configured.</p>"},{"location":"exercises/ex6-protocol-discovery.html#background","title":"Background","text":"<p>OPC UA supports:</p> <ul> <li>Encryption (SignAndEncrypt)</li> <li>Authentication (Username/Password or Certificate-based)</li> <li>Authorization (Role-based access control)</li> </ul> <p>However, most deployments run with <code>SecurityPolicy=None</code> and <code>Anonymous</code> authentication for simplicity or legacy compatibility.</p>"},{"location":"exercises/ex6-protocol-discovery.html#generate-opc-ua-traffic","title":"Generate OPC UA Traffic","text":"<p>The lab PLCs have OPC UA servers enabled on port 4840:</p> <ul> <li><code>ctrlx-plc3-vlan20</code> at <code>10.20.0.11:4840</code></li> <li><code>schneider-plc4-vlan30</code> at <code>10.30.0.11:4840</code></li> </ul> <p>We need to generate OPC UA traffic to analyze it. The simplest approach is to use the HMI's web browser.</p> <p>Generate Traffic from HMI</p> <ol> <li> <p>Open the HMI Chromium Browser under Ports</p> </li> <li> <p>In the HMI Chromium browser, open a new tab</p> </li> <li> <p>Navigate to: <code>http://10.20.0.11:8080/webvisu.htm</code></p> </li> <li>The WebVisu may communicate with the PLC using OPC UA in the background</li> <li>Interact with the visualization to generate traffic</li> </ol> <p>Alternative: Test Connection from Jumphost</p> <p>If you have terminal access to the jumphost, verify OPC UA port is accessible:</p> <pre><code># Test connectivity\nnc -zv 10.20.0.11 4840\n\n# Send a simple connection probe\ntimeout 2 telnet 10.20.0.11 4840\n</code></pre> <p>You should see a connection established, confirming the OPC UA server is running.</p>"},{"location":"exercises/ex6-protocol-discovery.html#capture-opc-ua-traffic","title":"Capture OPC UA Traffic","text":"<ol> <li>Start Wireshark capture on the link between <code>ctrlx-plc3-vlan20</code> and <code>sw-acc1</code></li> <li>Execute the OPC UA client connection (Option A or B above)</li> <li>Stop the capture after the connection completes</li> </ol>"},{"location":"exercises/ex6-protocol-discovery.html#analyze-security-configuration","title":"Analyze Security Configuration","text":"<ol> <li> <p>Filter for OPC UA traffic:</p> <pre><code>opcua\n</code></pre> <p>Or by port:</p> <pre><code>tcp.port == 4840\n</code></pre> </li> <li> <p>Locate the CreateSessionRequest packet:</p> <ul> <li>Expand: <code>OpcUa Binary Protocol -&gt; Message -&gt; CreateSessionRequest</code></li> <li>Find: <code>SecurityPolicyUri</code></li> <li>Check value: <code>http://opcfoundation.org/UA/SecurityPolicy#None</code> indicates no encryption</li> </ul> </li> <li> <p>Locate the ActivateSessionRequest packet:</p> <ul> <li>Expand: <code>OpcUa Binary Protocol -&gt; Message -&gt; ActivateSessionRequest</code></li> <li>Check: <code>UserIdentityToken</code></li> <li>Look for: <code>AnonymousIdentityToken</code> indicates no authentication</li> </ul> </li> <li> <p>Analyze a BrowseRequest/Response:</p> <ul> <li>This shows the PLC's complete tag structure</li> <li>All tag names are visible in cleartext</li> <li>An attacker can map the entire process data model</li> </ul> </li> <li> <p>Look at ReadRequest/Response:</p> <ul> <li>Variable values are transmitted in cleartext</li> <li>No integrity protection</li> <li>An attacker can see real-time process values</li> </ul> </li> </ol>"},{"location":"exercises/ex6-protocol-discovery.html#assessment-questions","title":"Assessment Questions","text":"<ol> <li>What SecurityPolicy is configured? (Expected: None)</li> <li>Is the communication encrypted? (Expected: No)</li> <li>What authentication is required? (Expected: Anonymous - none)</li> <li>Can you see tag names in the Browse response? (Expected: Yes)</li> <li>Can you see variable values in Read responses? (Expected: Yes)</li> <li>What IEC 62443 requirements are violated?<ul> <li>SR 1.1: Human user identification and authentication (FAIL - Anonymous)</li> <li>SR 3.1: Communication integrity (FAIL - No signing)</li> <li>SR 4.1: Information confidentiality (FAIL - No encryption)</li> </ul> </li> </ol>"},{"location":"exercises/ex6-protocol-discovery.html#real-world-context","title":"Real-World Context","text":"<p>This is one of the most common findings in OT security audits. OPC UA has excellent security features, but organizations disable them because:</p> <ul> <li>Configuration complexity (perceived, not actual)</li> <li>Legacy compatibility concerns (sometimes valid)</li> <li>Performance myths (encryption overhead is negligible on modern hardware)</li> <li>Lack of awareness (most common reason)</li> </ul> <p>Audit Recommendation: Enable OPC UA security with <code>SecurityPolicy=Basic256Sha256</code>, <code>SecurityMode=SignAndEncrypt</code>, and certificate-based authentication. Test with existing clients to verify compatibility.</p>"},{"location":"exercises/ex6-protocol-discovery.html#task-6-profinet-protocol-recognition","title":"Task 6: PROFINET Protocol Recognition","text":"<p>PROFINET is the dominant real-time industrial Ethernet protocol in European manufacturing, particularly in automotive and process industries. Unlike the previous protocols which operate at TCP/IP layers, PROFINET real-time traffic runs directly on Layer 2 (Ethernet frames) for microsecond-level control.</p>"},{"location":"exercises/ex6-protocol-discovery.html#key-differences","title":"Key Differences","text":"Aspect Modbus/OPC UA PROFINET RT OSI Layer Layer 4 (TCP) Layer 2 (Ethernet) Can Route? Yes No (requires L2 adjacency) Encryption Possible No (real-time constraints) Monitoring Routed TAP SPAN port required"},{"location":"exercises/ex6-protocol-discovery.html#why-this-matters","title":"Why This Matters","text":"<p>Understanding Layer 2 protocols changes your security assessment approach:</p> <ul> <li>Cannot segment across subnets - PROFINET requires L2 adjacency</li> <li>Cannot encrypt - Real-time performance requirements (sub-millisecond latency)</li> <li>Different IDS placement - Must use SPAN ports, not routed TAPs</li> <li>Security is architectural - Physical access control, VLAN isolation, anomaly detection</li> </ul>"},{"location":"exercises/ex6-protocol-discovery.html#capture-profinet-traffic","title":"Capture PROFINET Traffic","text":"<p>The ABB 800xA system (<code>abb-800xa-vlan40</code> at <code>10.40.0.11</code>) has active PROFINET Real-Time communication running.</p> <ol> <li> <p>In VS Code, go to the Containerlab extension (TopoViewer)</p> </li> <li> <p>Locate the link between <code>abb-800xa-vlan40</code> and <code>sw-acc2</code></p> </li> <li> <p>Right-click the link and select Wireshark Capture</p> </li> <li> <p>Let it capture for 10-15 seconds to collect PROFINET frames</p> </li> <li> <p>Stop the capture</p> </li> </ol>"},{"location":"exercises/ex6-protocol-discovery.html#analyze-profinet-real-time-traffic","title":"Analyze PROFINET Real-Time Traffic","text":"<p>Filter for PROFINET:</p> <pre><code># PROFINET Real-Time traffic\neth.type == 0x8892\n</code></pre> <p>Or in Wireshark display filter:</p> <pre><code>pn_io\n</code></pre> <p>What You Should See:</p> <ol> <li> <p>Ethertype 0x8892 - Real-time cyclic I/O data</p> <ul> <li>No TCP/IP headers (this is Layer 2, not TCP/IP)</li> <li>Direct Ethernet frames</li> <li>Source/Destination MAC addresses visible</li> </ul> </li> <li> <p>FrameID in hex (typically 0x8000-0x8001)</p> <ul> <li>0x8000 range = RT cyclic data</li> <li>Look at the packet details for the FrameID field</li> </ul> </li> <li> <p>Cyclic Pattern</p> <ul> <li>PROFINET RT runs at fixed intervals (typically 1-10ms)</li> <li>In this lab: approximately 4ms cycle time</li> <li>Packet timing is extremely regular</li> <li>Select several packets and check the time delta between them</li> </ul> </li> <li> <p>Payload Data</p> <ul> <li>Raw I/O data (digital/analog values)</li> <li>No encryption possible (real-time performance requirement)</li> <li>Process values are transmitted in cleartext</li> </ul> </li> </ol>"},{"location":"exercises/ex6-protocol-discovery.html#assessment-questions_1","title":"Assessment Questions","text":"<ol> <li>What is the Ethertype? (Expected: 0x8892)</li> <li>Are there TCP/IP headers? (Expected: No - this is Layer 2)</li> <li>What is the approximate cycle time? (Measure time between packets - should be ~4ms)</li> <li>Can you see MAC addresses? (Expected: Yes - 00:03:2c:40:00:11 and 00:0b:0f:20:00:11)</li> <li>Is the data encrypted? (Expected: No - cannot encrypt real-time traffic)</li> <li>What happens if you filter for <code>tcp</code> or <code>udp</code>? (Expected: PROFINET RT won't appear - it's Layer 2)</li> </ol>"},{"location":"exercises/ex6-protocol-discovery.html#security-implications","title":"Security Implications","text":"<p>Attack Scenarios:</p> <ul> <li>Reconnaissance: DCP broadcasts reveal all devices, vendors, firmware versions</li> <li>Topology Mapping: LLDP (often used with PROFINET) exposes network architecture</li> <li>Packet Injection: Attacker on same L2 segment can forge RT frames</li> <li>Timing Attacks: Disrupting cyclic timing can cause emergency stops</li> </ul> <p>Defense Requirements:</p> <ul> <li>Physical Security: Must protect L2 access (switch ports)</li> <li>VLAN Isolation: Separate PROFINET domains</li> <li>Port Security: MAC address filtering on switches</li> <li>Anomaly Detection: Monitor for timing irregularities, unexpected devices</li> <li>No Application-Layer Security: Cannot use encryption, TLS, etc.</li> </ul> <p>IEC 62443 Context:</p> <p>PROFINET predates IEC 62443 and was designed for performance, not security. Security must be implemented through:</p> <ul> <li>Network architecture (zones and conduits)</li> <li>Physical access control</li> <li>Monitoring and detection (not prevention at protocol level)</li> </ul>"},{"location":"exercises/ex6-protocol-discovery.html#task-7-protocol-comparison-and-security-assessment","title":"Task 7: Protocol Comparison and Security Assessment","text":"<p>Now that you've analyzed multiple OT protocols, compare their security characteristics and understand when you'll encounter each in real environments.</p>"},{"location":"exercises/ex6-protocol-discovery.html#protocol-comparison-matrix","title":"Protocol Comparison Matrix","text":"Protocol Layer Port/Type Encryption Auth Primary Use Case Security Approach Modbus TCP L4 TCP 502 No No Legacy SCADA, simple PLC polling Segmentation, monitoring, consider Modbus/TLS CODESYS L4 TCP/UDP 1217, 2455 Optional Optional PLC engineering, diagnostics Disable in production, use only during maintenance OPC UA L4 TCP 4840 Yes (often disabled) Yes (often disabled) Vertical integration, MES/SCADA, Industry 4.0 Enable built-in security features PROFINET RT L2 Ethernet 0x8892 No (impossible) No Real-time I/O control, automotive, discrete manufacturing Physical + architectural controls"},{"location":"exercises/ex6-protocol-discovery.html#critical-assessment-questions","title":"Critical Assessment Questions","text":"<p>For each protocol discovered in an OT environment, ask:</p> <ol> <li> <p>Is this protocol necessary?</p> <ul> <li>CODESYS engineering ports should be disabled in production</li> <li>Modbus may be legacy and replaceable with OPC UA</li> </ul> </li> <li> <p>Is security configured optimally?</p> <ul> <li>OPC UA: SecurityPolicy and authentication should be enabled</li> <li>Modbus: Consider upgrading to Modbus/TLS or wrapping in VPN</li> </ul> </li> <li> <p>Is network architecture appropriate?</p> <ul> <li>All protocols: Proper VLAN segmentation</li> <li>PROFINET: Must have L2 isolation, cannot route</li> <li>OPC UA: Can route, consider firewall rules between zones</li> </ul> </li> <li> <p>Is monitoring in place?</p> <ul> <li>Modbus/OPC UA: Can monitor at L3/L4 (routed TAP or firewall logs)</li> <li>PROFINET: Requires L2 SPAN port to switch</li> <li>All: Baseline normal behavior, alert on anomalies</li> </ul> </li> </ol>"},{"location":"exercises/ex6-protocol-discovery.html#audit-checklist","title":"Audit Checklist","text":"<p>When assessing an OT environment:</p> <ul> <li>[ ] Inventory all protocols in use (Wireshark on SPAN ports)</li> <li>[ ] For OPC UA: Verify SecurityPolicy is NOT None</li> <li>[ ] For OPC UA: Verify authentication is required (not Anonymous)</li> <li>[ ] For Modbus: Verify network segmentation prevents unauthorized access</li> <li>[ ] For CODESYS: Verify engineering ports are disabled or access-controlled</li> <li>[ ] For PROFINET: Verify VLAN isolation and port security</li> <li>[ ] For all: Verify monitoring/IDS is in place and tuned for OT protocols</li> <li>[ ] Document findings with specific IEC 62443 SR violations</li> </ul>"},{"location":"exercises/ex6-protocol-discovery.html#iec-62443-security-requirements-mapping","title":"IEC 62443 Security Requirements Mapping","text":"SR Requirement Modbus TCP OPC UA (Misconfigured) OPC UA (Proper) PROFINET SR 1.1 Human user identification Not Applicable FAIL (Anonymous) PASS (Certificate) Not Applicable SR 3.1 Communication integrity FAIL (No protection) FAIL (No signing) PASS (Signed) FAIL (No protection) SR 4.1 Information confidentiality FAIL (Cleartext) FAIL (No encryption) PASS (Encrypted) FAIL (Impossible) SR 5.1 Network segmentation Required Required Recommended Critical"},{"location":"exercises/ex6-protocol-discovery.html#conclusion-defense-in-depth","title":"Conclusion: Defense in Depth","text":"<p>No single protocol security feature provides complete protection. OT security requires:</p> <ol> <li>Protocol-level security (where available) - Enable OPC UA security features</li> <li>Network architecture - Proper segmentation, VLANs, access control</li> <li>Monitoring and detection - Baseline normal behavior, alert on anomalies</li> <li>Physical security - Particularly for L2 protocols like PROFINET</li> <li>Access management - Disable unnecessary services (CODESYS in production)</li> </ol> <p>Key Takeaway: Legacy protocols (Modbus) require compensating controls. Modern protocols (OPC UA) have security features that must be enabled. Real-time protocols (PROFINET) require architectural security because protocol-level security isn't possible.</p>"},{"location":"exercises/ex6-protocol-discovery.html#conclusion","title":"Conclusion","text":"<p>This exercise demonstrated the security reality of OT protocols:</p> <ul> <li>Legacy protocols (Modbus) have no security features - rely on segmentation and monitoring</li> <li>Modern protocols (OPC UA) have excellent security features that are often disabled - audit and enable them</li> <li>Real-time protocols (PROFINET) cannot use encryption - require architectural controls</li> <li>All protocols benefit from network segmentation, monitoring, and proper access control</li> </ul> <p>As an OT security professional, your role is to:</p> <ol> <li>Inventory what protocols are in use</li> <li>Assess their security configuration</li> <li>Identify gaps against IEC 62443 requirements</li> <li>Recommend practical, operations-friendly mitigations</li> <li>Implement monitoring to detect unauthorized protocol usage</li> </ol> <p>The protocols you analyzed today represent 80% of what you'll encounter in real industrial environments. Understanding their security characteristics is fundamental to effective OT security assessment.</p>"},{"location":"exercises/ex6-protocol-discovery.html#solution","title":"Solution","text":"Click to view solution <p>```</p>"},{"location":"exercises/ex6-protocol-discovery.html#task-1-generate-ot-traffic_1","title":"Task 1: Generate OT Traffic","text":"<p>In HMI desktop, open Chromium and navigate to WebVisu: <pre><code>http://10.10.0.11:8080/webvisu.htm\n</code></pre></p> <p>Interact with buttons and switches in the visualization to generate HTTP and potentially Modbus traffic.</p>"},{"location":"exercises/ex6-protocol-discovery.html#task-2-capture-traffic","title":"Task 2: Capture Traffic","text":"<ol> <li>Open VS Code Containerlab TopoViewer</li> <li>Right-click on link between <code>wago-plc2a-vlan10</code> and <code>sw-acc1</code></li> <li>Select \"Wireshark Capture\"</li> <li>Interact again with WebVisu in HMI</li> <li>Observe traffic in Wireshark</li> </ol>"},{"location":"exercises/ex6-protocol-discovery.html#task-3-analyze-modbus-tcp_1","title":"Task 3: Analyze Modbus TCP","text":"<p>Apply Wireshark filter: <pre><code>mbtcp\n</code></pre></p> <p>Or alternatively: <pre><code>tcp.port == 502\n</code></pre></p> <p>Expected Observations:</p> <ul> <li>Function Codes: Typically Read Holding Registers (0x03), Write Single Coil (0x05), Write Multiple Registers (0x10)</li> <li>Values visible: Yes - all register values visible in cleartext</li> <li>Encryption: No - Modbus TCP has no encryption</li> <li>Authentication: No - no authentication in protocol</li> </ul> <p>Security Implication: An attacker in the same network segment can: - Read all process values - Send commands to the PLC - Manipulate traffic (Man-in-the-Middle)</p> <p>From jumphost you can test Modbus connectivity: <pre><code>ssh admin@192.168.100.52\nnc -zv 10.10.0.11 502\n</code></pre></p> <p>Expected output: <pre><code>Connection to 10.10.0.11 502 port [tcp/*] succeeded!\n</code></pre></p>"},{"location":"exercises/ex6-protocol-discovery.html#task-4-analyze-codesys-protocol_1","title":"Task 4: Analyze CODESYS Protocol","text":"<p>Filter for HTTP traffic to WebVisu: <pre><code>http &amp;&amp; ip.addr == 10.10.0.11\n</code></pre></p> <p>Follow HTTP stream: - Right-click on HTTP packet - Follow \u2192 HTTP Stream - Observe visualization data in cleartext</p> <p>Expected Observations: - WebVisu uses HTTP (Port 8080) - No HTTPS encryption - Variable values and status in cleartext - Session information exposed</p> <p>For CODESYS runtime protocol (normally from engineering workstation): <pre><code>udp.port == 2455 || tcp.port == 1217\n</code></pre></p> <p>In the lab you may see little CODESYS runtime traffic as no engineering workstation is actively programming.</p> <p>Port overview on PLC:</p> <p>You can check open ports from jumphost or from PLC itself: <pre><code>ssh admin@192.168.100.53  # wago-plc2a-vlan10\nss -tuln | grep LISTEN\n</code></pre></p> <p>Expected output: <pre><code>tcp   LISTEN 0      5              0.0.0.0:8080       0.0.0.0:*    # WebVisu\ntcp   LISTEN 0      128            0.0.0.0:22         0.0.0.0:*    # SSH\ntcp   LISTEN 0      63          10.10.0.11:502        0.0.0.0:*    # Modbus\ntcp   LISTEN 0      10          10.10.0.11:4840       0.0.0.0:*    # OPC UA\n</code></pre></p>"},{"location":"exercises/ex6-protocol-discovery.html#task-5-analyze-opc-ua-security-configuration_1","title":"Task 5: Analyze OPC UA Security Configuration","text":"<p>Generate OPC UA Traffic:</p> <p>Option 1 - From HMI browser: <pre><code>http://10.20.0.11:8080/webvisu.htm  # ctrlx-plc3-vlan20\n</code></pre></p> <p>Option 2 - Test connectivity from jumphost: <pre><code>ssh admin@192.168.100.52\nnc -zv 10.20.0.11 4840\n</code></pre></p> <p>Expected output: <pre><code>Connection to 10.20.0.11 4840 port [tcp/*] succeeded!\n</code></pre></p> <p>Wireshark Analysis:</p> <p>Capture traffic between <code>ctrlx-plc3-vlan20</code> and <code>sw-acc1</code>.</p> <p>Filter for OPC UA: <pre><code>opcua\n</code></pre></p> <p>Or: <pre><code>tcp.port == 4840\n</code></pre></p> <p>Analyze CreateSessionRequest:</p> <p>Expand: <code>OpcUa Binary Protocol \u2192 Message \u2192 CreateSessionRequest</code></p> <p>Find: <code>SecurityPolicyUri</code></p> <p>Expected Value: <pre><code>http://opcfoundation.org/UA/SecurityPolicy#None\n</code></pre></p> <p>Meaning: No encryption enabled.</p> <p>Analyze ActivateSessionRequest:</p> <p>Expand: <code>OpcUa Binary Protocol \u2192 Message \u2192 ActivateSessionRequest</code></p> <p>Find: <code>UserIdentityToken</code></p> <p>Expected Type: <pre><code>AnonymousIdentityToken\n</code></pre></p> <p>Meaning: No authentication required.</p> <p>Analyze BrowseRequest/Response:</p> <ul> <li>Complete OPC UA node structure visible</li> <li>All tag names in cleartext</li> <li>Organization structure of process data model exposed</li> <li>Attacker can create complete asset inventory</li> </ul> <p>Analyze ReadRequest/Response:</p> <ul> <li>Variable values transmitted in cleartext</li> <li>No integrity protection</li> <li>No confidentiality</li> <li>Real-time process data visible to attacker</li> </ul> <p>Assessment Results:</p> <ol> <li>SecurityPolicy: None (FAIL)</li> <li>Encryption: No (FAIL)</li> <li>Authentication: Anonymous (FAIL)</li> <li>Tag names visible: Yes (FAIL)</li> <li>Variable values visible: Yes (FAIL)</li> </ol> <p>IEC 62443 Violations:</p> <ul> <li>SR 1.1 (Identification &amp; Authentication): FAIL</li> <li>SR 3.1 (Communication Integrity): FAIL</li> <li>SR 4.1 (Information Confidentiality): FAIL</li> </ul> <p>Recommendation:</p> <p>Change OPC UA server configuration: <pre><code>SecurityPolicy: Basic256Sha256\nSecurityMode: SignAndEncrypt\nAuthentication: Certificate-based\n</code></pre></p>"},{"location":"exercises/ex6-protocol-discovery.html#task-6-profinet-protocol-discovery","title":"Task 6: PROFINET Protocol Discovery","text":"<p>Capture PROFINET Traffic:</p> <p>Capture traffic between <code>abb-800xa-vlan40</code> and <code>sw-acc2</code>.</p> <p>Wireshark Filter:</p> <pre><code>eth.type == 0x8892\n</code></pre> <p>Or: <pre><code>pn_io\n</code></pre></p> <p>Expected Observations:</p> <ol> <li>Ethertype: 0x8892 (PROFINET Real-Time)</li> <li>No TCP/IP Headers: This is Layer 2, not Layer 4</li> <li>FrameID: Typically 0x8000-0x8001 (RT cyclic data)</li> <li>Cyclic Pattern: Packets every ~4ms (very regular)</li> <li>MAC Addresses visible:</li> <li>Source: 00:03:2c:40:00:11 (ABB system)</li> <li>Destination: 00:0b:0f:20:00:11 (PROFINET device)</li> </ol> <p>Timing Analysis:</p> <p>Select multiple consecutive PROFINET packets and check time delta:</p> <p>In Wireshark: - View \u2192 Time Display Format \u2192 Seconds Since Previous Displayed Packet - Expectation: ~0.004 seconds (4ms cycle time)</p> <p>Assessment Results:</p> <ol> <li>Ethertype: 0x8892 (Layer 2 Real-Time)</li> <li>TCP/IP Headers: No - direct Ethernet frame</li> <li>Cycle Time: ~4ms (very deterministic)</li> <li>MAC Addresses: Yes, visible</li> <li>Encryption: No - impossible with real-time</li> <li>Filter for tcp/udp: PROFINET RT does not appear</li> </ol> <p>Security Implications:</p> <ul> <li>No routing possible (Layer 2)</li> <li>No encryption possible</li> <li>Physical access = full control</li> <li>VLAN isolation is critical</li> <li>Port security required</li> <li>Anomaly detection based on timing</li> </ul> <p>PROFINET DCP (Discovery):</p> <p>For PROFINET device discovery: <pre><code>pn_dcp\n</code></pre></p> <p>DCP broadcasts reveal: - Device name - Manufacturer - IP configuration - Role in network</p>"},{"location":"exercises/ex6-protocol-discovery.html#task-7-protocol-comparison","title":"Task 7: Protocol Comparison","text":"<p>Analysis Summary:</p> Protocol Encryption Auth Main Risk Defense Modbus TCP No No Cleartext access Segmentation + Monitoring CODESYS Optional, usually No Optional Engineering access Disable in production OPC UA Yes (often disabled) Yes (often disabled) Misconfiguration Enable security features PROFINET RT Impossible No Layer 2 attacks Physical + VLAN isolation <p>Audit Checklist Completed:</p> <ul> <li>[x] Protocols inventoried (Modbus, OPC UA, PROFINET, HTTP)</li> <li>[x] OPC UA SecurityPolicy checked (None = FAIL)</li> <li>[x] OPC UA Authentication checked (Anonymous = FAIL)</li> <li>[x] Modbus segmentation checked</li> <li>[x] CODESYS ports identified (should be disabled)</li> <li>[x] PROFINET VLAN isolation checked</li> <li>[x] IEC 62443 violations documented</li> </ul> <p>Key Takeaways:</p> <ol> <li>Legacy Protocols (Modbus): No security features \u2192 Compensating controls required</li> <li>Modern Protocols (OPC UA): Security present but often disabled \u2192 Audit and activation required</li> <li>Real-Time Protocols (PROFINET): Encryption impossible \u2192 Architectural security critical</li> <li>All Protocols: Benefit from segmentation, monitoring, and access control</li> </ol> <p>Next Steps:</p> <ol> <li>Enable OPC UA security features (highest priority)</li> <li>Enforce network segmentation (see Exercise 7)</li> <li>Disable CODESYS engineering ports for production</li> <li>Implement IDS/IPS for OT protocol anomalies</li> <li>Conduct regular protocol audits</li> </ol>"},{"location":"exercises/ex7-segmentation-firewall.html","title":"Exercise 7: Network Segmentation and Firewall Design","text":"<p>Time Estimate: 35-45 minutes Lab Topology: <code>ot-sec-segmented</code> (primary), <code>ot-sec-flat</code> (comparison) Difficulty:  Intermediate to Advanced</p>"},{"location":"exercises/ex7-segmentation-firewall.html#learning-objectives","title":"Learning Objectives","text":"<ul> <li>Understand zone-based segmentation (Purdue Model concepts)</li> <li>Create a communication matrix for OT devices</li> <li>Design firewall rules to restrict traffic to necessary protocols</li> <li>Compare security posture of flat vs. segmented networks</li> </ul>"},{"location":"exercises/ex7-segmentation-firewall.html#prerequisites","title":"Prerequisites","text":"<ul> <li>Exercise 1 &amp; 6</li> <li>Basic understanding of firewalls</li> </ul>"},{"location":"exercises/ex7-segmentation-firewall.html#scenario","title":"Scenario","text":"<p>In the <code>ot-sec-flat</code> topology, all devices were in the same broadcast domain. If one device was compromised, the attacker could access everything. In <code>ot-sec-segmented</code>, we have VLANs separating functions: - VLAN 10 (Hygiene): PLCs - VLAN 20 (Process): PLCs - VLAN 40 (Control Room): HMI - VLAN 50 (Engineering): Workstations</p> <p>However, segmentation alone isn't enough if the firewall allows all traffic between zones. We need to implement \"Least Privilege\".</p>"},{"location":"exercises/ex7-segmentation-firewall.html#tasks","title":"Tasks","text":""},{"location":"exercises/ex7-segmentation-firewall.html#task-1-map-communication-flows","title":"Task 1: Map Communication Flows","text":"<ol> <li> <p>Identify the legitimate communication paths needed for the plant to operate:</p> <ul> <li>HMI (VLAN 40) needs to read/write data to PLCs (VLAN 10, 20, 30).</li> <li>Engineering Station (VLAN 50) needs to program PLCs.</li> <li>PLCs usually do not need to talk to the Internet.</li> <li>PLCs might need to talk to each other (inter-controller communication).</li> </ul> </li> <li> <p>Question: Does the HMI need to SSH into the PLC? Does it need to ping it? Does it need to access the web server?</p> <ul> <li>Answer: Typically, HMI only needs Modbus TCP (502) or a proprietary protocol (e.g., 1217/2455 for CODESYS). WebVisu uses HTTP (80/8080).</li> </ul> </li> </ol>"},{"location":"exercises/ex7-segmentation-firewall.html#task-2-create-a-communication-matrix","title":"Task 2: Create a Communication Matrix","text":"<p>A communication matrix defines allowed traffic. Fill in the table below (mentally or on paper):</p> Source Destination Protocol Port Action HMI (10.40.0.12) PLC (10.10.0.11) Modbus TCP 502 Allow HMI (10.40.0.12) PLC (10.10.0.11) HTTP (WebVisu) 8080 Allow HMI (10.40.0.12) PLC (10.10.0.11) SSH 22 Block Any Any Any Any Block"},{"location":"exercises/ex7-segmentation-firewall.html#task-3-analyze-current-firewall-rules","title":"Task 3: Analyze Current Firewall Rules","text":"<ol> <li> <p>SSH into the <code>gw-firewall</code> (Mikrotik):     <pre><code>ssh admin@192.168.100.11\n</code></pre>     (Password: <code>admin</code>)</p> </li> <li> <p>View the current forwarding rules:     <pre><code>/ip firewall filter print where chain=forward\n</code></pre></p> </li> <li> <p>Look for the rule allowing Control Room (VLAN 40) to Hygiene (VLAN 10).</p> <ul> <li>It likely looks like: <code>action=accept chain=forward in-interface=vlan40 out-interface=vlan10</code></li> <li>Analysis: This rule allows all protocols. This is too permissive.</li> </ul> </li> </ol>"},{"location":"exercises/ex7-segmentation-firewall.html#task-4-design-and-implement-restrictive-rules-optionaladvanced","title":"Task 4: Design and Implement Restrictive Rules (Optional/Advanced)","text":"<p>Note: This task requires familiarity with RouterOS syntax. Proceed with caution.</p> <p>We want to replace the broad \"Allow VLAN 40 to VLAN 10\" rule with specific rules for Modbus and HTTP.</p>"},{"location":"exercises/ex7-segmentation-firewall.html#expert-view-complexity-vs-maintainability","title":"Expert View: Complexity vs. Maintainability","text":"<p>Warning: With firewall rule sets, granularity can get very complex very fast. It's tempting to create extremely fine-grained rules (e.g., separate rules for every single device, every port, every protocol variant), but this leads to rule sets with hundreds of entries that nobody understands or can maintain anymore.</p> <p>Common Pitfalls:</p> <ul> <li>Too many specific host-to-host rules instead of zone-based rules</li> <li>Multiple overlapping rules where it's unclear which one applies</li> <li>Missing documentation or outdated comments</li> <li>\"Emergency\" rules that were supposed to be temporary but become permanent</li> <li>Rules that nobody dares to delete because it's unknown what they do</li> </ul> <p>Recommendation: Keep It Simple and Manageable:</p> <ol> <li>Prefer zone-based policies over individual hosts (e.g., \"VLAN 40 to VLAN 10\" instead of \"Host A to Host B\")</li> <li>Group service objects (e.g., \"OT-Base-Services\" = Modbus + OPC-UA + HTTP)</li> <li>Clear naming conventions (e.g., \"ALLOW_ControlRoom_to_Hygiene_OT-Services\")</li> <li>Regular cleanup - Remove unused rules</li> <li>Document - Record business justification in comments</li> <li>Test - Validate in test environment before production</li> </ol> <p>Rule of thumb: If your rule set has more than 50 rules without clear structure, it's time to simplify. A well-designed rule set with 20 understandable rules is safer than a chaotic one with 200 rules.</p> <ol> <li> <p>Add specific rules (placed at the top or before the drop rule):</p> <pre><code># Allow Modbus TCP from HMI to PLC\n/ip firewall filter add chain=forward action=accept src-address=10.40.0.12 dst-address=10.10.0.11 protocol=tcp dst-port=502 comment=\"Allow HMI to PLC Modbus\" place-before=0\n\n# Allow HTTP (WebVisu) from HMI to PLC\n/ip firewall filter add chain=forward action=accept src-address=10.40.0.12 dst-address=10.10.0.11 protocol=tcp dst-port=8080 comment=\"Allow HMI to PLC Web\" place-before=0\n</code></pre> </li> <li> <p>Disable the broad rule:     Find the number of the rule <code>allow Control Room to Hygiene</code> using <code>/ip firewall filter print</code>. Let's assume it is number <code>X</code>.     <pre><code>/ip firewall filter disable X\n</code></pre></p> </li> <li> <p>Verify:</p> <ul> <li>Can you still access the WebVisu from the HMI? (Should be YES)</li> <li>Can you SSH from the HMI to the PLC? (Should be NO, if the default policy is drop or if no other rule matches).</li> <li>Note: The current lab config has a <code>default forward drop</code> rule that is <code>disabled=yes</code>. To fully enforce this, you would need to enable that drop rule at the end.</li> </ul> <pre><code># Enable the default drop rule at the bottom\n/ip firewall filter enable [find comment=\"default forward drop\"]\n</code></pre> </li> </ol>"},{"location":"exercises/ex7-segmentation-firewall.html#task-5-compare-flat-vs-segmented","title":"Task 5: Compare Flat vs. Segmented","text":"<ol> <li> <p>Flat Network:</p> <ul> <li>Attacker on HMI can ARP spoof the PLC.</li> <li>Attacker can access any port on the PLC.</li> <li>No central point to filter traffic.</li> </ul> </li> <li> <p>Segmented Network (with Firewall):</p> <ul> <li>ARP spoofing is contained within the VLAN.</li> <li>Firewall enforces policy (e.g., \"Only Modbus allowed\").</li> <li>Central logging of denied attempts (if logging is enabled).</li> </ul> </li> </ol>"},{"location":"exercises/ex7-segmentation-firewall.html#conclusion","title":"Conclusion","text":"<p>Segmentation is the foundation of OT security, but it must be accompanied by strict firewall rules. By moving from \"Allow Any\" to \"Allow Specific Ports\", we significantly reduce the attack surface.</p>"},{"location":"exercises/ex7-segmentation-firewall.html#solution","title":"Solution","text":"Click to view solution"},{"location":"exercises/ex7-segmentation-firewall.html#task-1-map-communication-flows_1","title":"Task 1: Map Communication Flows","text":"<p>Legitimate Communication Paths:</p> <ol> <li> <p>HMI (VLAN 40) \u2192 PLCs (VLAN 10, 20, 30)</p> <ul> <li>Modbus TCP (Port 502): YES - for process control</li> <li>HTTP/WebVisu (Port 8080): YES - for visualization</li> <li>OPC UA (Port 4840): YES - modern alternative</li> <li>SSH (Port 22): NO - only for engineering, not HMI</li> </ul> </li> <li> <p>Engineering Station (VLAN 50) \u2192 PLCs</p> <ul> <li>CODESYS Runtime (Port 2455, 1217): YES - for programming</li> <li>SSH (Port 22): YES - for maintenance</li> <li>HTTP (Port 8080): YES - for WebVisu access</li> </ul> </li> <li> <p>PLCs \u2192 Internet</p> <ul> <li>NO - PLCs should not have direct Internet access</li> <li>Exception: NTP for time synchronization (controlled via firewall)</li> </ul> </li> <li> <p>PLCs to Each Other</p> <ul> <li>YES - Inter-controller communication possible</li> <li>Protocols: Modbus TCP, OPC UA, proprietary protocols</li> </ul> </li> </ol> <p>Answer to the Question:</p> <ul> <li>Must HMI SSH into PLC? NO - SSH is for engineering/maintenance, not normal HMI functions</li> <li>Must HMI ping PLC? YES - ICMP is useful for availability checks</li> <li>Must HMI access web server? YES - WebVisu runs on HTTP (Port 8080)</li> </ul>"},{"location":"exercises/ex7-segmentation-firewall.html#task-2-create-communication-matrix","title":"Task 2: Create Communication Matrix","text":"<p>Extended Communication Matrix:</p> Source Destination Protocol Port Action Justification HMI (10.40.0.12) PLC (10.10.0.11) Modbus TCP 502 ALLOW Read/write process data HMI (10.40.0.12) PLC (10.10.0.11) HTTP 8080 ALLOW WebVisu access HMI (10.40.0.12) PLC (10.10.0.11) OPC UA 4840 ALLOW Alternative to Modbus HMI (10.40.0.12) PLC (10.10.0.11) ICMP - ALLOW Availability check HMI (10.40.0.12) PLC (10.10.0.11) SSH 22 BLOCK Not needed for HMI operation EWS (10.50.0.11) PLC (10.10.0.11) SSH 22 ALLOW Engineering/maintenance EWS (10.50.0.11) PLC (10.10.0.11) CODESYS 2455, 1217 ALLOW Programming EWS (10.50.0.11) PLC (10.10.0.11) HTTP 8080 ALLOW WebVisu configuration PLC (10.10.0.11) Internet Any Any BLOCK No direct Internet connection Any Any Any Any BLOCK Default-deny policy"},{"location":"exercises/ex7-segmentation-firewall.html#task-3-analyze-current-firewall-rules_1","title":"Task 3: Analyze Current Firewall Rules","text":"<p>SSH to Firewall:</p> <pre><code>ssh admin@192.168.100.11\n</code></pre> <p>Password: <code>admin</code></p> <p>Alternatively with sshpass (for automation): <pre><code>sshpass -p admin ssh admin@192.168.100.11\n</code></pre></p> <p>Display Firewall Rules:</p> <pre><code>/ip firewall filter print where chain=forward\n</code></pre> <p>Expected Output (ot-sec-flat):</p> <pre><code>Flags: X - disabled, I - invalid; D - dynamic \n 0    ;;; allow established,related connections\n      chain=forward action=accept connection-state=established,related \n\n 1    ;;; allow forwarding ICMP\n      chain=forward action=accept protocol=icmp \n\n 2    ;;; allow SSH to the jumphost from internet\n      chain=forward action=accept protocol=tcp dst-address=2.2.2.2 \n      in-interface-list=ext dst-port=22 \n\n 3    ;;; allow all traffic from DMZ to VLAN10\n      chain=forward action=accept in-interface=dmz-ext out-interface=vlan10 \n\n 4    ;;; default forward drop\n      chain=forward action=accept log=yes log-prefix=\"default forward drop\"\n</code></pre> <p>Expected Output (ot-sec-segmented):</p> <pre><code>Flags: X - disabled, I - invalid; D - dynamic \n 0    ;;; allow established,related connections\n      chain=forward action=accept connection-state=established,related\n\n 1    ;;; allow forwarding ICMP\n      chain=forward action=accept protocol=icmp\n\n 2    ;;; allow SSH to the jumphost from internet\n      chain=forward action=accept protocol=tcp dst-address=2.2.2.2\n      in-interface-list=ext dst-port=22\n\n 3    ;;; allow Control Room to Hygiene\n      chain=forward action=accept in-interface=vlan40 out-interface=vlan10\n\n 4    ;;; allow Control Room to Process\n      chain=forward action=accept in-interface=vlan40 out-interface=vlan20\n\n 5    ;;; allow Control Room to Disposal\n      chain=forward action=accept in-interface=vlan40 out-interface=vlan30\n\n 6    ;;; allow Parameterization to Hygiene\n      chain=forward action=accept in-interface=vlan50 out-interface=vlan10\n\n ... more rules ...\n</code></pre> <p>Analysis:</p> <ul> <li>Flat Topology: Rule 3 allows ALL traffic from DMZ to VLAN 10 - too permissive</li> <li>Segmented Topology: Rule 3 allows ALL traffic from VLAN 40 to VLAN 10 - too permissive</li> <li>Problem: No port restrictions, no protocol specification</li> <li>Risk: SSH, unnecessary services are reachable</li> </ul>"},{"location":"exercises/ex7-segmentation-firewall.html#task-4-implement-restrictive-rules","title":"Task 4: Implement Restrictive Rules","text":"<p>WARNING: These changes can break network connectivity. Always perform in production during maintenance window with rollback plan.</p> <p>Step 1: Add Specific Rule for Modbus TCP</p> <pre><code>/ip firewall filter add chain=forward action=accept \\\n    src-address=10.40.0.12 dst-address=10.10.0.11 \\\n    protocol=tcp dst-port=502 \\\n    comment=\"Allow HMI to PLC Modbus\" place-before=0\n</code></pre> <p>Step 2: Add Specific Rule for WebVisu HTTP</p> <pre><code>/ip firewall filter add chain=forward action=accept \\\n    src-address=10.40.0.12 dst-address=10.10.0.11 \\\n    protocol=tcp dst-port=8080 \\\n    comment=\"Allow HMI to PLC WebVisu\" place-before=0\n</code></pre> <p>Step 3: Add Specific Rule for OPC UA</p> <pre><code>/ip firewall filter add chain=forward action=accept \\\n    src-address=10.40.0.12 dst-address=10.10.0.11 \\\n    protocol=tcp dst-port=4840 \\\n    comment=\"Allow HMI to PLC OPC-UA\" place-before=0\n</code></pre> <p>Step 4: Verify Rules</p> <pre><code>/ip firewall filter print where chain=forward\n</code></pre> <p>You should now see the new specific rules at the top.</p> <p>Step 5: Identify Broad \"Allow Any\" Rule</p> <p>Find the rule number of the broad rule:</p> <pre><code>/ip firewall filter print where chain=forward\n</code></pre> <p>In <code>ot-sec-segmented</code>: Look for \"allow Control Room to Hygiene\" (e.g. rule #3) In <code>ot-sec-flat</code>: Look for \"allow all traffic from DMZ to VLAN10\" (e.g. rule #3)</p> <p>Step 6: Disable Broad Rule</p> <pre><code>/ip firewall filter disable [find comment=\"allow Control Room to Hygiene\"]\n</code></pre> <p>Or for flat: <pre><code>/ip firewall filter disable [find comment=\"allow all traffic from DMZ to VLAN10\"]\n</code></pre></p> <p>Step 7: Enable Default-Drop (Optional)</p> <p>In <code>ot-sec-flat</code> the default-drop rule is actually set to \"accept\". For real security:</p> <pre><code>/ip firewall filter set [find comment=\"default forward drop\"] action=drop\n</code></pre> <p>CAUTION: This blocks all traffic not explicitly allowed. Ensure all necessary rules are in place!</p> <p>Step 8: Test</p> <p>From another terminal (not via SSH to firewall!):</p> <pre><code># Test 1: HMI can reach WebVisu (should work)\ndocker exec clab-ot-sec-flat-pilz-hmi01-vlan40 curl -I --connect-timeout 3 http://10.10.0.11:8080\n\n# Test 2: HMI can reach Modbus (should work)\ndocker exec clab-ot-sec-flat-pilz-hmi01-vlan40 nc -zv 10.10.0.11 502\n\n# Test 3: HMI cannot reach SSH (should be blocked if default-drop active)\ndocker exec clab-ot-sec-flat-pilz-hmi01-vlan40 nc -zv -w 2 10.10.0.11 22\n</code></pre> <p>Expected Results:</p> <p>Test 1 &amp; 2: Successful Test 3: Connection timed out or refused (if default-drop active)</p> <p>Rollback (if needed):</p> <pre><code># Re-enable broad rule\n/ip firewall filter enable [find comment=\"allow Control Room to Hygiene\"]\n\n# Set default-drop back to accept\n/ip firewall filter set [find comment=\"default forward drop\"] action=accept\n</code></pre>"},{"location":"exercises/ex7-segmentation-firewall.html#task-5-compare-flat-vs-segmented_1","title":"Task 5: Compare Flat vs. Segmented","text":"<p>Comparison Table:</p> Aspect Flat Network Segmented Network (with Firewall) Broadcast Domain One large domain Multiple small VLANs ARP Spoofing Reach All devices affected Limited to VLAN Lateral Movement Easy - direct access Difficult - firewall blocks Attack Surface All ports on all devices Only allowed ports/protocols Traffic Filtering None Central at firewall Monitoring Distributed, complex Central at firewall Incident Response Hard to isolate Can isolate zones Compliance IEC 62443 SR 5.1 FAIL IEC 62443 SR 5.1 PASS <p>Attack Scenario - Flat Network:</p> <ol> <li>Attacker compromises HMI (10.40.0.12)</li> <li>Performs ARP spoofing \u2192 Man-in-the-Middle on entire network</li> <li>Direct access to PLC via SSH (Port 22)</li> <li>Direct access to all engineering ports</li> <li>Can move laterally to all other devices</li> <li>No central monitoring of traffic</li> </ol> <p>Attack Scenario - Segmented Network:</p> <ol> <li>Attacker compromises HMI (10.40.0.12 in VLAN 40)</li> <li>ARP spoofing only possible in VLAN 40</li> <li>Attempts to access PLC (10.10.0.11 in VLAN 10)</li> <li>Firewall blocks SSH (Port 22) \u2192 Access denied</li> <li>Firewall only allows Modbus, HTTP, OPC UA</li> <li>Firewall logs all access attempts</li> <li>IDS/IPS can detect anomalies</li> <li>Security team alerted</li> <li>VLAN 10 can be isolated without affecting VLAN 40</li> </ol> <p>Conclusion:</p> <ul> <li>Flat Network: Easy to manage but catastrophic when compromised</li> <li>Segmented Network: More complex but significantly more secure and IEC 62443 compliant</li> <li>Best Practice: Segmentation + specific firewall rules + monitoring</li> </ul>"},{"location":"exercises/ex7-segmentation-firewall.html#additional-best-practices","title":"Additional Best Practices","text":"<p>1. Enable Logging:</p> <pre><code>/ip firewall filter set [find comment=\"default forward drop\"] log=yes log-prefix=\"fw-drop\"\n</code></pre> <p>2. Address Lists for Better Management:</p> <pre><code># Define HMI devices\n/ip firewall address-list add list=hmi-devices address=10.40.0.12\n/ip firewall address-list add list=hmi-devices address=10.40.0.13\n\n# Define PLC devices\n/ip firewall address-list add list=plc-devices address=10.10.0.11\n/ip firewall address-list add list=plc-devices address=10.10.0.12\n/ip firewall address-list add list=plc-devices address=10.20.0.11\n\n# Rule with Address Lists\n/ip firewall filter add chain=forward action=accept \\\n    src-address-list=hmi-devices dst-address-list=plc-devices \\\n    protocol=tcp dst-port=502 \\\n    comment=\"Allow HMI to PLCs Modbus\"\n</code></pre> <p>3. Regular Audits:</p> <pre><code># Show all rules with counters\n/ip firewall filter print stats\n\n# Identify unused rules (bytes=0)\n/ip firewall filter print stats where bytes=0\n</code></pre> <p>4. Change Management:</p> <ul> <li>Document all firewall changes</li> <li>Create backup before changes:   <pre><code>/system backup save name=before-firewall-change\n</code></pre></li> <li>Validate in test environment</li> <li>Roll out incrementally in production</li> </ul>"},{"location":"exercises/ex7-segmentation-firewall.html#summary-lessons-learned","title":"Summary: Lessons Learned","text":"<ol> <li>Segmentation alone is not enough - Firewall rules are essential</li> <li>Default-deny is critical - \"Allow any\" makes segmentation worthless</li> <li>Enforce least privilege - Only allow absolutely necessary ports</li> <li>Monitoring is mandatory - Enable logging and alerting</li> <li>Documentation is crucial - Know why each rule exists</li> <li>Test, test, test - Validate before production deployment</li> <li>IEC 62443 SR 5.1 - Network segmentation is fundamental requirement</li> </ol>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html","title":"Security Analysis: OT Network Segmented Topology","text":"<p>Analysis Date: November 12, 2025 Topology: ot-sec-segmented.clab.yml Analyst: Security Assessment</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#executive-summary","title":"Executive Summary","text":"<p>This document provides a comprehensive security analysis of the segmented OT network architecture. The analysis evaluates the network against industry best practices including IEC 62443, NIST SP 800-82, and the Purdue Model for industrial networks.</p> <p>Overall Security Posture: MODERATE with CRITICAL VULNERABILITIES</p> <p>While the segmented architecture demonstrates several security improvements over flat networks, multiple critical and high-severity issues were identified that significantly compromise the security posture.</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#network-architecture-overview","title":"Network Architecture Overview","text":""},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#security-zones","title":"Security Zones","text":"<p>The network implements the following security zones:</p> <ul> <li>Internet Zone (1.1.1.0/24): External connectivity</li> <li>DMZ Zone (2.2.2.0/24, VLAN 60): Jumphost and external access</li> <li>VLAN 10 - Hygiene (10.10.0.0/24): Cleaning/hygiene processes</li> <li>VLAN 20 - Process (10.20.0.0/24): Main production processes</li> <li>VLAN 30 - Disposal (10.30.0.0/24): Waste disposal systems</li> <li>VLAN 40 - Control Room (10.40.0.0/24): HMI and SCADA systems</li> <li>VLAN 50 - Parameterization (10.50.0.0/24): Engineering workstations</li> </ul>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#network-devices","title":"Network Devices","text":"<ul> <li>gw-firewall (192.168.100.11): MikroTik RouterOS 7.18 - Gateway/Firewall</li> <li>sw-dist (192.168.100.12): MikroTik RouterOS 7.18 - Distribution Switch</li> <li>sw-acc1 (192.168.100.13): MikroTik RouterOS 7.18 - Access Switch 1</li> <li>sw-acc2 (192.168.100.14): MikroTik RouterOS 7.18 - Access Switch 2</li> </ul>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#critical-vulnerabilities","title":"Critical Vulnerabilities","text":""},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#1-firewall-bypass-default-allow-rule-critical","title":"1. FIREWALL BYPASS - DEFAULT ALLOW RULE (CRITICAL)","text":"<p>Location: <code>gw-firewall</code> line 81 <pre><code>/ip firewall filter add action=accept chain=forward comment=\"allow any for testing\" disabled=no\n</code></pre></p> <p>Risk Level: CRITICAL</p> <p>Impact: - This rule bypasses ALL firewall segmentation controls - Effectively creates a flat network despite VLAN segmentation - Negates the entire security architecture - Allows lateral movement between all zones - Permits unrestricted access from Control Room to Process zones - Enables direct access from DMZ to all internal zones</p> <p>Best Practice Violation: - IEC 62443-3-3: Zone and conduit security enforcement - NIST SP 800-82: Principle of least privilege - Defense-in-depth strategy completely compromised</p> <p>Recommendation: - IMMEDIATELY REMOVE this rule in production environments - Implement explicit deny-by-default policy - Add specific allow rules only for documented business requirements - Log all denied traffic for security monitoring</p> <p>Fix: <pre><code>/ip firewall filter remove [find comment=\"allow any for testing\"]\n# Ensure default drop rule is enabled\n/ip firewall filter set [find comment=\"default forward drop\"] disabled=no\n</code></pre></p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#2-weak-authentication-credentials-critical","title":"2. WEAK AUTHENTICATION CREDENTIALS (CRITICAL)","text":"<p>Location: All network devices and endpoints</p> <p>Current Configuration: <pre><code>Username: admin\nPassword: admin\n</code></pre></p> <p>Risk Level: CRITICAL</p> <p>Impact: - Trivial credential guessing attack - No defense against brute force - Enables unauthorized device access - Permits configuration tampering - Allows malware deployment to PLCs - Facilitates industrial espionage</p> <p>Best Practice Violation: - IEC 62443-3-3 SR 1.1: Human user identification and authentication - IEC 62443-3-3 SR 1.5: Authenticator management - NIST SP 800-53 IA-5: Authenticator management</p> <p>Recommendation: - Implement strong, unique passwords per device (minimum 16 characters) - Use centralized authentication (RADIUS/TACACS+) - Implement multi-factor authentication for critical systems - Enforce password complexity policies - Implement account lockout after failed attempts - Regular password rotation schedule</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#3-default-drop-rule-disabled-critical","title":"3. DEFAULT DROP RULE DISABLED (CRITICAL)","text":"<p>Location: <code>gw-firewall</code> line 83 <pre><code>/ip firewall filter add action=drop chain=forward comment=\"default forward drop\" disabled=yes\n</code></pre></p> <p>Risk Level: CRITICAL</p> <p>Impact: - No default-deny security posture - Unintended traffic may be permitted - Security policy violations may go undetected - Difficult to audit and verify security controls</p> <p>Best Practice Violation: - Fundamental security principle: Default deny - IEC 62443-3-3: Explicit security policies required</p> <p>Recommendation: <pre><code>/ip firewall filter set [find comment=\"default forward drop\"] disabled=no\n</code></pre></p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#high-severity-issues","title":"High-Severity Issues","text":""},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#4-overly-permissive-zone-to-zone-access-high","title":"4. OVERLY PERMISSIVE ZONE-TO-ZONE ACCESS (HIGH)","text":"<p>Location: <code>gw-firewall</code> firewall rules</p> <p>Current Configuration: <pre><code># DMZ can access Process and Control Room\nallow DMZ to Process (line 73)\nallow DMZ to Control Room (line 74)\n\n# Control Room can access all production zones\nallow Control Room to Hygiene (line 75)\nallow Control Room to Process (line 76)\nallow Control Room to Disposal (line 77)\n\n# Parameterization can access all zones\nallow Parameterization to all zones (lines 78-81)\n</code></pre></p> <p>Risk Level: HIGH</p> <p>Impact: - Violates Purdue Model separation of levels - Excessive lateral movement opportunities - Single compromised workstation can pivot to all zones - DMZ compromise leads to production access - Control Room compromise affects all processes</p> <p>Best Practice Violation: - IEC 62443-3-3: Minimize attack surface - Purdue Model: Strict level separation - NIST SP 800-82: Defense-in-depth</p> <p>Recommendation: - Implement granular, protocol-specific rules - Use application-layer filtering (deep packet inspection) - Restrict DMZ access to specific services only (e.g., SSH to jumphost) - Control Room should read-only access to production, not bidirectional - Parameterization should use time-limited access windows - Implement network access control (NAC)</p> <p>Example Improved Rules: <pre><code># DMZ to specific service only\n/ip firewall filter add action=accept chain=forward \\\n  in-interface=dmz-ext out-interface=vlan20 \\\n  protocol=tcp dst-port=502 src-address=2.2.2.2 \\\n  comment=\"DMZ: Jumphost Modbus to Process\"\n\n# Control Room read-only monitoring\n/ip firewall filter add action=accept chain=forward \\\n  in-interface=vlan40 out-interface=vlan20 \\\n  protocol=tcp dst-port=502 connection-state=new \\\n  comment=\"Control Room: Read-only Modbus to Process\"\n</code></pre></p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#5-no-protocol-filtering-or-dpi-high","title":"5. NO PROTOCOL FILTERING OR DPI (HIGH)","text":"<p>Location: All firewall rules</p> <p>Current Configuration: - Rules permit entire interface-to-interface traffic - No port-specific restrictions - No protocol validation - No application-layer inspection</p> <p>Risk Level: HIGH</p> <p>Impact: - Malicious traffic can use any protocol - No detection of protocol violations - Tunneling and encapsulation attacks possible - Cannot enforce industrial protocol security</p> <p>Best Practice Violation: - IEC 62443-3-3 SR 3.1: Communication integrity - NIST SP 800-82: Protocol validation</p> <p>Recommendation: - Implement port-specific rules for industrial protocols:   - Modbus TCP: 502   - EtherNet/IP: 44818, 2222   - OPC UA: 4840   - S7comm: 102   - BACnet: 47808 - Deploy industrial protocol firewall or DPI - Use protocol anomaly detection - Implement payload inspection where possible</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#6-unrestricted-icmp-high","title":"6. UNRESTRICTED ICMP (HIGH)","text":"<p>Location: <code>gw-firewall</code> lines 69-70 <pre><code>/ip firewall filter add action=accept chain=input comment=\"allow ICMP to the device\" protocol=icmp\n/ip firewall filter add action=accept chain=forward comment=\"allow forwarding ICMP\" protocol=icmp\n</code></pre></p> <p>Risk Level: HIGH</p> <p>Impact: - Network reconnaissance trivially easy - Zone mapping via ping sweeps - Enables covert channels - Facilitates DDoS amplification - Timing-based side-channel attacks</p> <p>Best Practice Violation: - IEC 62443-3-3 SR 7.6: Network and security configuration settings - Defense-in-depth: Minimize information disclosure</p> <p>Recommendation: - Rate-limit ICMP (max 5 packets/second) - Restrict ICMP types (allow only echo-request/reply, TTL-exceeded) - Block ICMP from external interfaces - Log excessive ICMP for anomaly detection</p> <p>Example Configuration: <pre><code>/ip firewall filter add action=accept chain=input \\\n  protocol=icmp icmp-options=8:0 limit=5,10:packet \\\n  comment=\"Rate-limited ping to device\"\n</code></pre></p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#7-no-network-access-control-nac-high","title":"7. NO NETWORK ACCESS CONTROL (NAC) (HIGH)","text":"<p>Location: Access switches sw-acc1 and sw-acc2</p> <p>Current Configuration: - BPDU guard enabled on edge ports (good) - Edge ports configured correctly (good) - No MAC authentication - No 802.1X authentication - No dynamic VLAN assignment</p> <p>Risk Level: HIGH</p> <p>Impact: - Rogue devices can connect to any VLAN - No device authentication before network access - Compromised devices can impersonate PLCs - Physical security bypass trivial</p> <p>Best Practice Violation: - IEC 62443-3-3 SR 1.7: Strength of password-based authentication - IEC 62443-3-3 SR 1.1: Unique identification and authentication - NIST SP 800-82: Network access control</p> <p>Recommendation: - Implement 802.1X authentication on all access ports - Use MAC authentication bypass (MAB) for devices without 802.1X - Deploy dynamic VLAN assignment based on device identity - Implement port security (MAC address limits) - Use guest VLAN for unknown devices - Monitor and alert on new MAC addresses</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#medium-severity-issues","title":"Medium-Severity Issues","text":""},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#8-dhcp-security-weaknesses-medium","title":"8. DHCP SECURITY WEAKNESSES (MEDIUM)","text":"<p>Location: <code>gw-firewall</code> DHCP configuration</p> <p>Current Configuration: - DHCP enabled on VLAN 10 only - Static IP reservations not visible - No DHCP snooping - No IP-MAC binding enforcement</p> <p>Risk Level: MEDIUM</p> <p>Impact: - DHCP spoofing possible - Rogue DHCP server attacks - IP address conflicts - ARP spoofing easier to execute - Man-in-the-middle attacks facilitated</p> <p>Best Practice Violation: - IEC 62443-3-3 SR 3.1: Communication integrity - NIST SP 800-82: Secure network protocols</p> <p>Recommendation: - Implement DHCP snooping on all switches - Configure trusted DHCP server ports only - Build DHCP binding database - Enable dynamic ARP inspection (DAI) - Use static IP assignments for critical assets (PLCs, HMI) - Implement IP Source Guard</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#9-no-network-segmentation-at-layer-2-medium","title":"9. NO NETWORK SEGMENTATION AT LAYER 2 (MEDIUM)","text":"<p>Location: sw-dist, sw-acc1, sw-acc2</p> <p>Current Configuration: - VLANs configured (good) - Proper VLAN tagging (good) - All VLANs visible on all trunk ports - No private VLANs - No VLAN pruning</p> <p>Risk Level: MEDIUM</p> <p>Impact: - VLAN hopping possible via double-tagging - Unnecessary broadcast domains - Higher attack surface - Lateral movement via layer 2</p> <p>Best Practice Violation: - Defense-in-depth principle - VLAN security best practices</p> <p>Recommendation: - Implement VLAN pruning (only allow needed VLANs on trunks) - Use native VLAN 99 (good practice already in place) - Disable DTP (Dynamic Trunking Protocol) - Consider Private VLANs for further isolation - Implement Q-in-Q for additional segmentation</p> <p>Example Configuration: <pre><code># Only allow necessary VLANs on each trunk\n/interface bridge vlan\n  # sw-dist to sw-acc1: Only VLANs 10,20,30,40,50\n  set [find comment=Parameterization] tagged=ether12,ether10 untagged=\"\"\n</code></pre></p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#10-weak-dns-security-medium","title":"10. WEAK DNS SECURITY (MEDIUM)","text":"<p>Location: <code>gw-firewall</code> DNS configuration</p> <p>Current Configuration: <pre><code>/ip dns set allow-remote-requests=yes\n</code></pre> - Static DNS entries configured - No DNSSEC validation - DNS open to all clients - No DNS filtering or threat intelligence</p> <p>Risk Level: MEDIUM</p> <p>Impact: - DNS cache poisoning possible - DNS hijacking attacks - No protection against malicious domains - Malware C2 via DNS tunneling - Data exfiltration via DNS</p> <p>Best Practice Violation: - NIST SP 800-81: Secure Domain Name System (DNS) Deployment Guide - IEC 62443-3-3 SR 3.1: Communication integrity</p> <p>Recommendation: - Implement DNS filtering (block malicious domains) - Enable DNSSEC validation - Use DNS RPZ (Response Policy Zones) - Restrict DNS to specific sources - Log DNS queries for anomaly detection - Use threat intelligence feeds - Consider DNS over HTTPS/TLS for external queries</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#11-no-time-synchronization-security-medium","title":"11. NO TIME SYNCHRONIZATION SECURITY (MEDIUM)","text":"<p>Location: <code>gw-firewall</code> NTP configuration</p> <p>Current Configuration: <pre><code>/system ntp server set enabled=yes\n</code></pre> - NTP server enabled - No authentication - No source restrictions - Accepts requests from anywhere</p> <p>Risk Level: MEDIUM</p> <p>Impact: - NTP amplification DDoS attacks - Time manipulation attacks - Log correlation issues - Certificate validation failures - Cryptographic key generation weaknesses</p> <p>Best Practice Violation: - NIST SP 1800-15: Securing Small-Business and Home IoT Devices - IEC 62443-3-3 SR 3.9: Protection of audit information</p> <p>Recommendation: - Implement NTP authentication (symmetric keys or Autokey) - Restrict NTP clients to known sources - Use NTP client mode only for firewall (don't serve time to internet) - Deploy dedicated NTP server in management network - Monitor for NTP anomalies</p> <p>Example Configuration: <pre><code># Restrict NTP to local networks only\n/ip firewall filter add action=accept chain=input \\\n  dst-port=123 protocol=udp \\\n  src-address-list=local-networks \\\n  comment=\"NTP from local only\"\n</code></pre></p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#12-management-interface-exposure-medium","title":"12. MANAGEMENT INTERFACE EXPOSURE (MEDIUM)","text":"<p>Location: <code>gw-firewall</code> input chain rules</p> <p>Current Configuration: <pre><code>/ip firewall filter add action=accept chain=input \\\n  comment=\"allow access from MGMT networks\" \\\n  src-address-list=mgmt\n</code></pre> - Entire RFC1918 space in mgmt list (10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16) - HTTP access allowed from jumphost - SSH access overly permissive</p> <p>Risk Level: MEDIUM</p> <p>Impact: - Lateral movement from compromised endpoints - Management interface attacks from production networks - Unnecessary attack surface</p> <p>Best Practice Violation: - IEC 62443-3-3 SR 1.3: Account management - Least privilege principle</p> <p>Recommendation: - Restrict management access to dedicated management VLAN only - Use jump server for all management access - Implement bastion host architecture - Disable unnecessary services (HTTP, Telnet) - Use SSH with key-based authentication only - Implement IP whitelisting for management - Two-factor authentication for critical devices</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#13-insufficient-logging-and-monitoring-medium","title":"13. INSUFFICIENT LOGGING AND MONITORING (MEDIUM)","text":"<p>Location: <code>gw-firewall</code> and all switches</p> <p>Current Configuration: - Remote syslog configured (good) - Default drop rules log (good when enabled) - No detailed traffic logging - No flow monitoring (NetFlow/IPFIX) - No IDS/IPS integration</p> <p>Risk Level: MEDIUM</p> <p>Impact: - Security incidents may go undetected - Difficult incident response and forensics - No baseline for anomaly detection - Cannot prove compliance</p> <p>Best Practice Violation: - IEC 62443-3-3 SR 3.3: Security audit - IEC 62443-2-1: Audit and accountability - NIST SP 800-82: Security event logging</p> <p>Recommendation: - Enable comprehensive logging:   - All firewall denies   - Authentication events   - Configuration changes   - Interface state changes - Deploy SIEM for log aggregation and correlation - Implement NetFlow/IPFIX for traffic analysis - Deploy IDS/IPS (Suricata/Snort with OT rulesets) - Regular log review and retention policy - Alert on critical events</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#14-no-network-redundancy-medium","title":"14. NO NETWORK REDUNDANCY (MEDIUM)","text":"<p>Location: Network topology</p> <p>Current Configuration: - Single uplink from sw-dist to gw-firewall - No bonding or link aggregation (despite \"bond\" comments) - Single point of failure at multiple levels - No spanning-tree configured for redundancy</p> <p>Risk Level: MEDIUM (Availability)</p> <p>Impact: - Single link failure causes zone isolation - Gateway failure causes complete outage - No high availability - Extended downtime in case of failure</p> <p>Best Practice Violation: - IEC 62443-3-3 SR 7.2: Resource management - High availability requirements for industrial systems</p> <p>Recommendation: - Implement link aggregation (LACP) between devices - Deploy redundant firewalls (VRRP/HSRP) - Configure spanning-tree (RSTP/MSTP) - Use ring topology for switches where possible - Implement redundant power supplies - Plan for firmware update redundancy</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#low-severity-issues","title":"Low-Severity Issues","text":""},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#15-unnecessary-services-enabled-low","title":"15. UNNECESSARY SERVICES ENABLED (LOW)","text":"<p>Location: All devices</p> <p>Services Observed: - HTTP enabled on firewall - DNS server on firewall - DHCP server on firewall - NTP server on firewall</p> <p>Risk Level: LOW</p> <p>Impact: - Increased attack surface - Additional vulnerability points - Resource consumption</p> <p>Recommendation: - Disable HTTP, use HTTPS only (or CLI only) - Deploy dedicated DNS server - Deploy dedicated DHCP server - Use NTP client mode only</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#16-mtu-configuration-low","title":"16. MTU CONFIGURATION (LOW)","text":"<p>Location: All links</p> <p>Current Configuration: - MTU 1500 on all links - VLAN interfaces MTU 1500</p> <p>Risk Level: LOW</p> <p>Impact: - Potential fragmentation issues - Suboptimal performance for jumbo frames - No impact on security</p> <p>Recommendation: - Consider MTU 9000 for internal OT networks (if devices support) - Ensure consistent MTU across paths - Not a security issue, but operational consideration</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#missing-security-controls","title":"Missing Security Controls","text":""},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#17-no-intrusion-detection-system-critical-missing","title":"17. NO INTRUSION DETECTION SYSTEM (CRITICAL MISSING)","text":"<p>Required: IDS/IPS with industrial protocol awareness</p> <p>Recommendation: - Deploy Suricata or Snort with ET-Open + OT-specific rulesets - Monitor for:   - Modbus function code anomalies   - Unauthorized PLC programming   - S7 PUT/GET commands   - OPC UA certificate violations - Place sensors at zone boundaries - Use span/mirror ports on switches for visibility</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#18-no-asset-inventory-and-management-high-missing","title":"18. NO ASSET INVENTORY AND MANAGEMENT (HIGH MISSING)","text":"<p>Required: Automated asset discovery and tracking</p> <p>Recommendation: - Deploy industrial asset management solution - Maintain device inventory with:   - Device type and manufacturer   - Firmware versions   - Network location   - Device function   - Security criticality rating - Automated vulnerability scanning (passive) - Configuration baseline monitoring</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#19-no-industrial-protocol-gateway-high-missing","title":"19. NO INDUSTRIAL PROTOCOL GATEWAY (HIGH MISSING)","text":"<p>Required: Protocol break for IT/OT boundary</p> <p>Recommendation: - Deploy industrial DMZ with protocol gateway - Break protocols at zone boundaries - Implement data diodes for one-way traffic - Use industrial firewall with DPI - Consider Claroty, Nozomi, or open-source alternatives</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#20-no-backup-and-recovery-procedures-medium-missing","title":"20. NO BACKUP AND RECOVERY PROCEDURES (MEDIUM MISSING)","text":"<p>Required: Configuration backups and disaster recovery</p> <p>Recommendation: - Automated daily configuration backups - Version control for network configurations - PLC program backups - Documented recovery procedures - Regular restoration testing - Offline backup storage</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#compliance-mapping","title":"Compliance Mapping","text":""},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#iec-62443-3-3-security-levels","title":"IEC 62443-3-3 Security Levels","text":"<p>Current Assessment: Security Level 1 (SL1) - Protection against casual or coincidental violation</p> <p>Target: Security Level 2 (SL2) - Protection against intentional violation using simple means</p> <p>Gap Analysis:</p> Requirement Current Status Gap SR 1.1 Human user identification Weak credentials HIGH SR 1.3 Account management No centralized auth MEDIUM SR 1.7 Password authentication Default passwords CRITICAL SR 2.1 Authorization enforcement Firewall bypassed CRITICAL SR 3.1 Communication integrity No protocol validation HIGH SR 3.3 Security audit Limited logging MEDIUM SR 5.1 Network segmentation VLANs present but bypassed CRITICAL SR 7.6 Network/security config Insecure defaults HIGH"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#nist-sp-800-82-recommendations","title":"NIST SP 800-82 Recommendations","text":"Recommendation Implementation Status Priority Network segmentation Partial - bypassed by firewall rule CRITICAL Access control Weak - default credentials CRITICAL Security monitoring Basic - needs enhancement HIGH Incident response Not addressed MEDIUM Defense-in-depth Partial implementation HIGH Secure protocols Not enforced HIGH"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#recommendations-summary","title":"Recommendations Summary","text":""},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#immediate-actions-critical-priority","title":"Immediate Actions (Critical Priority)","text":"<ol> <li>REMOVE \"allow any for testing\" firewall rule</li> <li>ENABLE default-drop firewall rule</li> <li>CHANGE all default passwords to strong, unique credentials</li> <li>IMPLEMENT explicit zone-to-zone rules with port restrictions</li> <li>DEPLOY IDS/IPS at zone boundaries</li> </ol>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#short-term-actions-30-days","title":"Short-Term Actions (30 days)","text":"<ol> <li>Implement 802.1X or MAC authentication on access ports</li> <li>Deploy centralized authentication (RADIUS)</li> <li>Configure protocol-specific firewall rules</li> <li>Implement DHCP snooping and dynamic ARP inspection</li> <li>Enable comprehensive logging and SIEM integration</li> <li>Deploy asset inventory system</li> <li>Rate-limit ICMP and restrict to essential types</li> <li>Implement DNS security measures</li> </ol>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#medium-term-actions-90-days","title":"Medium-Term Actions (90 days)","text":"<ol> <li>Deploy industrial protocol gateway at IT/OT boundary</li> <li>Implement redundancy (LACP, VRRP, spanning-tree)</li> <li>Establish configuration management and backup procedures</li> <li>Implement network access control (NAC)</li> <li>Deploy threat intelligence integration</li> <li>Conduct vulnerability assessment of OT devices</li> <li>Develop incident response procedures</li> </ol>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#long-term-actions-6-12-months","title":"Long-Term Actions (6-12 months)","text":"<ol> <li>Achieve IEC 62443-3-3 Security Level 2 compliance</li> <li>Implement security monitoring and SOC integration</li> <li>Deploy data diodes for critical unidirectional flows</li> <li>Implement multi-factor authentication</li> <li>Establish security awareness training program</li> <li>Regular penetration testing</li> <li>Continuous improvement process</li> </ol>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#conclusion","title":"Conclusion","text":"<p>The segmented network architecture demonstrates good foundational design with proper VLAN segmentation and zone definition. However, the critical \"allow any\" firewall rule completely negates the security benefits of this architecture, effectively creating a flat network.</p> <p>Key Findings:</p> <ul> <li>Architecture: Good (defense-in-depth design with zones)</li> <li>Implementation: Poor (security controls bypassed or disabled)</li> <li>Overall Risk: HIGH (critical vulnerabilities present)</li> </ul> <p>Priority Actions:</p> <ol> <li>Remove firewall bypass rule</li> <li>Enable default-drop policy</li> <li>Change all default passwords</li> <li>Implement granular access controls</li> <li>Deploy monitoring and detection capabilities</li> </ol> <p>Once these critical issues are addressed, the network will provide a solid foundation for industrial security. The current state leaves the network highly vulnerable to both external attacks and insider threats.</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#references","title":"References","text":"<ul> <li>IEC 62443-3-3: Industrial communication networks - Network and system security - Part 3-3: System security requirements and security levels</li> <li>NIST SP 800-82 Rev. 3: Guide to Operational Technology (OT) Security</li> <li>NIST SP 800-53 Rev. 5: Security and Privacy Controls for Information Systems and Organizations</li> <li>Purdue Enterprise Reference Architecture (PERA)</li> <li>ISA/IEC 62443 Standards Series</li> <li>SANS Industrial Control Systems Security Best Practices</li> </ul>"}]}