var __index = {"config":{"lang":["de"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"index.html","title":"OT-Netzwerke verstehen &amp; den OT-Netzwerkdschungel lichten","text":"<p>Workshop</p> <p>Dozenten:</p> <ul> <li>Martin Scheu - OT Security Engineer, SWITCH</li> <li>Mischa Diehm - CTO und Network Engineer, Narrowin</li> </ul>"},{"location":"index.html#uberblick","title":"\u00dcberblick","text":""},{"location":"index.html#zugang-zu-den-labs-und-schulungsangebote","title":"Zugang zu den Labs und Schulungsangebote","text":"<p>Die Labs sind leider nicht \u00f6ffentlich verf\u00fcgbar. Falls Sie Interesse am Zugang zu den Labs haben, nehmen Sie bitte Kontakt mit uns auf.</p> <p>Ein digitaler Zwilling des Labs ist frei zugreifbar unter: Narrowin OT-Lab</p> <p>Wir bieten dieses Lab auch als zweit\u00e4gige Vor-Ort-Schulung an. F\u00fcr weitere Details besuchen Sie bitte https://www.narrowin.ch/de/courses.html. Derzeit wird die Schulung vor Ort durchgef\u00fchrt, wir evaluieren jedoch auch virtuelle Schulungsoptionen. Bei Interesse senden Sie uns bitte eine kurze E-Mail.</p>"},{"location":"index.html#uber-diesen-workshop","title":"\u00dcber diesen Workshop","text":"<p>Operational-Technology-Netzwerke (OT) unterscheiden sich grundlegend von IT-Netzwerken. Sie verbinden industrielle Steuerungssysteme, SPSen, HMIs und Feldger\u00e4te f\u00fcr kritische Infrastrukturen und Fertigungsprozesse. Viele Organisationen haben Schwierigkeiten, Transparenz \u00fcber diese Umgebungen zu gewinnen, was sie anf\u00e4llig f\u00fcr Sicherheitsbedrohungen macht und Compliance-L\u00fccken hinterl\u00e4sst.</p> <p>Dieser Workshop vermittelt, wie Sie OT-Netzwerke mit praktischen Open-Source-Tools verstehen und absichern. Sie lernen, OT-Protokolle zu bew\u00e4ltigen, Ger\u00e4te und Datenfl\u00fcsse zu identifizieren, blinde Flecken aufzudecken und effektive Netzwerk-Sicherheits\u00fcberwachung f\u00fcr industrielle Umgebungen zu implementieren.</p> <p>Der Workshop fokussiert auf pragmatische L\u00f6sungen, die sofort in realen OT-Umgebungen einsetzbar sind.</p>"},{"location":"index.html#was-macht-ot-anders","title":"Was macht OT anders?","text":"<p>OT-Netzwerke stellen einzigartige Herausforderungen dar:</p> <ul> <li>Veraltete Protokolle ohne Sicherheitskonzept (Modbus, S7, CIP, BACnet)</li> <li>Lange Lebenszyklen, Ger\u00e4te k\u00f6nnen nicht einfach gepatcht oder ersetzt werden</li> <li>Echtzeitanforderungen, Verf\u00fcgbarkeit hat Vorrang vor Vertraulichkeit</li> <li>Eingeschr\u00e4nkte Netzwerktransparenz durch flache Architekturen und unverwaltete Switches</li> <li>Heterogene Umgebungen mit mehreren Herstellern und Protokollen</li> <li>IT/OT-Konvergenz schafft neue Angriffsfl\u00e4chen</li> </ul> <p>Das Verst\u00e4ndnis dieser Unterschiede ist entscheidend f\u00fcr effektive Netzwerksegmentierung und Sicherheits\u00fcberwachung.</p>"},{"location":"index.html#lernziele","title":"Lernziele","text":"<p>Am Ende dieses Workshops werden Sie in der Lage sein:</p> <ul> <li>G\u00e4ngige OT-Protokolle und ihre Sicherheitsimplikationen zu identifizieren und zu charakterisieren</li> <li>\u00dcberwachungspunkte basierend auf Risikobewertung und Netzwerkarchitektur auszuw\u00e4hlen</li> <li>Traffic-Erfassung und -Weiterleitung f\u00fcr zonen\u00fcbergreifende Transparenz zu konfigurieren</li> <li>Assets zu entdecken und Kommunikationsmuster in OT-Netzwerken abzubilden</li> <li>Die Grenzen verschiedener Ans\u00e4tze zur Netzwerk-Sicherheits\u00fcberwachung in industriellen Umgebungen zu erkennen</li> <li>Segmentierungstechniken an IT/OT-Grenzen und Edge-Ger\u00e4ten anzuwenden</li> </ul>"},{"location":"index.html#kursanforderungen","title":"Kursanforderungen","text":"<p>Niveau: Fortgeschritten, praxisorientierter Workshop</p> <p>Was Sie wissen sollten:</p> <ul> <li>Netzwerkgrundlagen (IP-Adressierung, VLANs, grundlegendes Routing)</li> <li>Kommandozeilen-Grundkenntnisse (ssh, ping, grundlegende Dateioperationen)</li> <li>Container-Konzepte hilfreich, aber nicht erforderlich (wir erkl\u00e4ren, was Sie brauchen)</li> </ul> <p>Laborumgebung:</p> <p>Das Labor l\u00e4uft in vorkonfigurierten Cloud- oder lokalen Umgebungen. Siehe die Laboranleitung f\u00fcr Setup-Anweisungen.</p>"},{"location":"index.html#vorbereitung-vor-dem-workshop","title":"Vorbereitung vor dem Workshop","text":"<p>Keine Softwareinstallation erforderlich. Das Labor l\u00e4uft in der Cloud \u00fcber GitHub Codespaces oder lokal \u00fcber DevPod.</p> <p>Vor dem Workshop:</p> <ol> <li>GitHub-Konto erstellen</li> <li>Laboranleitung f\u00fcr Setup-Optionen lesen</li> <li>Wichtig: Codespace vor dem Workshop starten. Der erste Start dauert 5-10 Minuten f\u00fcr Download und Konfiguration der Container-Images. Nachfolgende Starts dauern unter 1 Minute.</li> <li>Optional: Grundkenntnisse in Linux-Kommandozeile und Netzwerkkonzepten auffrischen</li> </ol>"},{"location":"index.html#was-sie-mitnehmen-werden","title":"Was Sie mitnehmen werden","text":"<ul> <li>Praktische Erfahrung mit Open-Source-OT-Laborumgebungen</li> <li>Praxiswissen zur OT-Protokollanalyse</li> <li>Erkennungs-Use-Cases, die auf Ihre Umgebung anwendbar sind</li> <li>Praktische Laborumgebung, die Sie nach dem Workshop weiterverwenden k\u00f6nnen</li> <li>Netzwerk mit Kollegen, die \u00e4hnliche OT-Security-Herausforderungen haben</li> </ul>"},{"location":"index.html#fragen","title":"Fragen?","text":"<p>Bei technischen Fragen oder besonderen Anforderungen kontaktieren Sie die Referenten:</p> <ul> <li>Martin Scheu: martin.scheu@switch.ch</li> <li>Mischa Diehm: mischa.diehm@narrowin.com</li> </ul>"},{"location":"Container101.html","title":"Container101","text":""},{"location":"Container101.html#warum-diese-seite-existiert","title":"Warum diese Seite existiert","text":"<p>Sie sind ein OT-Fachmann und arbeiten mit SPSen, HMIs, Industrienetzwerken und Protokollen wie Modbus oder PROFINET. Vielleicht haben Sie von Docker und Containern geh\u00f6rt, aber sie nie wirklich gebraucht. Jetzt verwenden wir f\u00fcr diesen Workshop Containerlab, das auf Container-Technologie basiert.</p> <p>Diese Seite erkl\u00e4rt, was Container sind, warum sie perfekt f\u00fcr unseren OT-Sicherheits- und Netzwerk-Workshop sind, und warum es nichts zu bef\u00fcrchten gibt.</p>"},{"location":"Container101.html#die-einfache-wahrheit-uber-container","title":"Die einfache Wahrheit \u00fcber Container","text":"<p>Container sind eine M\u00f6glichkeit, Software zu verpacken und auszuf\u00fchren, die es leicht macht, dieselbe Einrichtung jedes Mal zu starten, zu stoppen und zu wiederholen.</p> <p>Das ist alles. Keine Magie. Keine versteckte Komplexit\u00e4t. Alles, was die Software ben\u00f6tigt, ist zusammen verpackt und l\u00e4uft auf jedem System gleich. Ein einsatzbereites Ger\u00e4t, statt jedes Mal Komponenten zusammenzubauen.</p>"},{"location":"Container101.html#warum-container-fur-diesen-workshop-wichtig-sind","title":"Warum Container f\u00fcr diesen Workshop wichtig sind","text":"<p>Wir bauen Netzwerksicherheitslabore mit SPSen, HMIs, Switches und Sicherheits\u00fcberwachungswerkzeugen auf. Das geben uns Container:</p> <p>Schnell und wiederholbar Statt Software manuell auf jeder Maschine zu installieren, starten wir ein komplettes Labor in Sekunden. Neustart dauert Sekunden, nicht Minuten oder Stunden.</p> <p>Sauber und isoliert Jede Komponente (SPS-Simulator, HMI, Netzwerkwerkzeug) l\u00e4uft separat. Bei Problemen wird nur dieses eine Teil neu gestartet.</p> <p>Einfach zu teilen Alle erhalten genau dasselbe Labor-Setup. Keine \"funktioniert auf meiner Maschine\"-Probleme.</p> <p>Leichtgewichtig Mehrere SPSen, Switches und Werkzeuge laufen auf Ihrem Laptop. Container verwenden viel weniger Speicher und CPU als virtuelle Maschinen.</p>"},{"location":"Container101.html#github-free-plan-was-sie-bekommen","title":"GitHub Free Plan: Was Sie bekommen","text":"<p>Dieser Workshop nutzt den kostenlosen GitHub-Plan, der leistungsstarke Werkzeuge zum Lernen und Entwickeln kostenlos bereitstellt.</p>"},{"location":"Container101.html#github-codespaces","title":"GitHub Codespaces","text":"<p>Was sind Codespaces? Cloudbasierte Entwicklungsumgebungen, die in Ihrem Browser laufen. Denken Sie daran als vollst\u00e4ndiger Computer mit VS Code, Docker und allen Workshop-Werkzeugen vorinstalliert, von \u00fcberall zug\u00e4nglich.</p> <p>Kostenloser Plan beinhaltet:</p> <ul> <li>120 Core-Stunden pro Monat</li> <li>15 GB Speicher</li> <li>4-Core-Maschinen verf\u00fcgbar</li> </ul> <p>F\u00fcr diesen Workshop: Ein 4-Core-Codespace f\u00fchrt diese gesamte Laborumgebung aus. 120 Stunden bedeuten, Sie k\u00f6nnen das Labor jeden Monat mehrere volle Tage kostenlos ausf\u00fchren.</p>"},{"location":"Container101.html#private-repositories","title":"Private Repositories","text":"<p>Was Sie kostenlos bekommen:</p> <ul> <li>Unbegrenzte private Repositories</li> <li>Unbegrenzte Mitarbeiter</li> <li>Volle Versionskontrolle und Zusammenarbeitsfunktionen</li> </ul>"},{"location":"Container101.html#github-copilot","title":"GitHub Copilot","text":"<p>Was es ist: KI-gest\u00fctzter Coding-Assistent, der Ihnen hilft, Code zu schreiben, Konfigurationen zu verstehen und Probleme zu beheben.</p> <p>Kostenlos f\u00fcr:</p> <ul> <li>Studenten (verifiziert \u00fcber GitHub Student Developer Pack)</li> <li>Maintainer beliebter Open-Source-Projekte</li> <li>Kostenlose Testversion f\u00fcr alle verf\u00fcgbar</li> </ul> <p>F\u00fcr diesen Workshop: Copilot kann Ihnen helfen, Topologie-Dateien zu verstehen, Automatisierungsskripte zu schreiben und Netzwerkkonfigurationen zu debuggen. Besonders n\u00fctzlich beim Erweitern von Laboren nach dem Workshop.</p>"},{"location":"Container101.html#warum-das-fur-ot-fachleute-wichtig-ist","title":"Warum das f\u00fcr OT-Fachleute wichtig ist","text":"<p>Entwicklungswerkzeuge auf Unternehmensniveau ohne Kosten. Keine Budgetgenehmigung n\u00f6tig, um mit OT-Sicherheitslaboren zu lernen und zu experimentieren.</p> <p>Komplette industrielle Netzwerksimulationen in der Cloud, zug\u00e4nglich von jedem Ger\u00e4t. Perfekt zum Lernen in Ihrem eigenen Tempo.</p>"},{"location":"Container101.html#sicherheitshinweis-produktionsdaten","title":"Sicherheitshinweis: Produktionsdaten","text":"<p>Verwenden Sie niemals Produktions- oder Firmendaten mit Codespaces oder Copilot.</p> <p>GitHub Codespaces l\u00e4uft in der Cloud. GitHub Copilot verarbeitet Code, um Vorschl\u00e4ge zu liefern. W\u00e4hrend GitHub Sicherheitsmassnahmen hat, verbieten die Sicherheitsrichtlinien Ihrer Organisation wahrscheinlich das Hochladen sensibler Daten auf externe Dienste.</p> <p>Verwenden Sie nicht:</p> <ul> <li>Echte SPS-Konfigurationen aus Ihrer Anlage</li> <li>Tats\u00e4chliche Netzwerkdiagramme mit echten IP-Adressen</li> <li>Produktionspassw\u00f6rter oder Anmeldedaten</li> <li>Firmenspezifischen Code oder Konfigurationen</li> <li>Alle Daten, die von NDAs oder Vertraulichkeitsvereinbarungen abgedeckt sind</li> </ul> <p>Dieser Workshop verwendet nur simulierte, generische Labordaten. Perfekt zum Lernen ohne Sicherheitsbedenken.</p> <p>F\u00fcr echte Firmendaten verwenden Sie lokale Entwicklungsumgebungen auf firmengef\u00fchrter Infrastruktur, nicht Cloud-Dienste.</p>"},{"location":"Container101.html#container-vs-virtuelle-maschinen-was-sie-wissen-mussen","title":"Container vs. Virtuelle Maschinen: Was Sie wissen m\u00fcssen","text":"<p>Sie kennen vielleicht virtuelle Maschinen (VMs). Container sind \u00e4hnlich, aber viel leichter.</p>"},{"location":"Container101.html#virtuelle-maschinen","title":"Virtuelle Maschinen","text":"<ul> <li>Vollst\u00e4ndiges Betriebssystem f\u00fcr jede VM</li> <li>Braucht Minuten zum Starten</li> <li>Verwendet viel Speicher und Festplattenspeicher</li> <li>Gute Isolation, aber schwer</li> </ul>"},{"location":"Container101.html#container","title":"Container","text":"<ul> <li>Teilen das zugrunde liegende Betriebssystem</li> <li>Starten in Sekunden</li> <li>Verwenden viel weniger Speicher und Festplatte</li> <li>Leicht, aber trotzdem ausreichend isoliert f\u00fcr Labore</li> </ul> <p>F\u00fcr diesen Workshop: Container sind leichtgewichtige VMs, die sofort starten.</p>"},{"location":"Container101.html#einfache-vergleichstabelle","title":"Einfache Vergleichstabelle","text":"Was Sie brauchen Virtuelle Maschine Container Einen SPS-Simulator starten Warten Sie 2-3 Minuten Bereit in 2-3 Sekunden 10 verschiedene Ger\u00e4te ausf\u00fchren Schwer auf Ihrem Laptop Komfortabel auf Ihrem Laptop Auf sauberen Zustand zur\u00fccksetzen Langsames Herunterfahren und Neustart Sofort Exakte Einrichtung mit Kollegen teilen Grosse VM-Images zu \u00fcbertragen Kleine Container-Images"},{"location":"Container101.html#was-in-diesem-workshop-passiert","title":"Was in diesem Workshop passiert","text":"<p>Sie werden Containerlab \u00fcber eine VS Code-Erweiterung verwenden. Keine komplexen Befehle zum Tippen. Kein tiefes technisches Wissen erforderlich.</p>"},{"location":"Container101.html#was-sie-tatsachlich-tun-werden","title":"Was Sie tats\u00e4chlich tun werden","text":"<ol> <li>Topologie-Datei \u00f6ffnen - Textdatei, die Ihr Labornetzwerk beschreibt (SPSen, Switches, HMIs)</li> <li>\"Deploy\" in VS Code klicken - Die Erweiterung startet Ihr Labor</li> <li>Labor verwenden - Ger\u00e4te verbinden, Sicherheitstests durchf\u00fchren, Datenverkehr erfassen</li> <li>\"Destroy\" klicken - Alles wird sauber entfernt</li> </ol> <p>Vier Schritte. Einfach.</p>"},{"location":"Container101.html#was-hinter-den-kulissen-passiert-aber-sie-mussen-sich-nicht-darum-kummern","title":"Was hinter den Kulissen passiert (aber Sie m\u00fcssen sich nicht darum k\u00fcmmern)","text":"<p>Wenn Sie \"Deploy\" klicken, macht Containerlab:</p> <ul> <li>Liest Ihre Topologie-Datei</li> <li>L\u00e4dt vorgefertigte Container-Images f\u00fcr Ihre Ger\u00e4te herunter oder verwendet sie</li> <li>Startet jedes Ger\u00e4t als Container</li> <li>Verbindet sie mit virtuellen Netzwerkkabeln</li> <li>Gibt Ihnen Zugriff auf jedes Ger\u00e4t</li> </ul> <p>Wenn Sie fertig sind und \"Destroy\" klicken, wird alles sauber entfernt. Keine \u00fcbrig gebliebenen Dateien oder Konfigurationen.</p>"},{"location":"Container101.html#haufige-fragen-von-ot-fachleuten","title":"H\u00e4ufige Fragen von OT-Fachleuten","text":"<p>F: Ist das sicher genug f\u00fcr unser Labor? Ja. Container bieten gute Isolation f\u00fcr Training und Tests. Sie werden von Millionen von Entwicklern und Unternehmen weltweit verwendet. F\u00fcr unseren Workshop sind sie mehr als ausreichend.</p> <p>F: Muss ich Docker-Befehle lernen? Nein. Die Containerlab VS Code-Erweiterung bietet Buttons statt Befehle.</p> <p>F: K\u00f6nnen Container industrielle Protokolle wie Modbus, S7 oder PROFINET handhaben? Ja. Container f\u00fchren jede Software aus, einschliesslich industrieller Protokollstacks und Simulatoren. Der Netzwerkverkehr funktioniert wie erwartet.</p> <p>F: Was passiert bei einem Absturz? Komponente neu bereitstellen. Schnell und sauber.</p> <p>F: Ist das die \"Cloud\"? Nein. Alles l\u00e4uft lokal auf Ihrem Laptop. Kein Internet erforderlich (nach initialer Einrichtung). Volle Kontrolle.</p> <p>F: Kann ich das nach dem Workshop f\u00fcr eigene Tests verwenden? Ja. Genau daf\u00fcr ist es gedacht - f\u00fcr eigene OT-Sicherheits- und Netzwerk-Testlabore.</p> <p>F: Wird das meinen Computer durcheinanderbringen? Nein. Container sind isoliert. Beim Entfernen verschwinden sie vollst\u00e4ndig. Nichts bleibt zur\u00fcck.</p>"},{"location":"Container101.html#warum-speziell-containerlab","title":"Warum speziell Containerlab?","text":"<p>Containerlab wurde von Netzwerkingenieuren f\u00fcr Netzwerkingenieure entwickelt. Es l\u00f6st das Problem, Netzwerkkonfigurationen und -topologien schnell zu testen.</p> <p>Warum es perfekt f\u00fcr OT-Arbeit ist:</p> <ul> <li>Gesamte Netzwerktopologie in einer Textdatei definieren</li> <li>Unterst\u00fctzt Netzwerkger\u00e4te (Switches, Router) und Endger\u00e4te (SPSen, HMIs)</li> <li>Bereitstellung in Sekunden, genauso schnell wieder abbauen</li> <li>Nahtlose VS Code Integration</li> <li>Einfaches Teilen von Laboren - Topologie-Datei an Kollegen senden</li> <li>Kostenlos und Open Source</li> </ul> <p>Netzwerkingenieure bei grossen Herstellern wie Nokia, Cisco und Juniper verwenden Containerlab t\u00e4glich. Es ist kampferprobt und zuverl\u00e4ssig.</p>"},{"location":"Container101.html#reale-perspektive-alter-weg-vs-neuer-weg","title":"Reale Perspektive: Alter Weg vs. Neuer Weg","text":"<p>Traditioneller Ansatz: Physisches Labor aufbauen oder mehrere VMs konfigurieren. Dauert Stunden oder Tage. Bricht leicht. Schwer zu teilen. Schmerzhaftes Zur\u00fccksetzen.</p> <p>Container-Ansatz: Textdatei schreiben, die Ihr Netzwerk beschreibt. Deploy klicken. Labor bereit in 30 Sekunden. Etwas kaputt? Erneut bereitstellen in 30 Sekunden. Datei mit Kollegen teilen, die sofort die identische Einrichtung erhalten.</p> <p>Der Unterschied: Zeit f\u00fcr OT-Sicherheit und -Netzwerke lernen, statt mit Infrastruktur k\u00e4mpfen.</p>"},{"location":"Container101.html#die-wahrheit-uber-lernkurven","title":"Die Wahrheit \u00fcber Lernkurven","text":"<p>Sie m\u00fcssen kein Container-Experte werden.</p> <p>Was Sie wissen m\u00fcssen:</p> <ul> <li>Wie man ein Labor bereitstellt (einen Button klicken)</li> <li>Wie man sich mit Ger\u00e4ten im Labor verbindet (wie immer)</li> <li>Wie man das Labor zerst\u00f6rt, wenn fertig (einen anderen Button klicken)</li> </ul> <p>Das ist alles. Die Containerlab VS Code-Erweiterung \u00fcbernimmt alles andere.</p> <p>Nach diesem Workshop, wenn Sie tiefer eintauchen m\u00f6chten, gibt es ausgezeichnete Ressourcen. Aber f\u00fcrs Erste konzentrieren Sie sich auf OT-Sicherheit und -Netzwerke. Container-Technologie ist nur das Werkzeug, das die Labore zum Laufen bringt.</p>"},{"location":"Container101.html#was-container-fur-ot-labore-funktionieren-lasst","title":"Was Container f\u00fcr OT-Labore funktionieren l\u00e4sst","text":"<p>Container zeichnen sich durch das Simulieren von OT-Umgebungen aus:</p> <p>Netzwerkverhalten ist realistisch Virtuelle Netzwerkverbindungen verhalten sich wie echte Ethernet-Kabel. Industrielle Protokolle funktionieren identisch. Netzwerkverkehr sieht f\u00fcr \u00dcberwachungswerkzeuge gleich aus.</p> <p>Leistung ist ausreichend Ein moderner Laptop f\u00fchrt bequem 10-20 containerisierte Ger\u00e4te aus. Ausreichend f\u00fcr realistische OT-Netzwerktopologien mit mehreren Zonen.</p> <p>Zustand kann bewahrt werden SPS-Konfiguration zwischen Sitzungen beibehalten oder jedes Mal frisch starten. Ihre Wahl.</p> <p>Timing ist vorhersehbar Nicht f\u00fcr harte Echtzeit-Steuerung geeignet, aber perfekt zum Testen von Netzwerkprotokollen, Sicherheits\u00fcberwachung und Angriffsszenarien.</p>"},{"location":"Container101.html#wichtige-einschrankungen-ehrlich-sein","title":"Wichtige Einschr\u00e4nkungen (ehrlich sein)","text":"<p>Seien wir klar dar\u00fcber, was dies ist und was nicht:</p> <p>Nicht f\u00fcr Produktion Dies sind Simulationen und Testumgebungen. Niemals in tats\u00e4chliche Anlagennetzwerke einsetzen.</p> <p>Keine Echtzeit-Steuerung Perfekt zum Testen von Protokollen und Sicherheit. Nicht f\u00fcr sicherheitskritische Steuerungssysteme mit harten Echtzeit-Garantien geeignet.</p> <p>Nicht identisch mit echten Ger\u00e4ten Simulatoren verhalten sich wie SPSen und HMIs, f\u00fchren aber nicht Ihre genaue Produktions-Firmware aus.</p> <p>Fazit: F\u00fcr Training und Tests - perfekt. F\u00fcr Produktionssteuerung - echte, zertifizierte Hardware verwenden.</p>"},{"location":"Container101.html#ihr-workshop-lernpfad","title":"Ihr Workshop-Lernpfad","text":"<p>Vor dem Workshop:</p> <ul> <li>Stressen Sie nicht wegen Containern. Sie sind nur ein Werkzeug.</li> <li>Stellen Sie sicher, dass Docker Desktop und VS Code installiert sind (wir f\u00fchren Sie).</li> <li>Vertrauen Sie darauf, dass Millionen von Menschen dies t\u00e4glich verwenden.</li> </ul> <p>W\u00e4hrend des Workshops:</p> <ul> <li>Konzentrieren Sie sich auf OT-Sicherheit und -Netzwerke, nicht auf Container-Technologie.</li> <li>Verwenden Sie die VS Code-Erweiterung - Point-and-Click-Interface.</li> <li>Stellen Sie jederzeit Fragen, wenn etwas unklar ist.</li> </ul> <p>Nach dem Workshop:</p> <ul> <li>Sie werden selbstbewusst Ihre eigenen Testlabore aufbauen.</li> <li>Erkunden Sie erweiterte Funktionen, wenn interessiert.</li> <li>Verstehen Sie, warum Container in OT-Sicherheits- und Netzwerktests beliebt sind.</li> </ul>"},{"location":"Container101.html#mochten-sie-mehr-lernen-optional","title":"M\u00f6chten Sie mehr lernen? (Optional)","text":"<p>Wenn Sie nach dem Workshop tiefer eintauchen m\u00f6chten, haben diese Ressourcen Millionen von Menschen geholfen, Container zu verstehen. Alle sind anf\u00e4ngerfreundlich:</p>"},{"location":"Container101.html#sehr-empfohlene-videos-hier-starten","title":"Sehr empfohlene Videos (hier starten)","text":"<p>Docker in 100 Seconds von Fireship https://www.youtube.com/watch?v=Gjnup-PuquQ Schnell, visuell und perfekt, um die Grundlagen zu verstehen.</p> <p>you need to learn Docker RIGHT NOW von NetworkChuck https://www.youtube.com/watch?v=eGz9DS-aIeY Spassig, praktisch und anf\u00e4ngerfreundliche Einf\u00fchrung.</p>"},{"location":"Container101.html#offizielle-docker-ressourcen","title":"Offizielle Docker-Ressourcen","text":"<p>Docker Get Started Guide https://docs.docker.com/get-started/ Offizielle Docker-Dokumentation, gut strukturiert und klar.</p> <p>Docker 101 Interactive Tutorial https://www.docker.com/101-tutorial Praktisches Tutorial, das Sie in Ihrem Browser oder auf Ihrer Maschine machen k\u00f6nnen.</p> <p>What is a Container? (Docker's explanation) https://www.docker.com/resources/what-container/ Dockers eigene anf\u00e4ngerfreundliche Erkl\u00e4rung.</p>"},{"location":"Container101.html#containerlab-spezifisch","title":"Containerlab-spezifisch","text":"<p>Containerlab Quick Start https://containerlab.dev/quickstart/ Die offizielle Schnellstartanleitung - sehr zug\u00e4nglich.</p> <p>Containerlab VS Code Extension https://containerlab.dev/manual/vsc-extension/ Dokumentation f\u00fcr die Erweiterung, die wir im Workshop verwenden werden.</p> <p>Containerlab YouTube Channel https://www.youtube.com/@containerlab Video-Tutorials und Demonstrationen.</p>"},{"location":"Container101.html#fur-visuelle-lerner","title":"F\u00fcr visuelle Lerner","text":"<p>Play with Docker https://labs.play-with-docker.com/ Kostenlose Online-Umgebung, um Docker-Befehle auszuprobieren, ohne etwas zu installieren.</p> <p>Docker Curriculum by Prakhar Srivastav https://docker-curriculum.com/ Anf\u00e4ngerfreundliches Tutorial mit klaren Erkl\u00e4rungen und Beispielen.</p>"},{"location":"Container101.html#wenn-sie-mit-vms-vergleichen-mochten","title":"Wenn Sie mit VMs vergleichen m\u00f6chten","text":"<p>Containers vs Virtual Machines (IBM Technology) https://www.youtube.com/watch?v=cjXI-yxqGTI Klare Videoerkl\u00e4rung der Unterschiede.</p>"},{"location":"Container101.html#fazit-fur-diesen-workshop","title":"Fazit f\u00fcr diesen Workshop","text":"<p>Sie m\u00fcssen kein Container-Experte sein. Sie m\u00fcssen nur wissen, dass Container ausgereifte, bew\u00e4hrte Technologie sind, die von Millionen von Entwicklern und Unternehmen weltweit verwendet wird.</p> <p>Die VS Code-Erweiterung \u00fcbernimmt die schwere Arbeit. Sie konzentrieren sich auf OT-Sicherheit und -Netzwerke.</p> <p>Container sind einfach das Werkzeug, das uns erlaubt, schnelle, wiederholbare, teilbare OT-Sicherheits- und Netzwerklabore zu bauen. Das ist ihr Zweck hier. Sie machen es gut.</p> <p>Bereit, in OT-Sicherheit und -Netzwerke einzutauchen? Los geht's.</p>"},{"location":"agenda.html","title":"Agenda des Workshops 2 (ISC-CPH \u2013 Mittwoch)","text":"<p>\u00dcbersetzung in Arbeit</p> <p>Diese Seite wird derzeit ins Deutsche \u00fcbersetzt. Die vollst\u00e4ndige \u00dcbersetzung folgt in K\u00fcrze.</p> <p>Track: Workshop 2</p> <p>Technical Level: Fortgeschritten</p> <p>Dozenten: Martin Scheu (Switch) &amp; Mischa Diehm (Narrowin)</p>"},{"location":"agenda.html#11101150-teil-1-ot-netzwerke-verstehen","title":"11:10\u201311:50 \u2014 Teil 1: OT-Netzwerke verstehen","text":"<ul> <li>Titel: OT-Netzwerke verstehen &amp; den OT-Netzwerkdschungel lichten</li> <li>Inhalte: OT-Protokolle und -Eigenschaften, Tool-\u00dcberblick, grundlegende Erkennung und Paketmitschnitt</li> <li>Praktische \u00dcbung: Labor Teil 1</li> </ul>"},{"location":"agenda.html#12501330-teil-2-ot-netzwerk-sicherheitsuberwachung","title":"12:50\u201313:30 \u2014 Teil 2: OT-Netzwerk-Sicherheits\u00fcberwachung","text":"<ul> <li>Titel: OT-Netzwerk-Sicherheits\u00fcberwachung</li> <li>Inhalte: \u00dcberwachungspunkte und Transparenzstrategie; zonen\u00fcbergreifender Verkehr; IT/OT-Br\u00fccke; \u00dcberwachung validieren und blinde Flecken erkennen</li> <li>Praktische \u00dcbung: Labor Teil 2</li> </ul>"},{"location":"agenda.html#13551430-teil-3-einstieg-in-die-ot-netzwerk-sicherheitsuberwachung","title":"13:55\u201314:30 \u2014 Teil 3: Einstieg in die OT-Netzwerk-Sicherheits\u00fcberwachung","text":"<ul> <li>Titel: Einstieg in die OT-Netzwerk-Sicherheits\u00fcberwachung</li> <li>Inhalte: Erkennungszyklus (Use Cases \u2192 Erkennung \u2192 Alarmierung \u2192 Playbook \u2192 Tuning); Techniken zur Entdeckung von Assets und Kommunikationsmustern; Testen und Validieren</li> <li>Praktische \u00dcbung: Labor Teil 3</li> </ul> <p>Hinweise:</p> <ul> <li>Pausen und Raumlogistik folgen dem Konferenzprogramm (Mittagessen um 11:50, Erfrischungen um 13:30, kurze Pause um 14:30)</li> <li>Fortgeschrittene Aufgaben sind optional und in der Laboranleitung gekennzeichnet</li> <li>Ziel ist es, innerhalb der Zeitfenster zu bleiben; Dozenten rufen Checkpoints auf</li> </ul>"},{"location":"automation.html","title":"Netzwerk-Automatisierung","text":""},{"location":"automation.html#warum-automatisieren","title":"Warum automatisieren?","text":"<p>Netzwerkautomatisierung reduziert manuelle Fehler, spart Zeit und gew\u00e4hrleistet Konsistenz \u00fcber Ihre Infrastruktur. Nach manueller Exploration dieser Laborumgebung k\u00f6nnen Sie h\u00e4ufige Aufgaben automatisieren:</p> <ul> <li>Diagnosebefehle \u00fcber mehrere Ger\u00e4te ausf\u00fchren</li> <li>Konfigurationen regelm\u00e4ssig sichern</li> <li>Systeminformationen f\u00fcr Analysen sammeln</li> <li>Firmware-Updates verwalten</li> </ul> <p>Dieser Leitfaden zeigt, wie Sie mit dem Open-Source-Werkzeug networka beginnen, einem Multi-Vendor-Netzwerkautomatisierungs-CLI-Toolkit.</p>"},{"location":"automation.html#schritt-1-networka-installieren","title":"Schritt 1: networka installieren","text":"<p>Installieren Sie networka mit uv oder pipx:</p> <pre><code>uv tool install git+https://github.com/narrowin/networka.git\n</code></pre> <p>Installation \u00fcberpr\u00fcfen:</p> <pre><code>nw --version\n</code></pre>"},{"location":"automation.html#schritt-2-konfiguration-initialisieren","title":"Schritt 2: Konfiguration initialisieren","text":"<p>Initialisierungsbefehl ausf\u00fchren:</p> <pre><code>nw config init\n</code></pre> <p>Dies erstellt ein Konfigurationsverzeichnis unter <code>~/.config/networka</code> (Linux/macOS):</p> <ul> <li><code>devices/</code> - Ger\u00e4tedefinitionen</li> <li><code>groups/</code> - Ger\u00e4tegruppen und Tags  </li> <li><code>sequences/</code> - Wiederverwendbare Befehlssequenzen</li> <li><code>.env</code> - Anmeldedaten</li> </ul> <p>Folgen Sie den Eingabeaufforderungen f\u00fcr Shell-Vervollst\u00e4ndigungen und optionale Herstellersequenzen.</p>"},{"location":"automation.html#schritt-3-ihre-laborgerate-definieren","title":"Schritt 3: Ihre Laborger\u00e4te definieren","text":"<p>Bearbeiten Sie <code>~/.config/networka/devices/devices.yml</code>, um die Laborger\u00e4te hinzuzuf\u00fcgen:</p> <pre><code>devices:\n  router1:\n    host: 192.168.100.11\n    device_type: mikrotik_routeros\n    platform: x86\n    description: \"Gateway-Router\"\n    tags:\n      - gateway\n      - critical\n\n  switch1:\n    host: 192.168.100.12\n    device_type: mikrotik_routeros\n    platform: x86\n    description: \"Access-Switch\"\n    tags:\n      - switch\n      - access\n</code></pre> <p>\u00dcberpr\u00fcfen Sie, dass Ihre Ger\u00e4te geladen sind:</p> <pre><code>nw list devices\n</code></pre> <p>Sie sollten beide Ger\u00e4te mit ihren IP-Adressen und Beschreibungen sehen.</p>"},{"location":"automation.html#schritt-4-ersten-befehl-ausfuhren","title":"Schritt 4: Ersten Befehl ausf\u00fchren","text":"<p>Schnittstellenstatus auf dem Router mit vordefinierter Sequenz pr\u00fcfen:</p> <pre><code>nw run router1 interface_status\n</code></pre> <p>Dies verbindet sich mit dem Ger\u00e4t und zeigt:</p> <ul> <li>Alle Schnittstellen mit Status und Konfiguration</li> <li>Verkehrsstatistiken (Pakete, Bytes, Fehler, Drops)</li> <li>Ethernet-Port-Details und -Geschwindigkeiten</li> <li>Aktueller Durchsatz f\u00fcr jede Schnittstelle</li> </ul> <p>Die Ausgabe ist formatiert und mit klaren Abschnitten f\u00fcr jedes Befehlsergebnis leicht lesbar.</p>"},{"location":"automation.html#schritt-5-weitere-sequenzen-erkunden","title":"Schritt 5: Weitere Sequenzen erkunden","text":"<p>Networka enth\u00e4lt viele eingebaute Sequenzen f\u00fcr h\u00e4ufige Operationen. Verf\u00fcgbare Sequenzen anzeigen:</p> <pre><code>nw run router1 &lt;TAB&gt;\n</code></pre> <p>Probieren Sie diese n\u00fctzlichen Sequenzen aus:</p> <pre><code># Schnelle Ger\u00e4te\u00fcbersicht\nnw run router1 quick_status\n\n# Detaillierte Systeminformationen\nnw run router1 system_info\n\n# Routing-Tabelle pr\u00fcfen\nnw run router1 routing_info\n\n# Vollst\u00e4ndiger Gesundheitscheck\nnw run router1 health_check\n</code></pre>"},{"location":"automation.html#schritt-6-konfigurationen-sichern","title":"Schritt 6: Konfigurationen sichern","text":"<p>Erstellen Sie Konfigurationssicherungen mit herstellerbewusster Behandlung:</p> <pre><code># Konfigurationsexport\nnw backup config router1\n\n# Umfassende Sicherung (Konfiguration + Systemdaten)\nnw backup comprehensive router1\n</code></pre> <p>Die Sicherungen werden in Ihrem Ergebnisverzeichnis mit Zeitstempeln gespeichert.</p>"},{"location":"automation.html#schritt-7-mit-mehreren-geraten-arbeiten","title":"Schritt 7: Mit mehreren Ger\u00e4ten arbeiten","text":"<p>Befehle gleichzeitig auf mehreren Ger\u00e4ten ausf\u00fchren:</p> <pre><code># Kommagetrennte Liste\nnw run router1,switch1 quick_status\n\n# Befehl \u00fcber Ger\u00e4te ausf\u00fchren\nnw run router1,switch1 \"/system/resource/print\"\n</code></pre> <p>F\u00fcr Produktionseinsatz Ger\u00e4tegruppen erstellen und Befehle effizient \u00fcber ganze Gruppen ausf\u00fchren.</p>"},{"location":"automation.html#was-als-nachstes","title":"Was als N\u00e4chstes?","text":"<p>Sobald Sie mit diesen Grundlagen vertraut sind:</p> <ol> <li>Benutzerdefinierte Sequenzen erstellen - Definieren Sie Ihre eigenen Befehls-Workflows in YAML</li> <li>Ger\u00e4tegruppen einrichten - Organisieren Sie Ger\u00e4te nach Rolle, Standort oder Funktion</li> <li>Sicherungen planen - Verwenden Sie cron oder systemd-Timer f\u00fcr automatisierte Sicherungen</li> <li>Multi-Vendor erkunden - networka unterst\u00fctzt MikroTik, Cisco, Arista, Juniper und mehr</li> </ol> <p>Lesen Sie die vollst\u00e4ndige Dokumentation f\u00fcr erweiterte Funktionen wie:</p> <ul> <li>Benutzerdefinierte Befehlssequenzen</li> <li>Tag-basierte Ger\u00e4tefilterung</li> <li>Ergebnisspeicherung und -analyse</li> <li>CI/CD-Integration</li> <li>Multi-Vendor-Workflows</li> </ul>"},{"location":"cheatsheet.html","title":"Workshop-Spickzettel","text":""},{"location":"cheatsheet.html#zugangsdaten","title":"Zugangsdaten","text":"<pre><code>Benutzername: admin\nPasswort: admin\n</code></pre>"},{"location":"cheatsheet.html#labor-starten-und-stoppen","title":"Labor starten und stoppen","text":"<p>Verwenden Sie die VS Code Containerlab-Erweiterung mit dem Graph TopoViewer. Rechtsklick auf <code>ot-sec-segmented.clab.yml</code> (oder <code>ot-sec-flat.clab.yml</code>) und <code>Graph Topoviewer</code> w\u00e4hlen.</p> <p>Labor starten: Play-Button in der TopoViewer-Navigation dr\u00fccken.</p> <p>Oder \u00fcber die Kommandozeile:</p> <pre><code>clab deploy --topo ot-sec-segmented.clab.yml\nclab destroy --topo ot-sec-segmented.clab.yml\n</code></pre>"},{"location":"cheatsheet.html#mit-geraten-verbinden","title":"Mit Ger\u00e4ten verbinden","text":"<p>Schneller SSH-Zugriff (Ger\u00e4tenamen verwenden):</p> <pre><code>ssh clab-ot-sec-flat-proxmox-jumphost\nssh clab-ot-sec-flat-wago-plc2a-vlan10\nssh clab-ot-sec-flat-wago-plc2b-vlan10\nssh clab-ot-sec-flat-abb-800xa-vlan40\n</code></pre> <p>Oder SSH \u00fcber IP-Adresse:</p> <pre><code>ssh admin@192.168.100.52   # jumphost\nssh admin@192.168.100.53   # WAGO SPS 2A\nssh admin@192.168.100.54   # WAGO SPS 2B\nssh admin@192.168.100.57   # ABB 800XA\n</code></pre>"},{"location":"cheatsheet.html#web-zugriff","title":"Web-Zugriff","text":"<p>HMI-Desktop:</p> <p>http://192.168.100.60:5800</p> <p>ABB-System:</p> <p>http://192.168.100.57:8080</p>"},{"location":"cheatsheet.html#sps-weboberflachen","title":"SPS-Weboberfl\u00e4chen","text":"<p>Management-IPs direkt verwenden; SPS-Weboberfl\u00e4chen (falls aktiviert) lauschen auf Port 8080 im Labornetzwerk.</p> Ger\u00e4t URL (falls aktiviert) Zweck abb-800xa-vlan40 http://10.40.0.11:8080 HMI/Steuerungsschnittstellen\u00fcbersicht wago-plc2a-vlan10 http://10.10.0.11:8080 SPS-Weboberfl\u00e4che wago-plc2b-vlan10 http://10.10.0.12:8080 SPS-Weboberfl\u00e4che (noch nicht funktionsf\u00e4hig) ctrlx-plc3-vlan20 http://10.20.0.11:8080 SPS-Weboberfl\u00e4che schneider-plc4-vlan30 http://10.30.0.11:8080 SPS-Weboberfl\u00e4che"},{"location":"cheatsheet.html#befehle-auf-der-sps","title":"Befehle auf der SPS","text":"<p>Pr\u00fcfen, ob die CODESYS-Runtime l\u00e4uft:</p> <pre><code>pgrep -f codesyscontrol.bin\n# oder\nsudo /etc/init.d/codesyscontrol status\n</code></pre> <p>Runtime neu starten:</p> <pre><code>sudo /etc/init.d/codesyscontrol restart\n</code></pre> <p>Ping-Test:</p> <pre><code>ping 10.10.0.1\n</code></pre> <p>Netzwerkverkehr mitschneiden:</p> <pre><code>sudo tcpdump -lnei eth1\n</code></pre>"},{"location":"cheatsheet.html#netzwerk-vom-jumphost-scannen","title":"Netzwerk vom Jumphost scannen","text":"<p>Ger\u00e4te finden:</p> <pre><code>nmap 10.10.0.0/24\n</code></pre> <p>Pr\u00fcfen, ob SPS-Port offen ist:</p> <pre><code>nc -zv 10.10.0.11 1217\n</code></pre>"},{"location":"feedback.html","title":"Workshop-Feedback","text":"<p>Vielen Dank f\u00fcr Ihre Teilnahme am OT Network Security Monitoring Workshop an der ISC CPH 2025.</p> <p>Ihr Feedback hilft uns, zuk\u00fcnftige Workshops zu verbessern.</p>"},{"location":"feedback.html#feedback-senden","title":"Feedback senden","text":"<p>Feedback per E-Mail senden</p> <p>Ein Klick auf den Button \u00f6ffnet Ihr E-Mail-Programm mit einer vorausgef\u00fcllten Vorlage. Einfach Ihre Bewertungen eintragen und absenden.</p>"},{"location":"feedback.html#feedback-fragen","title":"Feedback-Fragen","text":"<p>Bewertung von 1 (Schlecht) bis 5 (Ausgezeichnet):</p> <ol> <li>Gesamterlebnis des Workshops</li> <li>Relevanz der Inhalte f\u00fcr Ihre OT-Arbeit</li> <li>Laborumgebung und \u00dcbungen</li> <li>Qualit\u00e4t der Dokumentation</li> <li>Vortrag der Referenten</li> <li>W\u00fcrden Sie diesen Workshop empfehlen? (Ja/Nein)</li> </ol> <p>Optional:</p> <ul> <li>Was hat gut funktioniert?</li> <li>Was sollte verbessert werden?</li> <li>Weitere Vorschl\u00e4ge?</li> </ul>"},{"location":"feedback.html#vielen-dank","title":"Vielen Dank","text":"<p>Ihr Feedback beeinflusst direkt, wie wir OT-Security-Schulungen entwickeln und durchf\u00fchren.</p> <p>Fragen? Kontakt:</p> <ul> <li>Martin Scheu - martin.scheu@switch.ch</li> <li>Mischa Diehm - mischa.diehm@narrowin.ch</li> </ul>"},{"location":"lab.html","title":"Laborumgebung","text":""},{"location":"lab.html#uberblick","title":"\u00dcberblick","text":"<p>Dieser Workshop nutzt eine realistische OT-Netzwerk-Laborumgebung, die mit Containerlab aufgebaut wurde. Das Labor simuliert eine typische Industrieanlage mit mehreren Sicherheitszonen, SPSen, Netzwerksegmentierung und \u00dcberwachungspunkten, die reale Deployments widerspiegeln k\u00f6nnen.</p> <p>Das Labor ist herstellerneutral und verwendet ausschliesslich Open-Source- und kostenfreie Werkzeuge. Alle Komponenten laufen in Containern, was schnelle Bereitstellung, Experimente und Zur\u00fccksetzen w\u00e4hrend praktischer \u00dcbungen erm\u00f6glicht.</p> <p></p>"},{"location":"lab.html#erste-schritte","title":"Erste Schritte","text":""},{"location":"lab.html#laborumgebung-starten","title":"Laborumgebung starten","text":"<p>Das Labor l\u00e4uft in einem Entwicklungscontainer mit allen erforderlichen Werkzeugen vorinstalliert. W\u00e4hlen Sie eine Option:</p> <p>Option 1: GitHub Codespaces (Empfohlen)</p> <p>GitHub Codespaces bietet eine cloudbasierte Umgebung, die \u00fcber Ihren Browser zug\u00e4nglich ist. Keine lokale Installation erforderlich.</p> <ol> <li>Gehen Sie zu github.com/narrowin-labs/ot-lab</li> <li>Klicken Sie auf \"Codespaces Open in Codespaces\"</li> <li>Warten Sie 5-10 Minuten f\u00fcr die initiale Einrichtung (nur beim ersten Mal)</li> </ol> <p>Initiale Einrichtungszeit: Beim ersten Erstellen eines Codespace werden alle Container-Images heruntergeladen und konfiguriert. Dies dauert etwa 5-10 Minuten. Die Einrichtung ist abgeschlossen, wenn Sie die Docker-Images-Liste im Terminal sehen:</p> <pre><code>\u276f docker images\nREPOSITORY                                    TAG       IMAGE ID       CREATED         SIZE\nghcr.io/narrowin/ot-sec-lab-hmi               latest    96b8774dc7e4   5 days ago      731MB\nghcr.io/narrowin/ot-sec-lab-plc               latest    9f7db1f2f47d   7 days ago      333MB\nghcr.io/kaelemc/wireshark-vnc-docker          latest    4cebbe954b93   3 months ago    554MB\nghcr.io/narrowin/ot-sec-lab-linux             latest    643864c992c6   4 months ago    908MB\nghcr.io/narrowin/vrnetlab_mikrotik_routeros   7.18      50052d2a79a1   6 months ago    1.01GB\nghcr.io/siemens/ghostwire                     latest    18664310d22f   15 months ago   36.5MB\nghcr.io/siemens/packetflix                    latest    6bed7a0d2a95   20 months ago   122MB\n</code></pre> <p>Nachfolgende Starts sind deutlich schneller (unter 1 Minute).</p> <p>Dokumentation: docs.github.com/codespaces</p>"},{"location":"lab.html#ein-labor-starten","title":"Ein Labor starten","text":"<p>\u00d6ffnen Sie die Containerlab-Erweiterung, klicken Sie mit der rechten Maustaste auf eines der beiden Labore und w\u00e4hlen Sie \"Edit topology (TopoViewer)\":</p> <p></p> <p>Klicken Sie auf das Play-Symbol, um das Labor zu deployen. Dies startet das Labor. Warten Sie 3-5 Minuten, bis das Labor vollst\u00e4ndig funktionsf\u00e4hig ist. Sobald alle Knoten gr\u00fcn sind:</p> <p></p> <p>f\u00fchren Sie im Terminal aus: <code>scripts/lab-test.py ot-sec-flat</code> oder <code>scripts/lab-test.py ot-sec-segmented</code>, je nachdem, was Sie gestartet haben. Wenn alle Checks des Testskripts gr\u00fcn sind, sind Sie startklar.</p>"},{"location":"lab.html#wasseraufbereitungs-frontend","title":"Wasseraufbereitungs-Frontend","text":"<p>\u00d6ffnen Sie den Ports-Bereich im unteren Panel, klicken Sie mit der rechten Maustaste auf <code>HMI WeChromium bVNC</code> oder <code>ABB 800xA HMI Interface</code> und w\u00e4hlen Sie <code>Open in Browser</code>. </p> <p>Experimentieren Sie mit der OT-Ausr\u00fcstung: </p>"},{"location":"lab.html#datenverkehr-mit-wireshark-betrachten","title":"Datenverkehr mit Wireshark betrachten","text":"<p>Sobald das Labor l\u00e4uft, k\u00f6nnen Sie jede Kommunikation mit Live-Paketmitschnitten \u00fcberwachen. Klicken Sie mit der rechten Maustaste auf einen Link im TopoViewer und w\u00e4hlen Sie, auf welcher Seite des Links Sie mitschneiden m\u00f6chten. Dies \u00f6ffnet Wireshark innerhalb von VS Code zur Analyse des Datenverkehrs.</p> <p></p> <p>Beim ersten Mal fragt VS Code, ob Sie mit Edgeshark \u00f6ffnen m\u00f6chten: w\u00e4hlen Sie ja.</p> <p></p> <p>Beim ersten Start kann das neu erstellte Fenster mit einem Fehler starten. Schliessen Sie es und versuchen Sie es erneut.</p>"},{"location":"lab.html#kurzreferenz","title":"Kurzreferenz","text":""},{"location":"lab.html#das-management-netzwerk-verstehen","title":"Das Management-Netzwerk verstehen","text":"<p>Das Labor hat zwei separate Netzwerkebenen:</p>"},{"location":"lab.html#management-ebene-192168100024","title":"Management-Ebene (192.168.100.0/24)","text":"<ul> <li>Automatisch von Containerlab erstellt</li> <li>Erm\u00f6glicht Zugriff auf Container vom Host</li> <li>Verwenden Sie diese IPs f\u00fcr SSH oder Weboberfl\u00e4chen</li> <li>Simuliert Out-of-Band-Management in realen Netzwerken</li> </ul>"},{"location":"lab.html#labor-topologie-ebene-100008","title":"Labor-Topologie-Ebene (10.0.0.0/8)","text":"<ul> <li>Das Netzwerk f\u00fcr Ihre Tests</li> <li>Container-Kommunikation untereinander</li> <li>Anwendung von Netzwerksegmentierung und Sicherheitsrichtlinien</li> </ul> <pre><code>Ihr Host-Rechner / Browser\n         |\n         | Exportierte Ports\n         | :5800 -&gt; HMI WebVNC (Chromium-Browser im Labor)\n         | :8080 -&gt; ABB 800xA HMI (10.40.0.11:8080)\n         | :8000 -&gt; MkDocs-Dokumentation\n         |\n         | Direkter Zugriff \u00fcber Docker-Bridge\n         |\n    +----v--------------------------------------------+\n    |  Management-Netzwerk: 192.168.100.0/24          |\n    |  (Containerlab erstellt dies automatisch)       |\n    |                                                 |\n    |  .11      .12      .13      .52      .53   .57  |\n    |  [gw]    [sw]    [sw]    [jump]   [plc]  [abb]  |\n    +----+------+-------+--------+--------+------+----+\n         |      |       |        |        |      |\n         |      |       |        |        |      |\n    +----+------+-------+--------+--------+------+----+\n    |  Labor-Topologie-Netzwerke                      |\n    |  10.10.0.0/24, 10.20.0.0/24, 10.30.0.0/24, etc. |\n    |  (Ihr eigentliches zu testendes Netzwerk)       |\n    +-------------------------------------------------+\n</code></pre> <p>When you SSH to a device using 192.168.100.x, you are accessing it through the management layer, not through the lab topology. This mirrors how real industrial networks use separate management networks.</p>"},{"location":"lab.html#sps-weboberflachen","title":"SPS-Weboberfl\u00e4chen","text":"<p>Eine vollst\u00e4ndige Liste der SPS-Weboberfl\u00e4chen und deren URLs finden Sie im Spickzettel.</p>"},{"location":"lab.html#sps-weboberflachen-in-codespaces-aufrufen","title":"SPS-Weboberfl\u00e4chen in Codespaces aufrufen","text":"<p>In GitHub Codespaces sind alle SPS-Weboberfl\u00e4chen \u00fcber den integrierten Chromium HMI WebVNC-Browser zug\u00e4nglich:</p> <ol> <li>\u00d6ffnen Sie das Ports-Panel in VS Code (unteres Panel)</li> <li>Suchen Sie den HMI WeChromium bVNC (5800)-Port</li> <li>Rechtsklick und Open in Browser w\u00e4hlen</li> <li>Ein Browserfenster \u00f6ffnet sich mit der Labordokumentation</li> <li>Klicken Sie auf einen SPS-Link in der Dokumentation, um die Weboberfl\u00e4che zu \u00f6ffnen</li> </ol> <p>Dieser Ansatz erm\u00f6glicht Zugriff auf alle SPS-Weboberfl\u00e4chen ohne individuelles Port-Forwarding. Der Browser l\u00e4uft innerhalb des Labornetzwerks mit direktem Zugriff auf alle Ger\u00e4te.</p> <p>Alternativer direkter Port-Zugriff:</p> <p>Einzelne Ports k\u00f6nnen auch direkt \u00fcber Port-Forwarding aufgerufen werden:</p> <ul> <li>Port 8080 leitet zur ABB 800xA HMI-Schnittstelle weiter (10.40.0.11:8080)</li> <li>Klicken Sie auf das Globus-Symbol neben einem weitergeleiteten Port im Ports-Panel</li> <li>Weitergeleitete Ports sind standardm\u00e4ssig privat (GitHub-Authentifizierung erforderlich)</li> </ul>"},{"location":"lab.html#standard-anmeldedaten","title":"Standard-Anmeldedaten","text":"<p>Alle Laborger\u00e4te verwenden standardisierte Anmeldedaten:</p> <pre><code>Benutzername: admin\nPasswort: admin\n</code></pre>"},{"location":"lab.html#erste-5-minuten","title":"Erste 5 Minuten","text":"<ol> <li>SSH zum Jumphost: <code>ssh admin@192.168.100.52</code></li> <li>Ping zu einer SPS (VLAN 10): <code>ping 10.10.0.11</code></li> <li>Labor inspizieren: <code>clab inspect -t ot-sec-segmented.clab.yml</code></li> <li>Optional: SPS-Weboberfl\u00e4che \u00f6ffnen: <code>http://10.10.0.11:8080</code> (falls aktiviert)</li> <li>SSH-Zugriff zur SPS testen: <code>ssh admin@192.168.100.53</code></li> </ol>"},{"location":"lab.html#laborarchitektur","title":"Laborarchitektur","text":""},{"location":"lab.html#netzwerktopologie","title":"Netzwerktopologie","text":"<p>Das Labor implementiert eine Defense-in-Depth-Architektur mit folgenden Komponenten:</p>"},{"location":"lab.html#netzwerkgerate","title":"Netzwerkger\u00e4te","text":"Ger\u00e4t Rolle Funktion <code>gw-firewall</code> Gateway-Firewall IT/OT-Grenzschutz und Routing <code>sw-dist</code> Distribution-Switch Kernvermittlung des OT-Netzwerks <code>sw-acc1</code> Access-Switch 1 Zonenvermittlung f\u00fcr VLANs 10/20/30 <code>sw-acc2</code> Access-Switch 2 Zonenvermittlung f\u00fcr VLANs 10/40/50"},{"location":"lab.html#betriebstechnik-assets","title":"Betriebstechnik-Assets","text":"Ger\u00e4t Hersteller Standort Funktion <code>wago-plc2a-vlan10</code> WAGO VLAN 10 (Hygiene) SPS <code>wago-plc2b-vlan10</code> WAGO VLAN 10 (Hygiene) SPS <code>ctrlx-plc3-vlan20</code> Bosch Rexroth (ctrlX) VLAN 20 (Prozess) SPS <code>schneider-plc4-vlan30</code> Schneider Electric VLAN 30 (Entsorgung) SPS <code>abb-800xa-vlan40</code> ABB VLAN 40 (Leitstelle) HMI/Steuerung <code>dell-ews1-vlan50</code> Dell Engineering Workstation VLAN 50 (Parametrierung) EWS <code>hirschmann-edge1-vlan50</code> Hirschmann Edge Gateway VLAN 50 (Parametrierung) Edge-Gateway"},{"location":"lab.html#unterstutzungsinfrastruktur","title":"Unterst\u00fctzungsinfrastruktur","text":"Ger\u00e4t Funktion <code>proxmox-jumphost</code> Fernzugriffs-Gateway in DMZ <code>panasonic-toughbook-internet</code> Externe Konnektivit\u00e4tssimulation"},{"location":"lab.html#sicherheitszonen-und-segmentierung","title":"Sicherheitszonen und Segmentierung","text":"<p>Das Labor implementiert IEC 62443-basierte Sicherheitszonen mit definierten Security Levels (SL):</p> Zone Funktion Typische Assets SL Begr\u00fcndung OT-DMZ Demilitarisierte Zone zwischen IT und OT Jumphosts, Patch-Server, Update-Proxies, Historians, Fernzugriffs-Gateways 2 Schutz vor absichtlichem Missbrauch; verbindet SL 1 (IT) und SL 3 (OT-Kern) OT-Operations: Hygiene Sanit\u00e4r- und Hilfssysteme SPSen, Ventile, Sensoren (VLAN 10) 3 Sicherheits- oder Compliance-relevant; erfordert h\u00f6here Absicherung OT-Operations: Prozess Kernproduktionssteuerung Haupt-SPSen, Sensoren, Aktoren (VLAN 20) 2 Kernprozesssteuerung; Schutz gegen qualifizierte Angreifer OT-Engineering: Netzwerkmanagement Infrastrukturmanagement Managementserver, SNMP, Backup-Systeme 3 Sensible Infrastruktur; starke Authentifizierung erforderlich OT-Engineering: Parametrierung Engineering und Programmierung Engineering-Workstations, Codesys, Laptops 2 Eingeschr\u00e4nkter Zugriff; Fokus auf Integrit\u00e4t und kontrollierte Verbindungen <p>Hinweis: Security Level (SL) gem\u00e4ss IEC 62443-Standard</p>"},{"location":"lab.html#autorisierte-datenflusse","title":"Autorisierte Datenfl\u00fcsse","text":"<p>Das Labor implementiert kontrollierte Kommunikationspfade zwischen Zonen:</p> Von Nach Zweck Internet (IT) OT-DMZ (Jumphost) Fernzugriff f\u00fcr Ingenieure OT-DMZ (Jumphost) OT-Operations (Prozess/Steuerung) Engineering-Zugriff zu SPSen OT-DMZ (Jumphost) OT-Engineering (Netzwerkmanagement) Netzwerkger\u00e4temanagement OT-Engineering (Param) OT-Operations (Prozess) SPS-Programmierung und Updates OT-Operations (Prozess) OT-Operations (Hygiene) Inter-Prozess-Kommunikation"},{"location":"lab.html#laborkomponenten","title":"Laborkomponenten","text":""},{"location":"lab.html#sps-container","title":"SPS-Container","text":"<p>Jede SPS im Labor l\u00e4uft mit CODESYS-Runtime und simuliert eine echte Industriesteuerung.</p>"},{"location":"lab.html#sps-fahigkeiten","title":"SPS-F\u00e4higkeiten","text":"<p>Alle SPSen sind containerisierte Ubuntu-Systeme mit:</p> <ul> <li>CODESYS Control Linux SL (IEC 61131-3-konforme SoftSPS mit Soft-Echtzeiteigenschaften)</li> <li>Modbus TCP, PROFINET, EtherNET/IP und OPC-UA-Unterst\u00fctzung</li> <li>Webbasiertes HMI (Port 8080)</li> <li>SSH-Zugriff f\u00fcr Konfiguration</li> <li>Simulierte I/O und Prozessdaten</li> </ul>"},{"location":"lab.html#netzwerkkonfiguration","title":"Netzwerkkonfiguration","text":"Netzwerk Subnetz VLAN Zweck Hygiene (VLAN 10) <code>10.10.0.0/24</code> 10 Sanit\u00e4rsysteme Prozess (VLAN 20) <code>10.20.0.0/24</code> 20 Kernproduktionssteuerung Entsorgung (VLAN 30) <code>10.30.0.0/24</code> 30 Abfallentsorgungssysteme Leitstelle (VLAN 40) <code>10.40.0.0/24</code> 40 HMI- und Steuerungssysteme Parametrierung (VLAN 50) <code>10.50.0.0/24</code> 50 Engineering-Workstations"},{"location":"lab.html#netzwerkinfrastruktur","title":"Netzwerkinfrastruktur","text":"<p>Alle Netzwerkger\u00e4te laufen mit MikroTik RouterOS 7.18 in virtualisierten Containern.</p>"},{"location":"lab.html#geratefahigkeiten","title":"Ger\u00e4tef\u00e4higkeiten","text":"Funktion Beschreibung VLAN-Tagging Volle 802.1Q VLAN-Unterst\u00fctzung f\u00fcr Netzwerksegmentierung Port-Mirroring SPAN-Ports f\u00fcr nicht-intrusive Verkehrsmitschnitte Firewall Stateful Packet Filtering und Zugriffskontrolle Routing Inter-Zonen-Routing mit Policy-basierter Weiterleitung SNMP-\u00dcberwachung Netzwerkmanagement- und \u00dcberwachungsintegration MAC-Management MAC-Adresstabelle und Sicherheitsfunktionen"},{"location":"lab.html#strategische-uberwachungspunkte","title":"Strategische \u00dcberwachungspunkte","text":"Standort Sichtbarkeit Anwendungsfall Gateway-Firewall OT-Internet-Grenze Externe Bedrohungen, Fernzugriffs\u00fcberwachung Distribution-Switch Inter-Zonen-Verkehr Zonen-zu-Zonen-Kommunikationsmuster Access-Switches Zonen-interner Verkehr Ger\u00e4tekommunikation innerhalb von Zonen"},{"location":"lab.html#unterstutzungssysteme","title":"Unterst\u00fctzungssysteme","text":""},{"location":"lab.html#proxmox-jumphost","title":"proxmox-jumphost","text":"Funktion Beschreibung Rolle Fernzugriffs-Gateway in DMZ Werkzeuge Vorinstallierte Netzwerkwerkzeuge f\u00fcr \u00dcbungen Zugriff SSH von Ihrem Laptop; verwenden Sie dies f\u00fcr alle Befehle, sofern nicht anders angegeben"},{"location":"lab.html#netzwerkadressierung","title":"Netzwerkadressierung","text":""},{"location":"lab.html#management-netzwerk-192168100024","title":"Management-Netzwerk: 192.168.100.0/24","text":"<p>Alle Laborger\u00e4te sind \u00fcber das Management-Netzwerk zug\u00e4nglich.</p>"},{"location":"lab.html#netzwerkgerate_1","title":"Netzwerkger\u00e4te","text":"Ger\u00e4t Management-IP Container-Name Zugriff Gateway-Firewall <code>192.168.100.11</code> <code>clab-ot-sec-segmented-gw-firewall</code> SSH, Web Distribution-Switch <code>192.168.100.12</code> <code>clab-ot-sec-segmented-sw-dist</code> SSH, Web Access-Switch 1 <code>192.168.100.13</code> <code>clab-ot-sec-segmented-sw-acc1</code> SSH, Web Access-Switch 2 <code>192.168.100.14</code> <code>clab-ot-sec-segmented-sw-acc2</code> SSH, Web"},{"location":"lab.html#host-systeme","title":"Host-Systeme","text":"Ger\u00e4t Management-IP Container-Name Zugriff Internet <code>192.168.100.51</code> <code>clab-ot-sec-segmented-panasonic-toughbook-internet</code> SSH Jumphost <code>192.168.100.52</code> <code>clab-ot-sec-segmented-proxmox-jumphost</code> SSH wago-plc2a-vlan10 <code>192.168.100.53</code> <code>clab-ot-sec-segmented-wago-plc2a-vlan10</code> SSH, Web wago-plc2b-vlan10 <code>192.168.100.54</code> <code>clab-ot-sec-segmented-wago-plc2b-vlan10</code> SSH, Web ctrlx-plc3-vlan20 <code>192.168.100.55</code> <code>clab-ot-sec-segmented-ctrlx-plc3-vlan20</code> SSH, Web schneider-plc4-vlan30 <code>192.168.100.56</code> <code>clab-ot-sec-segmented-schneider-plc4-vlan30</code> SSH, Web abb-800xa-vlan40 <code>192.168.100.57</code> <code>clab-ot-sec-segmented-abb-800xa-vlan40</code> SSH, Web dell-ews1-vlan50 <code>192.168.100.58</code> <code>clab-ot-sec-segmented-dell-ews1-vlan50</code> SSH hirschmann-edge1-vlan50 <code>192.168.100.59</code> <code>clab-ot-sec-segmented-hirschmann-edge1-vlan50</code> Edge-Gateway"},{"location":"lab.html#vlan-10-hygiene-netzwerk-10100024","title":"VLAN 10 - Hygiene-Netzwerk: 10.10.0.0/24","text":"Ger\u00e4t IP-Adresse Funktion Gateway <code>10.10.0.1</code> Standard-Gateway (gw-firewall) wago-plc2a-vlan10 <code>10.10.0.11</code> Hygiene-SPS wago-plc2b-vlan10 <code>10.10.0.12</code> Hygiene-SPS"},{"location":"lab.html#vlan-20-prozess-netzwerk-10200024","title":"VLAN 20 - Prozess-Netzwerk: 10.20.0.0/24","text":"Ger\u00e4t IP-Adresse Funktion Gateway <code>10.20.0.1</code> Standard-Gateway (gw-firewall) ctrlx-plc3-vlan20 <code>10.20.0.11</code> Prozess-SPS"},{"location":"lab.html#vlan-30-entsorgungs-netzwerk-10300024","title":"VLAN 30 - Entsorgungs-Netzwerk: 10.30.0.0/24","text":"Ger\u00e4t IP-Adresse Funktion Gateway <code>10.30.0.1</code> Standard-Gateway (gw-firewall) schneider-plc4-vlan30 <code>10.30.0.11</code> Entsorgungs-SPS"},{"location":"lab.html#vlan-40-leitstellen-netzwerk-10400024","title":"VLAN 40 - Leitstellen-Netzwerk: 10.40.0.0/24","text":"Ger\u00e4t IP-Adresse Funktion Gateway <code>10.40.0.1</code> Standard-Gateway (gw-firewall) abb-800xa-vlan40 <code>10.40.0.11</code> HMI/Steuerungssystem"},{"location":"lab.html#vlan-50-parametrierungs-netzwerk-10500024","title":"VLAN 50 - Parametrierungs-Netzwerk: 10.50.0.0/24","text":"Ger\u00e4t IP-Adresse Funktion Gateway <code>10.50.0.1</code> Standard-Gateway (gw-firewall) dell-ews1-vlan50 <code>10.50.0.11</code> Engineering-Workstation hirschmann-edge1-vlan50 <code>10.50.0.12</code> Edge-Gateway"},{"location":"lab.html#dmz-netzwerk-222024","title":"DMZ-Netzwerk: 2.2.2.0/24","text":"Ger\u00e4t IP-Adresse Funktion Gateway <code>2.2.2.1</code> Firewall-DMZ-Schnittstelle proxmox-jumphost <code>2.2.2.2</code> Fernzugriffs-Gateway"},{"location":"lab.html#internet-simulation-111024","title":"Internet-Simulation: 1.1.1.0/24","text":"Ger\u00e4t IP-Adresse Funktion panasonic-toughbook-internet <code>1.1.1.1</code> Externes Netzwerksimulation Firewall External <code>1.1.1.2</code> Firewall-WAN-Schnittstelle"},{"location":"lab.html#laborzugriff","title":"Laborzugriff","text":""},{"location":"lab.html#verbindungsmethoden","title":"Verbindungsmethoden","text":""},{"location":"lab.html#zugriff-uber-vs-code-containerlab-erweiterung","title":"Zugriff \u00fcber VS Code Containerlab-Erweiterung","text":"<p>Das Labor beinhaltet VS Code-Integration f\u00fcr einfachen Ger\u00e4tezugriff:</p> <ol> <li>Rechtsklick auf Ger\u00e4t in Containerlab-Erweiterung</li> <li>SSH-Verbindung ausw\u00e4hlen</li> <li>Oder Topology Viewer verwenden: Klick auf Ger\u00e4t, dann Aktion \u2192 SSH</li> </ol>"},{"location":"lab.html#verfugbare-werkzeuge","title":"Verf\u00fcgbare Werkzeuge","text":""},{"location":"lab.html#netzwerkanalyse-werkzeuge","title":"Netzwerkanalyse-Werkzeuge","text":"Werkzeug Zweck Verwendungsbeispiel <code>ping</code> Netzwerkkonnektivit\u00e4t testen <code>ping 10.10.0.11</code> <code>nmap</code> Netzwerk- und Port-Scanning <code>nmap -sV 10.10.0.0/24</code> <code>tcpdump</code> Kommandozeilen-Paketmitschnitt <code>tcpdump -i eth0 -w capture.pcap</code> <code>arp</code> ARP-Tabelle anzeigen <code>arp -a</code> <code>nc</code> TCP/UDP Client/Server <code>nc -l 5000</code> <code>ssh</code> Remote-Login <code>ssh admin@192.168.100.53</code>"},{"location":"lab.html#dsniff-suite","title":"Dsniff-Suite","text":"<p>Dsniff bietet Werkzeuge f\u00fcr Netzwerk-Auditing und Penetrationstests.</p> Werkzeug Zweck Beispiel <code>dsniff</code> Klartext-Anmeldedaten erfassen (FTP, HTTP, SMTP) <code>dsniff -i eth0</code> <code>filesnarf</code> Dateien aus Netzwerkverkehr extrahieren <code>filesnarf -i eth0</code> <code>mailsnarf</code> E-Mail-Nachrichten rekonstruieren <code>mailsnarf -i eth0</code> <code>urlsnarf</code> Alle HTTP-URLs protokollieren <code>urlsnarf -i eth0</code> <code>arpspoof</code> ARP-Spoofing f\u00fcr MITM-Angriffe <code>arpspoof -i eth0 -t 10.10.0.11 10.10.0.1</code> <code>dnsspoof</code> DNS-Hijacking <code>dnsspoof -i eth0 -f hosts.txt</code> <code>macof</code> Switch-CAM-Tabelle fluten <code>macof -i eth0</code> <code>tcpkill</code> TCP-Verbindungen beenden <code>tcpkill -i eth0 host 10.10.0.11</code> <code>tcpnice</code> TCP-Verbindungen verlangsamen <code>tcpnice -i eth0 host 10.10.0.11</code> <p>Wichtig: IP-Forwarding f\u00fcr MITM-Angriffe aktivieren: <pre><code>echo 1 &gt; /proc/sys/net/ipv4/ip_forward\n</code></pre></p>"},{"location":"lab.html#workshop-laborubungen","title":"Workshop-Labor\u00fcbungen","text":"<p>W\u00e4hrend des Workshops arbeiten Sie progressive praktische \u00dcbungen durch.</p>"},{"location":"lab.html#teil-1-ot-netzwerke-verstehen","title":"Teil 1: OT-Netzwerke verstehen","text":"<p>Ziele: - OT-Protokolle im Einsatz entdecken (Modbus TCP, propriet\u00e4re Protokolle) - Kommunikationsmuster zwischen SPSen und Systemen identifizieren - Open-Source-\u00dcberwachungswerkzeuge gegen Live-Verkehr testen - Protokollcharakteristiken und Sicherheitsimplikationen analysieren</p>"},{"location":"lab.html#ubung-11-laboreinfuhrung","title":"\u00dcbung 1.1: Laboreinf\u00fchrung","text":"<p>Empfohlener Ansatz:</p> <ol> <li>Laborumgebung starten</li> <li>Topology Viewer \u00f6ffnen</li> <li>Bei verschiedenen Systemen anmelden (gw-firewall, panasonic-toughbook-internet, proxmox-jumphost)</li> <li>Konnektivit\u00e4t mit Ping zu verschiedenen Zonen testen</li> </ol>"},{"location":"lab.html#ubung-12-vlan-entdeckung","title":"\u00dcbung 1.2: VLAN-Entdeckung","text":"<p>Empfohlener Ansatz:</p> <ol> <li>Wireshark auf einem Link zwischen zwei Switches verwenden</li> <li>Welche VLANs sehen Sie?</li> <li>Verkehr von ctrlx-plc3-vlan20 zu seinem Switch mitschneiden</li> <li>Welche VLANs sind sichtbar?</li> <li>Was ist der Unterschied zwischen Trunk- und Access-Ports?</li> </ol>"},{"location":"lab.html#teil-2-ot-netzwerk-sicherheitsuberwachung","title":"Teil 2: OT-Netzwerk-Sicherheits\u00fcberwachung","text":"<p>Ziele: - \u00dcberwachung an strategischen Punkten einsetzen (Gateway, Inter-Zone, Edge) - Verkehrssammlung und -weiterleitung konfigurieren - Sichtbarkeit \u00fcber Zonen hinweg validieren - \u00dcberwachungseffektivit\u00e4t testen und blinde Flecken identifizieren</p>"},{"location":"lab.html#ubung-21-fernzugriffsanalyse","title":"\u00dcbung 2.1: Fernzugriffsanalyse","text":"<p>Empfohlener Ansatz:</p> <ol> <li>SSH zum Jumphost</li> <li>Erkunden: Was k\u00f6nnen Sie im Labor erreichen?</li> <li><code>nmap</code> verwenden, um die Firewall zu scannen</li> <li>Welche offenen Ports entdecken Sie?</li> <li>Welche Dienste sind exponiert?</li> </ol> <p>Fortgeschritten:</p> <ol> <li>Initiale Firewall-Regeln auf gw-firewall konfigurieren, um Jumphost-Zugriff zu beschr\u00e4nken</li> <li>Frage: Welche Schutzmechanismen f\u00fcr Fernzugriff w\u00e4ren effektiver als statische Firewall-Regeln?</li> </ol>"},{"location":"lab.html#ubung-22-mikrosegmentierung","title":"\u00dcbung 2.2: Mikrosegmentierung","text":"<p>Empfohlener Ansatz:</p> <ol> <li>Untersuchen Sie, wie Mikrosegmentierung f\u00fcr <code>wago-plc2a-vlan10</code> funktioniert</li> <li>Entwerfen Sie Firewall-Regeln, die erforderlich sind, um <code>wago-plc2a-vlan10</code> von aussen zug\u00e4nglich zu machen, w\u00e4hrend die Exposition begrenzt wird</li> </ol> <p>Fortgeschritten:</p> <ol> <li>Switch-Port-ACLs auf dem mit wago-plc2b-vlan10 verbundenen Port implementieren</li> <li>Fragen:</li> <li>Was sind die Charakteristiken von Switch-ACLs?</li> <li>Bieten sie denselben Schutz wie Stateful Packet Filter?</li> <li>Wann w\u00fcrden Sie ACLs vs. Firewall-Regeln verwenden?</li> </ol>"},{"location":"lab.html#teil-3-einstieg-in-die-uberwachung","title":"Teil 3: Einstieg in die \u00dcberwachung","text":"<p>Ziele: - \u00dcberwachungs-Use-Cases f\u00fcr erkannte Bedrohungen definieren - Erkennungsregeln f\u00fcr Anomalien konfigurieren - Alarmierung f\u00fcr Sicherheitsereignisse einrichten - Reaktions-Playbooks erstellen - Erkennung zur Reduzierung von Fehlalarmen abstimmen</p>"},{"location":"lab.html#ubung-31-firewall-regeldesign","title":"\u00dcbung 3.1: Firewall-Regeldesign","text":"<p>Empfohlener Ansatz:</p> <ol> <li>Sicherheitskonzept f\u00fcr das Labor entwerfen (zun\u00e4chst theoretisch):</li> <li>Kommunikationsmatrix erstellen</li> <li>Konkretes Firewall-Regelwerk definieren</li> <li> <p>Regelzwecke und Verantwortliche dokumentieren</p> </li> <li> <p>\u00dcberlegen: Welchen zus\u00e4tzlichen Wert w\u00fcrde eine Next-Generation-Firewall bieten?</p> </li> <li> <p>IDS-Platzierung und -Funktionalit\u00e4t planen</p> </li> </ol> <p>Fortgeschritten:</p> <ol> <li>Einfaches Firewall-Regel-Management-Tool entwerfen und implementieren</li> <li>Wie k\u00f6nnen Regeln nach einem Jahr leicht revalidiert werden?</li> <li>Wer ist f\u00fcr jede Regel verantwortlich?</li> <li>Was ist der Zweck jeder Regel?</li> <li>Regeln mit Tickets/\u00c4nderungsanfragen verkn\u00fcpfen</li> <li> <p>Regelerstellungsdatum und \u00dcberpr\u00fcfungsplan verfolgen</p> </li> <li> <p>Firewall-Regeln implementieren und testen</p> </li> </ol>"},{"location":"lab.html#fehlersuche-und-verifikation","title":"Fehlersuche und Verifikation","text":""},{"location":"lab.html#labor-gesundheitscheck-skript","title":"Labor-Gesundheitscheck-Skript","text":"<p>Das Labor beinhaltet ein umfassendes Gesundheitscheck-Skript, das verifiziert, dass alle Komponenten korrekt laufen.</p> <p>Wann zu verwenden:</p> <ul> <li>Nach der ersten Bereitstellung des Labors</li> <li>Bei Problemen zur Identifikation der Ursache</li> <li>Vor \u00dcbungsbeginn zur Sicherstellung der Betriebsbereitschaft</li> <li>Nach Konfigurations\u00e4nderungen</li> </ul> <p>Gesundheitscheck ausf\u00fchren:</p> <pre><code>./scripts/lab-test.py ot-sec-segmented\n# oder f\u00fcr flache Topologie\n./scripts/lab-test.py ot-sec-flat\n</code></pre> <p>Was es pr\u00fcft:</p> <p>Das Skript verifiziert alle kritischen Laborkomponenten in organisierten Kategorien:</p> <ul> <li>Infrastruktur - Containerlab-Bereitstellung, alle Container laufen</li> <li>Netzwerkger\u00e4te - MikroTik-Switches und Gateway-Reaktionsf\u00e4higkeit</li> <li>SPS-Laufzeiten - CODESYS-Prozesse und Programmausf\u00fchrungszustand</li> <li>Host-Ports - Exponierte Dienste (8080, 5800, 1218) mit Quell-Containern</li> <li>Container-Ports - HTTP-Dienste auf allen Ger\u00e4ten</li> <li>Konnektivit\u00e4t - Netzwerkerreichbarkeit vom Jumphost, Inter-Node-Kommunikation, Gateway-Zugriff</li> <li>Speicher - Erforderliche Bind-Mounts f\u00fcr SPS-Konfigurationen</li> </ul> <p>Ergebnisse verstehen:</p> <ul> <li>PASS - Komponente funktioniert korrekt</li> <li>FAIL - Kritisches Problem erfordert Aufmerksamkeit</li> <li>WARN - Nicht-kritisches Problem (wird f\u00fcr optionale Komponenten nicht mehr angezeigt)</li> </ul> <p>H\u00e4ufige Probleme:</p> <p>Container laufen nicht:</p> <pre><code>clab inspect -t ot-sec-segmented.clab.yml\ndocker ps -a | grep clab-ot-sec\n</code></pre> <p>Konnektivit\u00e4tstests schlagen fehl - Netzwerkger\u00e4testatus pr\u00fcfen:</p> <pre><code>ssh admin@192.168.100.11  # Gateway\nssh admin@192.168.100.12  # Distribution-Switch\n</code></pre> <p>SPS-Laufzeiten schlagen fehl - Prozessstatus im Container pr\u00fcfen:</p> <pre><code>docker exec clab-ot-sec-segmented-wago-plc2a-vlan10 pgrep -f codesyscontrol\n</code></pre>"},{"location":"lab.html#erweiterungsideen","title":"Erweiterungsideen","text":"<ol> <li>Erweiterte \u00dcberwachung</li> <li>Zeek f\u00fcr Protokollanalyse einsetzen</li> <li>Suricata IDS mit benutzerdefinierten Regeln einrichten</li> <li> <p>ELK-Stack f\u00fcr Log-Aggregation integrieren</p> </li> <li> <p>Sicherheitstests</p> </li> <li>Firewall-Regelwerke implementieren</li> <li>Netzwerksegmentierungseffektivit\u00e4t testen</li> <li> <p>Angriffsszenarien simulieren</p> </li> <li> <p>Protokollanalyse</p> </li> <li>Zus\u00e4tzliche OT-Protokolle analysieren</li> <li>Benutzerdefinierte Wireshark-Dissektoren erstellen</li> <li> <p>Protokollverhalten dokumentieren</p> </li> <li> <p>Automatisierung</p> </li> <li>Bereitstellungsprozesse skripten</li> <li>Konfigurationsbackups automatisieren</li> <li>Test-Frameworks erstellen</li> </ol>"},{"location":"slides.html","title":"Workshop-Folien","text":""},{"location":"slides.html#haupt-workshop-prasentation","title":"Haupt-Workshop-Pr\u00e4sentation","text":"<p>Laden Sie die Pr\u00e4sentationsfolien f\u00fcr diesen Workshop herunter:</p> <p>Workshop-Folien herunterladen (PDF)</p> <p>Copenhagen 2025: Unfold the OT Network Jungle Pr\u00e4sentiert von Mischa Diehm und Martin Scheu</p> <p>Inhalt:</p> <ul> <li>Einf\u00fchrung in OT-Netzwerke</li> <li>Grundlagen des Network Security Monitoring</li> <li>Praktisches Labor - \u00dcbersicht</li> <li>Containerlab und Netzwerksimulation</li> <li>Best Practices und wichtigste Erkenntnisse</li> </ul>"},{"location":"slides.html#referenzmaterial","title":"Referenzmaterial","text":"<p>F\u00fcr zus\u00e4tzlichen Kontext zum Containerlab-Ansatz und Digital-Twin-Konzepten:</p> <p>Referenz herunterladen: Digital Twin mit Containerlab (PDF)</p> <p>Diese Referenzpr\u00e4sentation bietet tiefere Einblicke:</p> <ul> <li>Aufbau von Netzwerk-Digital-Twins mit Containerlab</li> <li>Laborumgebungsarchitektur</li> <li>Fortgeschrittene Simulationstechniken</li> <li>Praxisanwendungen</li> </ul>"},{"location":"exercises/index.html","title":"OT Security Lab \u00dcbungen","text":""},{"location":"exercises/index.html#uberblick","title":"\u00dcberblick","text":"<p>Diese praxisorientierten \u00dcbungen bieten praktische Erfahrung mit OT-Netzwerksicherheitskonzepten. Jede \u00dcbung konzentriert sich auf grundlegende Netzwerksicherheitsprinzipien, die h\u00e4ufig in Umgebungen mit industriellen Steuerungssystemen anzutreffen sind.</p> <p>Gesamtdauer: 3-4 Stunden f\u00fcr alle \u00dcbungen</p> <p>Lab-Anforderungen: Sie ben\u00f6tigen eine laufende Lab-Umgebung (GitHub Codespaces oder DevPod). Siehe die Seite Lab-Umgebung f\u00fcr Installationsanweisungen.</p> <p>\u00dcbungsansatz: Die \u00dcbungen sind unabh\u00e4ngig und k\u00f6nnen in beliebiger Reihenfolge durchgef\u00fchrt werden, wobei die Reihenfolge eine logische Progression der Konzepte bietet.</p>"},{"location":"exercises/index.html#voraussetzungen","title":"Voraussetzungen","text":""},{"location":"exercises/index.html#erforderliches-wissen","title":"Erforderliches Wissen","text":"<ul> <li>Grundlegende Linux-Kommandozeile</li> <li>Netzwerkgrundlagen (IP-Adressierung, VLANs, Routing)</li> <li>SSH-Grundlagen</li> <li>Wireshark-Grundlagen</li> </ul>"},{"location":"exercises/index.html#lab-zugang","title":"Lab-Zugang","text":"<p>Stellen Sie vor dem Start sicher, dass Sie:</p> <ol> <li>Auf Ihre Lab-Umgebung zugreifen k\u00f6nnen (Codespaces oder DevPod)</li> <li>Eine Lab-Topologie mit der Containerlab-Erweiterung bereitstellen k\u00f6nnen</li> <li>Per SSH auf Lab-Ger\u00e4te zugreifen k\u00f6nnen</li> <li>Datenverkehr mit Wireshark \u00fcber Edgeshark erfassen k\u00f6nnen</li> </ol>"},{"location":"exercises/index.html#topologie-auswahl","title":"Topologie-Auswahl","text":"<p>Diese \u00dcbungen verwenden zwei Lab-Topologien:</p> <ul> <li><code>ot-sec-flat.clab.yml</code> - Flaches Netzwerk mit VLANs, aber minimaler Segmentierung</li> <li><code>ot-sec-segmented.clab.yml</code> - Segmentiertes Netzwerk mit Firewall-Regeln</li> </ul> <p>Jede \u00dcbung gibt an, welche Topologie verwendet werden soll.</p>"},{"location":"exercises/index.html#ubungsliste","title":"\u00dcbungsliste","text":"Nr. \u00dcbung Zeit Topologie Schwierigkeit Link 1 VLAN-Erkennung 20-30 Min. Beide Anf\u00e4nger Start  2 ARP-Spoofing-Angriff 30-40 Min. Beide (flat einfacher) Fortgeschritten Start  3 Spanning-Tree-Analyse 25-35 Min. Beide Fortgeschritten Start  4 Link-Aggregation 20-30 Min. Nur segmentiert Fortgeschritten Start  5 Fernzugriff-Bewertung 35-45 Min. Beide Fortgeschritten Start  6 OT-Protokoll-Erkennung 45-50 Min. Beide (flat einfacher) Fortgeschritten Start  7 Segmentierung &amp; Firewall-Design 35-45 Min. Segmentiert (prim\u00e4r) Fortgeschritten/Experte Start"},{"location":"exercises/index.html#zusatzliche-ressourcen","title":"Zus\u00e4tzliche Ressourcen","text":"<ul> <li>Anhang: Wireshark-Filter</li> <li>Troubleshooting-Leitfaden</li> <li>Externe Ressourcen</li> </ul>"},{"location":"exercises/appendix.html","title":"Anhang: Referenzmaterialien","text":""},{"location":"exercises/appendix.html#wireshark-filter-kurzreferenz","title":"Wireshark-Filter-Kurzreferenz","text":""},{"location":"exercises/appendix.html#vlan-analyse","title":"VLAN-Analyse","text":"<pre><code>vlan                          # Alle 802.1Q-getaggten Frames\nvlan.id == 10                 # Nur VLAN 10-Verkehr\nvlan.id in {10 20 30}        # Mehrere VLANs\n</code></pre>"},{"location":"exercises/appendix.html#arp-analyse","title":"ARP-Analyse","text":"<pre><code>arp                           # Gesamter ARP-Verkehr\narp.opcode == 1               # Nur ARP-Requests\narp.opcode == 2               # Nur ARP-Replies\narp.duplicate-address-detected  # ARP-Konflikte\n</code></pre>"},{"location":"exercises/appendix.html#stprstp","title":"STP/RSTP","text":"<pre><code>stp                           # Gesamter Spanning-Tree-Verkehr\nrstp                          # Nur Rapid Spanning Tree\neth.dst == 01:80:c2:00:00:00  # STP-Multicast-Adresse\n</code></pre>"},{"location":"exercises/appendix.html#protokoll-spezifisch","title":"Protokoll-spezifisch","text":"<pre><code>icmp                          # ICMP (Ping) Verkehr\ntcp.port == 502               # Modbus TCP\ntcp.port == 2455              # CODESYS\ntcp.port == 8080              # Web-Interfaces\n</code></pre>"},{"location":"exercises/appendix.html#filter-kombinieren","title":"Filter kombinieren","text":"<pre><code>vlan.id == 10 &amp;&amp; icmp         # VLAN 10 ICMP-Verkehr\ntcp &amp;&amp; !tcp.port == 22        # Gesamter TCP ausser SSH\nip.src == 10.10.0.11 || ip.dst == 10.10.0.11  # Spezifischer Host\n</code></pre>"},{"location":"exercises/appendix.html#troubleshooting-haufige-probleme","title":"Troubleshooting: H\u00e4ufige Probleme","text":""},{"location":"exercises/appendix.html#lab-startet-nicht","title":"Lab startet nicht","text":"<p>Symptom: Container starten nicht oder bleiben unhealthy</p> <p>L\u00f6sungen:</p> <ol> <li>Container-Status pr\u00fcfen: <code>docker ps -a | grep clab</code></li> <li>Container-Logs anzeigen: <code>docker logs &lt;container-name&gt;</code></li> <li>Images \u00fcberpr\u00fcfen: <code>docker images | grep narrowin</code></li> <li>Health-Check ausf\u00fchren: <code>scripts/lab-test.py ot-sec-flat</code></li> </ol>"},{"location":"exercises/appendix.html#ssh-zu-geraten-nicht-moglich","title":"SSH zu Ger\u00e4ten nicht m\u00f6glich","text":"<p>Symptom: Connection refused oder Timeout</p> <p>L\u00f6sungen:</p> <ol> <li>\u00dcberpr\u00fcfen, dass Management-IP (192.168.100.x) verwendet wird, nicht Datenebenen-IP</li> <li>2-3 Minuten nach Lab-Bereitstellung warten, bis SSH startet</li> <li>\u00dcberpr\u00fcfen, dass Container l\u00e4uft: <code>docker ps | grep &lt;device-name&gt;</code></li> <li>Von VS Code-Terminal testen, nicht von externem System</li> </ol>"},{"location":"exercises/appendix.html#wireshark-offnet-sich-nicht","title":"Wireshark \u00f6ffnet sich nicht","text":"<p>Symptom: Edgeshark startet nicht</p> <p>L\u00f6sungen:</p> <ol> <li>VS Code-Eingabeaufforderung zum \u00d6ffnen mit Edgeshark akzeptieren</li> <li>Schliessen und Capture erneut versuchen</li> <li>\u00dcberpr\u00fcfen, dass Edgeshark-Erweiterung installiert ist</li> <li>Container-Logs auf Fehler pr\u00fcfen</li> </ol>"},{"location":"exercises/appendix.html#kein-verkehr-in-captures","title":"Kein Verkehr in Captures","text":"<p>Symptom: Wireshark zeigt keine Pakete</p> <p>L\u00f6sungen:</p> <ol> <li>\u00dcberpr\u00fcfen, dass Capture vor Verkehrsgenerierung gestartet wurde</li> <li>\u00dcberpr\u00fcfen, dass auf korrektem Interface/Link erfasst wird</li> <li>Display-Filter vor\u00fcbergehend entfernen</li> <li>\u00dcberpr\u00fcfen, dass Ger\u00e4te tats\u00e4chlich kommunizieren k\u00f6nnen (Ping-Test)</li> </ol>"},{"location":"exercises/appendix.html#ping-fehler","title":"Ping-Fehler","text":"<p>Symptom: Destination unreachable</p> <p>L\u00f6sungen:</p> <ol> <li>Routing pr\u00fcfen: <code>ip route show</code></li> <li>VLAN-Zuweisung \u00fcberpr\u00fcfen</li> <li>In segmentierter Topologie pr\u00fcfen, ob Firewall Verkehr blockiert</li> <li>Best\u00e4tigen, dass beide Ger\u00e4te im selben VLAN oder mit korrektem Routing konfiguriert sind</li> </ol>"},{"location":"exercises/appendix.html#zusatzliche-ressourcen","title":"Zus\u00e4tzliche Ressourcen","text":""},{"location":"exercises/appendix.html#dokumentation","title":"Dokumentation","text":"<ul> <li>Containerlab-Dokumentation - Netzwerk-Lab-Automatisierung</li> <li>MikroTik RouterOS Manual - Switch-Konfigurationsreferenz</li> <li>Wireshark User Guide - Paketanalyse</li> <li>CODESYS-Dokumentation - SPS-Programmierung</li> </ul>"},{"location":"exercises/appendix.html#standards-und-best-practices","title":"Standards und Best Practices","text":"<ul> <li>IEC 62443 Standards - Industrielles Cybersicherheits-Framework</li> <li>NIST Cybersecurity Framework - Sicherheits-Best-Practices</li> </ul>"},{"location":"exercises/appendix.html#tools","title":"Tools","text":"<ul> <li>nmap - Netzwerkerkennung und Sicherheitspr\u00fcfung</li> <li>tcpdump - Kommandozeilen-Paketanalyse</li> <li>Edgeshark - Container-Netzwerkverkehrserfassung</li> </ul>"},{"location":"exercises/appendix.html#erweiterte-themen-und-erweiterungen","title":"Erweiterte Themen und Erweiterungen","text":"<p>Diese Themen werden in den urspr\u00fcnglichen Workshop-Zielen erw\u00e4hnt, gelten aber als erweitert oder erfordern zus\u00e4tzliche Infrastruktur, die derzeit nicht in der Standard-Lab-Umgebung vorhanden ist.</p>"},{"location":"exercises/appendix.html#idsips-bereitstellung","title":"IDS/IPS-Bereitstellung","text":"<ul> <li>Zeek: Zeek f\u00fcr tiefe Protokollanalyse und Logging bereitstellen.</li> <li>Suricata: Suricata IDS mit benutzerdefinierten Regeln f\u00fcr OT-Protokolle einrichten.</li> </ul>"},{"location":"exercises/appendix.html#erweiterte-uberwachung","title":"Erweiterte \u00dcberwachung","text":"<ul> <li>ELK Stack: Elasticsearch, Logstash und Kibana f\u00fcr zentrales Log-Management integrieren.</li> <li>SIEM: Konzepte zur Integration von OT-Logs in ein Security Information and Event Management System.</li> </ul>"},{"location":"exercises/appendix.html#betriebssicherheit","title":"Betriebssicherheit","text":"<ul> <li>Erkennungsregeln: Spezifische Erkennungsregeln f\u00fcr Anomalien konfigurieren (z.B. \"Neues Ger\u00e4t erkannt\", \"SPS-Stopp-Befehl\").</li> <li>Alarmierung: E-Mail- oder Webhook-Alarme f\u00fcr Sicherheitsereignisse einrichten.</li> <li>Playbooks: Response-Playbooks f\u00fcr erkannte Vorf\u00e4lle erstellen.</li> <li>Tuning: Methodologien zur Reduzierung von False Positives in Erkennungsregeln.</li> <li>Firewall-Management: Tools und Prozesse zur Verwaltung komplexer Firewall-Regelwerke im Laufe der Zeit.</li> </ul> <p>Dokumentversion: 1.0 Letztes Update: 2025-11-19 Lab-Kompatibilit\u00e4t: ot-sec-flat v1.x, ot-sec-segmented v1.x</p>"},{"location":"exercises/ex1-vlan-discovery.html","title":"\u00dcbung 1: VLAN-Erkennung und Verkehrsanalyse","text":"<p>Zeitsch\u00e4tzung: 20-30 Minuten Lab-Topologie: <code>ot-sec-flat</code> oder <code>ot-sec-segmented</code> Schwierigkeit:  Anf\u00e4nger</p>"},{"location":"exercises/ex1-vlan-discovery.html#lernziele","title":"Lernziele","text":"<ul> <li>802.1Q-VLAN-Tagging auf Trunk-Ports verstehen</li> <li>Unterschied zwischen Trunk- und Access-Port-Verhalten erkennen</li> <li>VLAN-Isolation in Paket-Captures identifizieren</li> <li>Sicherheitsimplikationen von VLAN-Segmentierung verstehen</li> </ul>"},{"location":"exercises/ex1-vlan-discovery.html#voraussetzungen","title":"Voraussetzungen","text":"<ul> <li>Bereitgestelltes und laufendes Lab</li> <li>Grundlegende Wireshark-Kenntnisse</li> <li>Verst\u00e4ndnis des ping-Befehls</li> </ul>"},{"location":"exercises/ex1-vlan-discovery.html#szenario","title":"Szenario","text":"<p>Industrielle Netzwerke verwenden VLANs zur logischen Segmentierung verschiedener Betriebszonen. In diesem Lab trennen VLANs Hygienesysteme (VLAN 10), Prozesssteuerung (VLAN 20), Entsorgungssysteme (VLAN 30), Leitwarte (VLAN 40) und Engineering-Workstations (VLAN 50). Das Verst\u00e4ndnis, wie VLANs funktionieren und wie man sie im Datenverkehr identifiziert, ist f\u00fcr die OT-Sicherheits\u00fcberwachung unerl\u00e4sslich.</p>"},{"location":"exercises/ex1-vlan-discovery.html#aufgaben","title":"Aufgaben","text":""},{"location":"exercises/ex1-vlan-discovery.html#aufgabe-1-plc-konnektivitat-innerhalb-desselben-vlans-uberprufen","title":"Aufgabe 1: PLC-Konnektivit\u00e4t innerhalb desselben VLANs \u00fcberpr\u00fcfen","text":"<ol> <li>SSH-Verbindung zu <code>wago-plc2a-vlan10</code>:</li> </ol> <pre><code>ssh admin@192.168.100.53\n</code></pre> <p>Standard-Anmeldedaten</p> <p>Passwort: <code>admin</code></p> <ol> <li>Konnektivit\u00e4t zu einem anderen Ger\u00e4t in VLAN 10 testen:</li> </ol> <pre><code>ping -c 4 10.10.0.12\n</code></pre> <ol> <li>Konnektivit\u00e4t zu Ger\u00e4t in anderem VLAN testen:</li> </ol> <pre><code>ping -c 4 10.20.0.11\n</code></pre> <p>Frage: Sind beide Pings erfolgreich? Warum oder warum nicht?</p>"},{"location":"exercises/ex1-vlan-discovery.html#aufgabe-2-datenverkehr-auf-trunk-port-zwischen-switches-erfassen","title":"Aufgabe 2: Datenverkehr auf Trunk-Port zwischen Switches erfassen","text":"<ol> <li>Klicken Sie in der Containerlab-Erweiterung TopoViewer mit der rechten Maustaste auf die Verbindung zwischen <code>sw-dist</code> und <code>sw-acc1</code></li> <li>W\u00e4hlen Sie \"Capture\" von der <code>sw-dist</code>-Seite</li> <li> <p>Wireshark \u00f6ffnet sich \u00fcber Edgeshark</p> </li> <li> <p>Wireshark-Filter anwenden:</p> </li> </ol> <pre><code>vlan\n</code></pre> <ol> <li>Datenverkehr generieren durch Ping von einer SPS (verwenden Sie bestehende SSH-Sitzung):</li> </ol> <pre><code>ping -c 10 10.10.0.1\n</code></pre> <p>Fragen:</p> <ul> <li>Welche VLANs sehen Sie in den Captures?</li> <li>Schauen Sie sich die Ethernet-Frame-Details an - wo befindet sich das VLAN-Tag?</li> <li>Was ist der Wert des VLAN-ID-Feldes?</li> </ul>"},{"location":"exercises/ex1-vlan-discovery.html#aufgabe-3-datenverkehr-auf-access-port-erfassen","title":"Aufgabe 3: Datenverkehr auf Access-Port erfassen","text":"<ol> <li>Stoppen Sie die vorherige Erfassung</li> <li>Klicken Sie mit der rechten Maustaste auf die Verbindung zwischen <code>sw-acc1</code> und <code>wago-plc2a-vlan10</code></li> <li>W\u00e4hlen Sie \"Capture\" von der Switch-Seite</li> <li>Generieren Sie erneut Datenverkehr:</li> </ol> <pre><code>ping -c 10 10.10.0.1\n</code></pre> <ol> <li>Wenden Sie denselben Filter an:</li> </ol> <pre><code>vlan\n</code></pre> <p>Fragen:</p> <ul> <li>Sehen Sie jetzt VLAN-Tags?</li> <li>Was ist der Unterschied zwischen Trunk- und Access-Ports bez\u00fcglich VLAN-Tags?</li> <li>Warum entfernt der Switch VLAN-Tags auf Access-Ports?</li> </ul>"},{"location":"exercises/ex1-vlan-discovery.html#uberprufung","title":"\u00dcberpr\u00fcfung","text":"<p>Erfolgsindikatoren:</p> <ul> <li>Pings innerhalb desselben VLANs sind erfolgreich</li> <li>Pings \u00fcber VLANs hinweg sind erfolgreich (flat) oder schlagen fehl (segmentiert mit Firewall)</li> <li>Trunk-Port-Captures zeigen 802.1Q-Header</li> <li>Access-Port-Captures zeigen ungetaggte Frames</li> <li>Mehrere VLAN-IDs auf Trunk sichtbar (10, 20, 30, 40, 50)</li> </ul>"},{"location":"exercises/ex1-vlan-discovery.html#zu-uberlegende-fragen","title":"Zu \u00fcberlegende Fragen","text":"<ol> <li>Wenn ein Angreifer Zugang zu einem Trunk-Port erh\u00e4lt, welche zus\u00e4tzliche Angriffsfl\u00e4che entsteht dadurch?</li> <li>Wie w\u00fcrden Sie unbefugten VLAN-Zugriff erkennen?</li> <li>Was ist VLAN-Hopping und wie k\u00f6nnte es verhindert werden?</li> </ol>"},{"location":"exercises/ex1-vlan-discovery.html#haufige-probleme","title":"H\u00e4ufige Probleme","text":"<ul> <li>Problem: VLAN-Tags in Capture nicht sichtbar</li> <li> <p>L\u00f6sung: Stellen Sie sicher, dass Sie auf dem Trunk-Port zwischen Switches erfassen, nicht auf dem Access-Port zum Ger\u00e4t</p> </li> <li> <p>Problem: Wireshark \u00f6ffnet sich nicht</p> </li> <li> <p>L\u00f6sung: Beim ersten Mal muss m\u00f6glicherweise die Edgeshark-Eingabeaufforderung akzeptiert werden. Schliessen und erneut versuchen.</p> </li> <li> <p>Problem: Pings schlagen innerhalb desselben VLANs fehl</p> </li> <li>L\u00f6sung: \u00dcberpr\u00fcfen Sie, ob das Lab vollst\u00e4ndig bereitgestellt ist. F\u00fchren Sie <code>scripts/lab-test.py ot-sec-flat</code> zur \u00dcberpr\u00fcfung aus.</li> </ul>"},{"location":"exercises/ex1-vlan-discovery.html#losung","title":"L\u00f6sung","text":"Zum Anzeigen der L\u00f6sung klicken"},{"location":"exercises/ex1-vlan-discovery.html#aufgabe-1-konnektivitatstest","title":"Aufgabe 1: Konnektivit\u00e4tstest","text":"<p>SSH zu wago-plc2a-vlan10:</p> <pre><code>ssh admin@192.168.100.53\n</code></pre> <p>Ping innerhalb von VLAN 10 - ERFOLGREICH:</p> <pre><code>ping -c 4 10.10.0.12\n</code></pre> <p>Erwartete Ausgabe:</p> <pre><code>PING 10.10.0.12 (10.10.0.12) 56(84) bytes of data.\n64 bytes from 10.10.0.12: icmp_seq=1 ttl=64 time=0.521 ms\n64 bytes from 10.10.0.12: icmp_seq=2 ttl=64 time=0.389 ms\n64 bytes from 10.10.0.12: icmp_seq=3 ttl=64 time=0.412 ms\n64 bytes from 10.10.0.12: icmp_seq=4 ttl=64 time=0.398 ms\n\n--- 10.10.0.12 ping statistics ---\n4 packets transmitted, 4 received, 0% packet loss\n</code></pre> <p>Ping zu VLAN 20 - ERFOLG (flat) oder FEHLSCHLAG (segmentiert mit Firewall):</p> <pre><code>ping -c 4 10.20.0.11\n</code></pre> <p>In <code>ot-sec-flat</code>: Erfolgreich, da keine Firewall den Inter-VLAN-Verkehr blockiert. In <code>ot-sec-segmented</code>: Kann fehlschlagen, wenn Firewall-Regeln diese Kommunikation blockieren.</p>"},{"location":"exercises/ex1-vlan-discovery.html#aufgabe-2-trunk-port-capture","title":"Aufgabe 2: Trunk-Port-Capture","text":"<p>In Wireshark auf Trunk-Link zwischen Switches, mit Filter <code>vlan</code>:</p> <p>Beobachtet: 802.1Q-Header sichtbar mit VLAN-ID 10 f\u00fcr Datenverkehr von VLAN 10-Ger\u00e4ten.</p> <p>Frame-Struktur:</p> <pre><code>Ethernet II\n    Destination: [MAC]\n    Source: [MAC]\n    Type: 802.1Q (0x8100)\n802.1Q Virtual LAN\n    Priority: 0\n    CFI: 0\n    ID: 10\n    Type: IPv4 (0x0800)\n</code></pre>"},{"location":"exercises/ex1-vlan-discovery.html#aufgabe-3-access-port-capture","title":"Aufgabe 3: Access-Port-Capture","text":"<p>Auf Access-Port zu <code>wago-plc2a-vlan10</code> zeigt Filter <code>vlan</code> KEINE Ergebnisse.</p> <p>Frames sind ungetaggt. Switch f\u00fcgt VLAN-Tag beim Weiterleiten an Trunk hinzu, entfernt es beim Weiterleiten an Access-Port.</p> <p>Antworten auf die Fragen:</p> <ul> <li>Trunk-Ports zeigen mehrere VLANs: 10, 20, 30, 40, 50</li> <li>VLAN-Tag wird nach Quell-MAC, vor EtherType eingef\u00fcgt</li> <li>Access-Ports haben keine VLAN-Tags - Switch handhabt das Tagging</li> <li>Dies erm\u00f6glicht es Endger\u00e4ten, VLAN-unabh\u00e4ngig zu sein</li> </ul>"},{"location":"exercises/ex2-arp-spoofing.html","title":"\u00dcbung 2: ARP-Spoofing-Angriff","text":"<p>Zeitsch\u00e4tzung: 30-40 Minuten Lab-Topologie: <code>ot-sec-flat</code> (empfohlen) oder <code>ot-sec-segmented</code> Schwierigkeit:  Fortgeschritten</p>"},{"location":"exercises/ex2-arp-spoofing.html#lernziele","title":"Lernziele","text":"<ul> <li>Einen Layer-2-Man-in-the-Middle-Angriff ausf\u00fchren</li> <li>ARP-Protokoll-Schwachstellen verstehen</li> <li>Klartext-Datenverkehr w\u00e4hrend eines MITM-Angriffs erfassen</li> <li>Erkennungs- und Abwehrstrategien lernen</li> </ul>"},{"location":"exercises/ex2-arp-spoofing.html#voraussetzungen","title":"Voraussetzungen","text":"<ul> <li>Verst\u00e4ndnis des ARP-Protokolls</li> <li>Grundkenntnisse \u00fcber Netzwerkangriffe</li> <li>Wireshark-Erfahrung</li> <li>Root/sudo-Konzepte</li> </ul>"},{"location":"exercises/ex2-arp-spoofing.html#szenario","title":"Szenario","text":"<p>ARP (Address Resolution Protocol) ordnet IP-Adressen MAC-Adressen in lokalen Netzwerken zu. Da ARP keine Authentifizierung hat, kann ein Angreifer falsche ARP-Antworten senden, um den ARP-Cache von Zielger\u00e4ten zu vergiften. Dies leitet den Datenverkehr \u00fcber das System des Angreifers um und erm\u00f6glicht Man-in-the-Middle-Angriffe. In OT-Umgebungen kann dies SPS-Kommunikation, Engineering-Workstation-Datenverkehr oder HMI-Verbindungen abfangen.</p>"},{"location":"exercises/ex2-arp-spoofing.html#aufgaben","title":"Aufgaben","text":""},{"location":"exercises/ex2-arp-spoofing.html#aufgabe-1-normales-arp-verhalten-beobachten","title":"Aufgabe 1: Normales ARP-Verhalten beobachten","text":"<ol> <li>SSH-Verbindung zur Opfer-SPS <code>wago-plc2b-vlan10</code>:</li> </ol> <pre><code>ssh admin@192.168.100.54\n</code></pre> <p>Standard-Anmeldedaten</p> <p>Passwort: <code>admin</code></p> <ol> <li>Aktuelle ARP-Tabelle anzeigen:</li> </ol> <pre><code>ip neighbor\n</code></pre> <ol> <li> <p>Notieren Sie die MAC-Adresse f\u00fcr Gateway <code>10.10.0.1</code></p> </li> <li> <p>Kontinuierlichen Ping zum externen Netzwerk starten:</p> </li> </ol> <pre><code>ping 1.1.1.1\n</code></pre> <p>Lassen Sie dies laufen (dr\u00fccken Sie nicht Ctrl+C).</p>"},{"location":"exercises/ex2-arp-spoofing.html#aufgabe-2-verkehrserfassung-einrichten","title":"Aufgabe 2: Verkehrserfassung einrichten","text":"<ol> <li>\u00d6ffnen Sie ein neues Terminal bzw. eine neue SSH-Sitzung</li> <li>Stellen Sie eine SSH-Verbindung zur Angreifer-SPS <code>wago-plc2a-vlan10</code> her:</li> </ol> <pre><code>ssh admin@192.168.100.53\n</code></pre> <ol> <li>Wireshark-Erfassung auf der Verbindung zwischen <code>wago-plc2a-vlan10</code> und <code>sw-acc1</code> starten</li> <li>Filter anwenden:</li> </ol> <pre><code>icmp\n</code></pre> <p>Beobachtung: Derzeit sollten Sie noch KEINEN Datenverkehr sehen, da der Ping nicht \u00fcber den Angreifer l\u00e4uft.</p>"},{"location":"exercises/ex2-arp-spoofing.html#aufgabe-3-arp-spoofing-angriff-ausfuhren","title":"Aufgabe 3: ARP-Spoofing-Angriff ausf\u00fchren","text":"<ol> <li>Auf dem Angreifer (<code>wago-plc2a-vlan10</code>) das ARP-Spoofing-Skript ausf\u00fchren:</li> </ol> <pre><code>sudo /home/admin/arp_spoofing-simple.sh eth1 10.10.0.12 10.10.0.1\n</code></pre> <p>Parameter:</p> <ul> <li><code>eth1</code> - mit Netzwerk verbundenes Interface</li> <li><code>10.10.0.12</code> - Opfer-IP (wago-plc2b-vlan10)</li> <li><code>10.10.0.1</code> - Gateway-IP</li> </ul> <p>Erwartete Ausgabe:</p> <pre><code>[*] Enabling IP forwarding...\n[*] Poisoning 10.10.0.12 (telling it we are 10.10.0.1)...\n[*] Poisoning 10.10.0.1 (telling it we are 10.10.0.12)...\n</code></pre> <ol> <li> <p>\u00dcberpr\u00fcfen Sie Wireshark - Sie sollten jetzt ICMP-Echo-Anfragen und -Antworten sehen, die durch den Angreifer fliessen</p> </li> <li> <p>Beim Opfer ARP-Tabelle erneut \u00fcberpr\u00fcfen:</p> </li> </ol> <pre><code>ip neighbor\n</code></pre> <p>Frage: Hat sich die MAC-Adresse f\u00fcr <code>10.10.0.1</code> ge\u00e4ndert? Vergleichen Sie mit dem Original.</p>"},{"location":"exercises/ex2-arp-spoofing.html#aufgabe-4-klartext-anmeldedaten-erfassen","title":"Aufgabe 4: Klartext-Anmeldedaten erfassen","text":"<ol> <li>ARP-Spoofing-Skript stoppen (Ctrl+C auf Angreifer)</li> <li> <p>Neues Terminal \u00f6ffnen und SSH-Verbindung zum Internet-Knoten <code>panasonic-toughbook-internet</code> herstellen:</p> <pre><code>ssh admin@192.168.100.51\n</code></pre> </li> <li> <p>Auf dem Internet-Knoten netcat-Listener auf Port 2323 starten:</p> <pre><code>nc -l -k 2323\n</code></pre> <p>Lassen Sie dies laufen, um eingehende Verbindungen zu empfangen.</p> </li> <li> <p>Beim Opfer (<code>wago-plc2b-vlan10</code>) Test-Anmeldedaten senden:</p> <pre><code>echo \"username:admin password:secretpass123\" | nc 1.1.1.1 2323\n</code></pre> </li> <li> <p>Auf dem Angreifer ARP-Spoofing neu starten:</p> <pre><code>sudo /home/admin/arp_spoofing-simple.sh eth1 10.10.0.12 10.10.0.1\n</code></pre> </li> <li> <p>Vom Opfer Anmeldedaten erneut senden:</p> <pre><code>echo \"username:admin password:secretpass123\" | nc 1.1.1.1 2323\n</code></pre> </li> <li> <p>In Wireshark ICMP-Filter entfernen und nach TCP-Datenverkehr auf Port 2323 suchen</p> </li> <li>TCP-Stream folgen, um Klartext-Daten zu sehen</li> <li>Netcat-Listener auf Internet-Knoten pr\u00fcfen - er sollte die empfangenen Anmeldedaten anzeigen</li> </ol>"},{"location":"exercises/ex2-arp-spoofing.html#uberprufung","title":"\u00dcberpr\u00fcfung","text":"<p>Erfolgsindikatoren:</p> <ul> <li>Angreifer sieht Ping-Datenverkehr des Opfers in Wireshark</li> <li>ARP-Tabelle des Opfers zeigt MAC des Angreifers f\u00fcr Gateway</li> <li>Skript-Ausgabe zeigt Poisoning-Meldungen</li> <li>TCP-Stream enth\u00fcllt Klartext-Anmeldedaten</li> </ul>"},{"location":"exercises/ex2-arp-spoofing.html#zu-uberlegende-fragen","title":"Zu \u00fcberlegende Fragen","text":"<ol> <li>Wie k\u00f6nnen Sie ARP-Spoofing in einem Produktionsnetzwerk erkennen?</li> <li>Welche Abwehrstrategien existieren (DAI, Port-Security, statisches ARP)?</li> <li>Warum ist dieser Angriff in OT-Umgebungen besonders gef\u00e4hrlich?</li> <li>Welche Protokolle sind anf\u00e4llig f\u00fcr MITM-Anmeldedaten-Diebstahl?</li> </ol>"},{"location":"exercises/ex2-arp-spoofing.html#haufige-probleme","title":"H\u00e4ufige Probleme","text":"<ul> <li>Problem: Skript schl\u00e4gt fehl mit \"must be run as root\"</li> <li> <p>L\u00f6sung: Verwenden Sie <code>sudo</code> vor dem Skript-Befehl</p> </li> <li> <p>Problem: Kein Datenverkehr in Wireshark w\u00e4hrend des Angriffs sichtbar</p> </li> <li>L\u00f6sung: \u00dcberpr\u00fcfen Sie, ob IP-Forwarding aktiviert ist (Skript macht dies automatisch)</li> </ul>"},{"location":"exercises/ex2-arp-spoofing.html#erweiterte-herausforderung","title":"Erweiterte Herausforderung","text":"<p>Verwenden Sie das <code>dsniff</code>-Tool zur automatischen Erfassung von Anmeldedaten:</p> <pre><code>sudo dsniff -i eth1\n</code></pre> <p>W\u00e4hrend der Ausf\u00fchrung HTTP- oder FTP-Datenverkehr generieren und automatische Anmeldedaten-Extraktion beobachten.</p>"},{"location":"exercises/ex2-arp-spoofing.html#losung","title":"L\u00f6sung","text":"Zum Anzeigen der L\u00f6sung klicken"},{"location":"exercises/ex2-arp-spoofing.html#zustand-vor-dem-angriff","title":"Zustand vor dem Angriff","text":"<p>ARP-Tabelle des Opfers vor dem Angriff:</p> <pre><code>ip neighbor\n</code></pre> <p>Ausgabe zeigt:</p> <pre><code>10.10.0.1 dev eth1 lladdr 02:42:ac:14:00:0b REACHABLE\n</code></pre> <p>Notieren Sie diese MAC-Adresse.</p>"},{"location":"exercises/ex2-arp-spoofing.html#angriffsdurchfuhrung","title":"Angriffsdurchf\u00fchrung","text":"<p>Vom Angreifer <code>wago-plc2a-vlan10</code>:</p> <pre><code>sudo /home/admin/arp_spoofing-simple.sh eth1 10.10.0.12 10.10.0.1\n</code></pre> <p>Ausgabe:</p> <pre><code>[*] Enabling IP forwarding...\n[*] Poisoning 10.10.0.12 (telling it we are 10.10.0.1)...\n[*] Poisoning 10.10.0.1 (telling it we are 10.10.0.12)...\n</code></pre> <p>Skript l\u00e4uft weiter.</p>"},{"location":"exercises/ex2-arp-spoofing.html#uberprufung_1","title":"\u00dcberpr\u00fcfung","text":"<p>Beim Opfer ARP erneut pr\u00fcfen:</p> <pre><code>ip neighbor\n</code></pre> <p>MAC f\u00fcr <code>10.10.0.1</code> zeigt jetzt die MAC des Angreifers anstelle der echten Gateway-MAC.</p> <p>In Wireshark auf dem Interface des Angreifers ist nun ICMP-Datenverkehr vom Opfer sichtbar.</p>"},{"location":"exercises/ex2-arp-spoofing.html#erkennungsmethoden","title":"Erkennungsmethoden","text":"<ol> <li>ARP-Tabellen auf unerwartete \u00c4nderungen \u00fcberwachen</li> <li>Gratuitous ARP-Pakete erkennen</li> <li>ARP-\u00dcberwachungstools verwenden (arpwatch)</li> <li>MAC-zu-IP-Zuordnungen mit bekanntem guten Zustand vergleichen</li> </ol>"},{"location":"exercises/ex2-arp-spoofing.html#abwehrstrategien","title":"Abwehrstrategien","text":"<ol> <li>Dynamic ARP Inspection (DAI) auf Switches</li> <li>Port-Security zur Begrenzung der MAC-Adressen pro Port</li> <li>Statische ARP-Eintr\u00e4ge f\u00fcr kritische Infrastruktur</li> <li>Netzwerksegmentierung zur Reduzierung des Angriffsbereichs</li> <li>802.1X-Authentifizierung vor Netzwerkzugang</li> </ol>"},{"location":"exercises/ex3-spanning-tree.html","title":"\u00dcbung 3: Spanning-Tree-Protokoll-Analyse","text":"<p>Zeitsch\u00e4tzung: 25-35 Minuten Lab-Topologie: <code>ot-sec-flat</code> oder <code>ot-sec-segmented</code> Schwierigkeit:  Fortgeschritten</p>"},{"location":"exercises/ex3-spanning-tree.html#lernziele","title":"Lernziele","text":"<ul> <li>Spanning-Tree-Protokoll-Betrieb verstehen</li> <li>Root-Bridge und Port-Status identifizieren</li> <li>STP-BPDU-Austausch beobachten</li> <li>(Nur segmentiert) LACP-Bonding mit STP analysieren</li> </ul>"},{"location":"exercises/ex3-spanning-tree.html#voraussetzungen","title":"Voraussetzungen","text":"<ul> <li>Verst\u00e4ndnis von Layer-2-Switching</li> <li>Kenntnisse \u00fcber STP/RSTP-Konzepte</li> <li>Grundlegende MikroTik-RouterOS-Befehle</li> <li>SSH-Zugang zu Switches</li> </ul>"},{"location":"exercises/ex3-spanning-tree.html#szenario","title":"Szenario","text":"<p>Das Spanning Tree Protocol (STP) verhindert Schleifen in geswitchten Netzwerken durch Blockieren redundanter Pfade. Industrielle Netzwerke verwenden RSTP (Rapid Spanning Tree Protocol) f\u00fcr schnellere Konvergenz. Beide Lab-Topologien f\u00fchren STP auf allen Switches aus. Das segmentierte Lab verwendet zus\u00e4tzlich LACP (Link Aggregation Control Protocol) Bonding zwischen Switches, das zur Bereitstellung von Redundanz und erh\u00f6hter Bandbreite mit STP zusammenarbeitet.</p>"},{"location":"exercises/ex3-spanning-tree.html#aufgaben","title":"Aufgaben","text":""},{"location":"exercises/ex3-spanning-tree.html#aufgabe-1-switch-topologie-identifizieren","title":"Aufgabe 1: Switch-Topologie identifizieren","text":"<ol> <li>SSH-Verbindung zum Distribution-Switch:</li> </ol> <pre><code>ssh admin@192.168.100.12\n</code></pre> <p>Standard-Anmeldedaten</p> <p>Passwort: <code>admin</code></p> <ol> <li>Bridge-Konfiguration anzeigen:</li> </ol> <pre><code>/interface bridge print\n</code></pre> <ol> <li>Alle Bridge-Ports auflisten:</li> </ol> <pre><code>/interface bridge port print\n</code></pre> <p>Fragen:</p> <ul> <li>Wie lautet der Bridge-Name?</li> <li>Welche Interfaces sind Bridge-Mitglieder?</li> <li>Welche Interfaces haben VLAN-Filterung aktiviert?</li> </ul>"},{"location":"exercises/ex3-spanning-tree.html#aufgabe-2-link-topologie-untersuchen","title":"Aufgabe 2: Link-Topologie untersuchen","text":"<ol> <li>\u00dcberpr\u00fcfen, welche Interfaces mit anderen Switches verbunden sind:</li> </ol> <pre><code>/interface bridge port print\n</code></pre> <p>Erwartete Ausgabe:</p> <ul> <li>Flache Topologie: ether10, ether12, ether8, ether2 als Bridge-Mitglieder</li> <li>Segmentierte Topologie: ether12, ether10, ether8, ether2 als Bridge-Mitglieder</li> </ul> <p>Fragen:</p> <ul> <li>Wie viele Links verbinden sw-dist mit sw-acc1?</li> <li>(Segmentiert) Sind beide Bond-Mitglieder aktiv?</li> </ul>"},{"location":"exercises/ex3-spanning-tree.html#aufgabe-3-bpdu-frames-erfassen","title":"Aufgabe 3: BPDU-Frames erfassen","text":"<ol> <li>In TopoViewer Wireshark-Erfassung auf der Verbindung zwischen <code>sw-dist</code> und <code>sw-acc1</code> starten</li> <li>Filter anwenden:</li> </ol> <pre><code>stp\n</code></pre> <p>Oder alternativ:</p> <pre><code>eth.dst == 01:80:c2:00:00:00\n</code></pre> <p>Beobachtungen:</p> <ul> <li>BPDUs werden an Multicast-Adresse <code>01:80:c2:00:00:00</code> gesendet</li> <li>Root-Bridge-Identifikator</li> <li>Port-Rollen (designated, root)</li> <li> <p>Bridge-Priorit\u00e4tswerte</p> </li> <li> <p>Bridge-Einstellungen auf beiden Switches \u00fcberpr\u00fcfen:</p> </li> </ul> <p>Auf <code>sw-dist</code>:</p> <pre><code>/interface bridge print detail\n</code></pre> <p>Auf <code>sw-acc1</code> (SSH zu 192.168.100.13):</p> <pre><code>/interface bridge print detail\n</code></pre> <p>Frage: Welcher Switch hat niedrigere Priorit\u00e4t und wird Root-Bridge?</p>"},{"location":"exercises/ex3-spanning-tree.html#aufgabe-4-redundanzansatz-verstehen","title":"Aufgabe 4: Redundanzansatz verstehen","text":"<p>In flacher Topologie:</p> <ul> <li>Einzelne Verbindung zwischen Switches</li> <li>STP verhindert Schleifen zwischen anderen Switch-Verbindungen</li> <li>Keine Link-Level-Redundanz zwischen sw-dist und sw-acc1</li> </ul> <p>In segmentierter Topologie:</p> <ul> <li>LACP-Bond bietet Link-Redundanz</li> <li>STP l\u00e4uft weiterhin auf anderen Ports</li> <li>Zwei komplement\u00e4re Redundanzmechanismen</li> </ul> <p>Vom Distribution-Switch Konfiguration \u00fcberpr\u00fcfen:</p> <pre><code>/interface ethernet print\n/interface bridge port print\n</code></pre> <p>Frage: Was passiert, wenn der einzelne Uplink in flacher Topologie ausf\u00e4llt?</p>"},{"location":"exercises/ex3-spanning-tree.html#uberprufung","title":"\u00dcberpr\u00fcfung","text":"<p>Erfolgsindikatoren:</p> <ul> <li>Bridge-Konfiguration zeigt aktivierte VLAN-Filterung</li> <li>BPDU-Frames in Wireshark-Captures sichtbar</li> <li>Root-Bridge aus Bridge-Einstellungen identifiziert</li> <li>(Segmentiert) Bond-Interface existiert mit aktivem LACP</li> <li>(Flat) Einzelne Link-Topologie dokumentiert</li> <li>Verst\u00e4ndnis, wie STP Schleifen verhindert</li> </ul>"},{"location":"exercises/ex3-spanning-tree.html#zu-uberlegende-fragen","title":"Zu \u00fcberlegende Fragen","text":"<ol> <li>Warum l\u00e4uft STP auch dann, wenn kein redundanter Pfad vorhanden ist (flat)?</li> <li>(Segmentiert) Was passiert, wenn ein Bond-Mitglied ausf\u00e4llt?</li> <li>Wie schnell konvergiert STP nach einer Topologie\u00e4nderung?</li> <li>Welche Sicherheitsrisiken birgt STP (BPDU-Angriffe)?</li> </ol>"},{"location":"exercises/ex3-spanning-tree.html#haufige-probleme","title":"H\u00e4ufige Probleme","text":"<ul> <li>Problem: Kein Bonding-Interface in flat sichtbar</li> <li> <p>L\u00f6sung: Korrekt - flache Topologie hat kein Bonding, nur einzelne Links</p> </li> <li> <p>Problem: SSH zu Switches nicht m\u00f6glich</p> </li> <li> <p>L\u00f6sung: Verwenden Sie Management-IPs 192.168.100.11-14, nicht Datenebenen-IPs</p> </li> <li> <p>Problem: Keine BPDUs im Capture</p> </li> <li> <p>L\u00f6sung: BPDUs werden periodisch gesendet (alle 2 Sekunden). Warten oder Topologie\u00e4nderung erzeugen.</p> </li> <li> <p>Problem: \u00dcbung sagt \"nur segmentiert\", aber ich bin in flat</p> </li> <li>L\u00f6sung: \u00dcbung 3 funktioniert in beiden Topologien - Bonding-Aufgaben sind innerhalb der \u00dcbung als nur-segmentiert markiert</li> </ul>"},{"location":"exercises/ex3-spanning-tree.html#losung","title":"L\u00f6sung","text":"Zum Anzeigen der L\u00f6sung klicken"},{"location":"exercises/ex3-spanning-tree.html#bridge-konfiguration","title":"Bridge-Konfiguration","text":"<p>OT-LAB RSTP Topologie</p> <p>SSH zu <code>sw-dist</code>:</p> <pre><code>ssh admin@192.168.100.12\n</code></pre> <p>Bridge anzeigen:</p> <pre><code>/interface bridge print\n</code></pre> <p>Ausgabe:</p> <pre><code>Flags: X - disabled, R - running\n 0 R name=\"bridge\" mtu=auto actual-mtu=1500 l2mtu=65535 arp=enabled \n     arp-timeout=auto mac-address=XX:XX:XX:XX:XX:XX auto-mac=no \n     protocol-mode=rstp vlan-filtering=yes\n</code></pre> <p>Bridge-Ports:</p> <pre><code>/interface bridge port print\n</code></pre> <p>Flache Topologie zeigt ether10, ether12, ether8, ether2 als Bridge-Mitglieder mit VLAN-Einstellungen.</p> <p>Segmentierte Topologie zeigt ether12, ether10, ether8, ether2 als Bridge-Mitglieder mit VLAN-Einstellungen.</p> <p>Bonding nicht konfiguriert</p> <p>Link-Aggregation (Bonding) ist derzeit in keiner Lab-Topologie konfiguriert. In beiden Topologien verbindet sich jeder Switch \u00fcber einzelne physische Interfaces.</p>"},{"location":"exercises/ex3-spanning-tree.html#root-bridge-identifikation","title":"Root-Bridge-Identifikation","text":"<p>Priorit\u00e4t auf beiden Switches pr\u00fcfen. Niedrigere Priorit\u00e4t gewinnt. Standard-Priorit\u00e4t ist 32768.</p> <p>BPDU-Captures zeigen Root-Bridge-ID in den Protokollfeldern.</p>"},{"location":"exercises/ex4-link-aggregation.html","title":"\u00dcbung 4: Link-Aggregation und Lastverteilung","text":"<p>Zeitsch\u00e4tzung: 20-30 Minuten Lab-Topologie: Nur <code>ot-sec-segmented</code> Schwierigkeit:  Fortgeschritten</p> <p>\u00dcbung noch nicht verf\u00fcgbar</p> <p>Link-Aggregation ist derzeit in keiner Lab-Topologie konfiguriert. Diese \u00dcbung ist f\u00fcr eine zuk\u00fcnftige Lab-Version geplant.</p>"},{"location":"exercises/ex4-link-aggregation.html#lernziele","title":"Lernziele","text":"<ul> <li>LACP-Link-Aggregation-Betrieb analysieren</li> <li>Verkehrsverteilung \u00fcber gebondete Links beobachten</li> <li>Link-Failover-Verhalten testen</li> <li>Lastverteilungsalgorithmen verstehen</li> </ul>"},{"location":"exercises/ex4-link-aggregation.html#voraussetzungen","title":"Voraussetzungen","text":"<ul> <li>\u00dcbung 3 abgeschlossen (STP-Analyse)</li> <li>Verst\u00e4ndnis von LACP-Konzepten</li> <li>Wireshark-Erfahrung</li> <li>Grundlegende MikroTik-Befehle</li> </ul>"},{"location":"exercises/ex4-link-aggregation.html#szenario","title":"Szenario","text":"<p>Link-Aggregation kombiniert mehrere physische Links zu einem logischen Link f\u00fcr erh\u00f6hte Bandbreite und Redundanz. LACP (802.3ad) verhandelt Bonding dynamisch. Der Datenverkehr wird \u00fcber Mitglied-Links verteilt, wobei ein Hash-Algorithmus basierend auf Quell-/Ziel-MAC, IP oder Ports verwendet wird. Das Verst\u00e4ndnis der Funktionsweise ist wichtig f\u00fcr Kapazit\u00e4tsplanung und Troubleshooting in OT-Netzwerken.</p>"},{"location":"exercises/ex4-link-aggregation.html#aufgaben","title":"Aufgaben","text":""},{"location":"exercises/ex4-link-aggregation.html#aufgabe-1-lacp-verhandlung-uberprufen","title":"Aufgabe 1: LACP-Verhandlung \u00fcberpr\u00fcfen","text":"<ol> <li>SSH zu <code>sw-dist</code>:</li> </ol> <pre><code>ssh admin@192.168.100.12\n</code></pre> <p>Standard-Anmeldedaten</p> <p>Passwort: <code>admin</code></p> <ol> <li>LACP-Protokollbetrieb \u00fcberwachen:</li> </ol> <pre><code>/interface bonding monitor bond-sw-acc1 once\n</code></pre> <p>Erwartete Ausgabe enth\u00e4lt:</p> <ul> <li><code>lacp-partner-system-id</code> - MAC des Partner-Switches</li> <li><code>active-ports</code> - Anzahl aktiver Links</li> <li> <p><code>lacp-negotiated</code> - True/False</p> </li> <li> <p>Detaillierte Bonding-Konfiguration \u00fcberpr\u00fcfen:</p> </li> </ul> <pre><code>/interface bonding print detail where name=bond-sw-acc1\n</code></pre> <p>Fragen:</p> <ul> <li>Was ist der Bonding-Modus?</li> <li>Welche physischen Interfaces sind Slaves?</li> <li>Was ist die Transmit-Hash-Policy?</li> </ul>"},{"location":"exercises/ex4-link-aggregation.html#aufgabe-2-verkehrsverteilung-beobachten","title":"Aufgabe 2: Verkehrsverteilung beobachten","text":"<ol> <li>Wireshark-Captures auf BEIDEN Bond-Mitglied-Links starten:</li> <li>Capture-Link <code>sw-dist</code> ether9 zu <code>sw-acc1</code></li> <li> <p>Zweites Wireshark f\u00fcr ether10 \u00f6ffnen</p> </li> <li> <p>SSH zu <code>wago-plc2a-vlan10</code>:</p> </li> </ol> <pre><code>ssh admin@192.168.100.53\n</code></pre> <ol> <li>Kontinuierlichen Verkehr mit variierenden Quellen generieren:</li> </ol> <pre><code>ping -f 1.1.1.1\n</code></pre> <p>Verwenden Sie <code>-f</code> (flood) f\u00fcr hohe Paketrate, um Verteilung zu sehen.</p> <ol> <li>Beide Wireshark-Captures beobachten</li> </ol> <p>Fragen:</p> <ul> <li>Ist der Verkehr gleichm\u00e4ssig \u00fcber beide Links verteilt?</li> <li>Sehen Sie Verkehr auf beiden Links oder nur auf einem?</li> <li>Was bestimmt, welcher Link f\u00fcr bestimmte Flows verwendet wird?</li> </ul>"},{"location":"exercises/ex4-link-aggregation.html#aufgabe-3-hash-algorithmus-testen","title":"Aufgabe 3: Hash-Algorithmus testen","text":"<ol> <li>Flood-Ping stoppen</li> <li>Verkehr von mehreren Quellen generieren:</li> </ol> <p>Terminal 1 - <code>wago-plc2a-vlan10</code>:</p> <pre><code>ping -i 0.2 1.1.1.1\n</code></pre> <p>Terminal 2 - <code>wago-plc2b-vlan10</code>:</p> <pre><code>ssh admin@192.168.100.54\nping -i 0.2 1.1.1.1\n</code></pre> <ol> <li>Paketz\u00e4hler auf Bond-Mitgliedern \u00fcberpr\u00fcfen:</li> </ol> <pre><code>/interface monitor-traffic ether9,ether10\n</code></pre> <p>Frage: Werden verschiedene Quell-IPs auf verschiedene Links verteilt?</p>"},{"location":"exercises/ex4-link-aggregation.html#aufgabe-4-link-failover-testen","title":"Aufgabe 4: Link-Failover testen","text":"<ol> <li>Pings aus vorherigem Schritt weiter laufen lassen</li> <li>Auf <code>sw-dist</code> ein Bond-Mitglied deaktivieren:</li> </ol> <pre><code>/interface ethernet disable ether9\n</code></pre> <ol> <li>Beobachten:</li> <li>Setzen sich Pings ohne Unterbrechung fort?</li> <li>Wie schnell erfolgt das Failover?</li> <li> <p>Wireshark auf verbleibendem aktivem Link \u00fcberpr\u00fcfen</p> </li> <li> <p>Interface wieder aktivieren:</p> </li> </ol> <pre><code>/interface ethernet enable ether9\n</code></pre> <ol> <li>Bond-Status \u00fcberpr\u00fcfen:</li> </ol> <pre><code>/interface bonding monitor bond-sw-acc1 once\n</code></pre> <p>Frage: Kehren beide Links automatisch in den aktiven Zustand zur\u00fcck?</p>"},{"location":"exercises/ex4-link-aggregation.html#uberprufung","title":"\u00dcberpr\u00fcfung","text":"<p>Erfolgsindikatoren:</p> <ul> <li>LACP zeigt verhandelten Status</li> <li>Beide Bond-Mitglieder aktiv</li> <li>Verkehr auf Mitglied-Links sichtbar</li> <li>Failover erfolgt in unter 1 Sekunde</li> <li>Deaktivierter Link tritt automatisch wieder bei, wenn aktiviert</li> <li>Paketzahl steigt auf beiden Interfaces</li> </ul>"},{"location":"exercises/ex4-link-aggregation.html#zu-uberlegende-fragen","title":"Zu \u00fcberlegende Fragen","text":"<ol> <li>Warum k\u00f6nnte Verkehr nur einen Link f\u00fcr einen bestimmten Flow verwenden?</li> <li>Was sind Vor- und Nachteile verschiedener Hash-Algorithmen?</li> <li>Wie vergleicht sich LACP mit statischem Bonding?</li> <li>Was passiert, wenn LACP-Hello-Pakete verloren gehen?</li> </ol>"},{"location":"exercises/ex4-link-aggregation.html#haufige-probleme","title":"H\u00e4ufige Probleme","text":"<ul> <li>Problem: Verkehr verwendet nur einen Link</li> <li> <p>L\u00f6sung: Hash-Algorithmus trifft Flow-basierte Entscheidungen. Einzelne Quelle/Ziel verwendet einen Link. Mehrere Quellen verwenden, um Verteilung zu sehen.</p> </li> <li> <p>Problem: Verkehr auf Interface kann nicht \u00fcberwacht werden</p> </li> <li> <p>L\u00f6sung: Verwenden Sie Befehlsformat <code>/interface monitor-traffic ether9,ether10</code></p> </li> <li> <p>Problem: Failover dauert mehrere Sekunden</p> </li> <li>L\u00f6sung: Dies ist normal f\u00fcr LACP. RSTP muss ebenfalls neu konvergieren.</li> </ul>"},{"location":"exercises/ex4-link-aggregation.html#losung","title":"L\u00f6sung","text":"Zum Anzeigen der L\u00f6sung klicken"},{"location":"exercises/ex4-link-aggregation.html#verkehrsverteilungsbeobachtung","title":"Verkehrsverteilungsbeobachtung","text":"<p>Mit einzelner Quell-Ping verwendet Verkehr typischerweise konsistent einen Link aufgrund des Hash-Algorithmus, der Quell-/Ziel-IPs verwendet.</p> <p>Mit mehreren Quellen (verschiedene Quell-IPs) verteilt sich Verkehr \u00fcber Links.</p> <p>Hash-Policy <code>layer-2-and-3</code> verwendet Quell-/Ziel-MAC- und IP-Adressen.</p>"},{"location":"exercises/ex4-link-aggregation.html#paketzahl-uberprufung","title":"Paketzahl-\u00dcberpr\u00fcfung","text":"<pre><code>/interface monitor-traffic ether9,ether10\n</code></pre> <p>Zeigt rx-packets-per-second und tx-packets-per-second f\u00fcr jedes Interface.</p> <p>Mit diversem Verkehr zeigen beide Interfaces steigende Paketzahlen.</p>"},{"location":"exercises/ex4-link-aggregation.html#failover-test","title":"Failover-Test","text":"<p>Ein Mitglied deaktivieren:</p> <pre><code>/interface ethernet disable ether9\n</code></pre> <p>Pings setzen sich ohne Unterbrechung fort. Aller Verkehr wechselt zu ether10.</p> <p>Wieder aktivieren:</p> <pre><code>/interface ethernet enable ether9\n</code></pre> <p>LACP verhandelt neu (dauert einige Sekunden), dann sind beide Links wieder aktiv.</p> <p>Failover erfolgt in Subsekunden f\u00fcr bestehende Flows.</p>"},{"location":"exercises/ex5-reconnaissance.html","title":"\u00dcbung 5: Fernzugriff und Sicherheitsbewertung","text":"<p>Zeitsch\u00e4tzung: 35-45 Minuten Lab-Topologie: <code>ot-sec-flat</code> (einfacher) oder <code>ot-sec-segmented</code> (realistisch) Schwierigkeit:  Fortgeschritten</p>"},{"location":"exercises/ex5-reconnaissance.html#lernziele","title":"Lernziele","text":"<ul> <li>Fernzugriff-Tests vom DMZ-Jumphost durchf\u00fchren</li> <li>Exponierte Dienste mittels Port-Scanning identifizieren</li> <li>Potenzielle Sicherheitsschwachstellen entdecken</li> <li>Professionelle Sicherheitsbewertungsmethodik praktizieren</li> </ul>"},{"location":"exercises/ex5-reconnaissance.html#voraussetzungen","title":"Voraussetzungen","text":"<ul> <li>Verst\u00e4ndnis von TCP/IP-Grundlagen</li> <li>Grundlegende nmap-Kenntnisse</li> <li>SSH- und Service-Konzepte</li> <li>Bewusstsein f\u00fcr Sicherheitsbewertung</li> </ul>"},{"location":"exercises/ex5-reconnaissance.html#szenario","title":"Szenario","text":"<p>Ein Sicherheitsbewerter hat Remote-Zugriff auf den Jumphost in der DMZ. Das Ziel ist es, das OT-Netzwerk zu kartieren, laufende Dienste zu identifizieren und potenzielle Sicherheitsprobleme zu dokumentieren. Dies simuliert reale Remote-Zugriffs-Szenarien, in denen Ingenieure oder Angreifer anf\u00e4nglichen Zugang erhalten und versuchen, den Zugriff auf OT-Zonen zu erweitern.</p>"},{"location":"exercises/ex5-reconnaissance.html#aufgaben","title":"Aufgaben","text":""},{"location":"exercises/ex5-reconnaissance.html#aufgabe-1-erster-fernzugriff-vom-jumphost","title":"Aufgabe 1: Erster Fernzugriff vom Jumphost","text":"<ol> <li>SSH zum Jumphost:</li> </ol> <pre><code>ssh admin@192.168.100.52\n</code></pre> <p>Standard-Anmeldedaten</p> <p>Passwort: <code>admin</code></p> <ol> <li>\u00dcberpr\u00fcfen Sie Ihre Netzwerkposition:</li> </ol> <pre><code>ip addr show\nip route show\n</code></pre> <p>Fragen:</p> <ul> <li>Welche IP-Adresse hat der Jumphost?</li> <li> <p>Welche Netzwerke sind gem\u00e4ss Routing-Tabelle erreichbar?</p> </li> <li> <p>Grundlegende Konnektivit\u00e4t testen:</p> </li> </ul> <pre><code>ping -c 3 10.10.0.1\nping -c 3 10.10.0.11\n</code></pre> <p>Hinweis: In segmentierter Topologie kann die Firewall einigen Verkehr blockieren.</p>"},{"location":"exercises/ex5-reconnaissance.html#aufgabe-2-host-erkennung","title":"Aufgabe 2: Host-Erkennung","text":"<ol> <li>VLAN 10 (Hygiene) nach aktiven Hosts scannen:</li> </ol> <pre><code>nmap -sn 10.10.0.0/24\n</code></pre> <p><code>-sn</code> f\u00fchrt Ping-Scan durch (kein Port-Scan)</p> <p>Erwartete Ausgabe:</p> <pre><code>Nmap scan report for 10.10.0.1\nHost is up.\n\nNmap scan report for 10.10.0.11\nHost is up.\n\nNmap scan report for 10.10.0.12\nHost is up.\n</code></pre> <ol> <li>Andere VLANs versuchen:</li> </ol> <pre><code>nmap -sn 10.20.0.0/24\nnmap -sn 10.40.0.0/24\n</code></pre> <p>Frage: Welche VLANs sind vom Jumphost aus erreichbar?</p>"},{"location":"exercises/ex5-reconnaissance.html#aufgabe-3-service-identifikation","title":"Aufgabe 3: Service-Identifikation","text":"<ol> <li>G\u00e4ngige OT-Ports auf entdeckter SPS scannen:</li> </ol> <pre><code>nmap -sV -p22,80,502,8080,2455 10.10.0.11\n</code></pre> <p>Port-Referenz:</p> <ul> <li>22: SSH</li> <li>80: HTTP</li> <li>502: Modbus TCP</li> <li>8080: CODESYS WebVisu</li> <li>2455: CODESYS Runtime</li> </ul> <p>Erwartete Ausgabe:</p> <pre><code>PORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 8.x\n8080/tcp open  http    nginx\n</code></pre> <ol> <li>Alle SPSen in VLAN 10 scannen:</li> </ol> <pre><code>nmap -p8080 10.10.0.11-12\n</code></pre> <p>Fragen:</p> <ul> <li>Welche Dienste sind exponiert?</li> <li>Laufen Dienste, die nicht laufen sollten?</li> <li>Was k\u00f6nnen Sie aus den Service-Bannern \u00fcber die Ger\u00e4te ableiten?</li> </ul>"},{"location":"exercises/ex5-reconnaissance.html#aufgabe-4-zugriffstest","title":"Aufgabe 4: Zugriffstest","text":"<ol> <li>SSH-Zugriff auf SPS testen:</li> </ol> <pre><code>ssh admin@10.10.0.11\n</code></pre> <p>Passwort versuchen: <code>admin</code></p> <p>Frage: Ist dies erfolgreich? Sollten SPSen direkt per SSH vom Jumphost erreichbar sein?</p> <ol> <li>Web-Interface-Zugriff testen:</li> </ol> <pre><code>curl -I http://10.10.0.11:8080\n</code></pre> <p>Beobachtung: HTTP-Response-Header auf Versionsinformationen pr\u00fcfen.</p> <ol> <li>Falls <code>nc</code> verf\u00fcgbar, Modbus-Port testen:</li> </ol> <pre><code>nc -zv 10.10.0.11 502\n</code></pre>"},{"location":"exercises/ex5-reconnaissance.html#aufgabe-5-ergebnisse-dokumentieren","title":"Aufgabe 5: Ergebnisse dokumentieren","text":"<p>Einfachen Bericht der Ergebnisse erstellen:</p> <pre><code>cat &gt; assessment_findings.txt &lt;&lt; 'EOF'\nOT-Netzwerk-Sicherheitsbewertung\n\nDatum: $(date)\nBewerter: $(whoami)\n\nERGEBNISSE:\n\n1. Erreichbare Netzwerke:\n   - VLAN 10: [Liste entdeckter Hosts]\n   - VLAN 20: [erreichbar? ja/nein]\n\n2. Exponierte Dienste:\n   - Host 10.10.0.11:\n     * Port 22 (SSH): OFFEN\n     * Port 8080 (HTTP): OFFEN\n     * Port 502 (Modbus): [Status]\n\n3. Sicherheitsprobleme:\n   - [Bedenken auflisten]\n\n4. Empfehlungen:\n   - [Vorgeschlagene Abhilfemassnahmen]\nEOF\n\ncat assessment_findings.txt\n</code></pre>"},{"location":"exercises/ex5-reconnaissance.html#uberprufung","title":"\u00dcberpr\u00fcfung","text":"<p>Erfolgsindikatoren:</p> <ul> <li>Host-Erkennung identifiziert aktive SPSen</li> <li>Service-Scans zeigen offene Ports</li> <li>SSH-Zugriff getestet (kann je nach Firewall erfolgreich sein oder fehlschlagen)</li> <li>HTTP-Interfaces entdeckt</li> <li>Ergebnisse dokumentiert</li> </ul>"},{"location":"exercises/ex5-reconnaissance.html#zu-uberlegende-fragen","title":"Zu \u00fcberlegende Fragen","text":"<ol> <li>Welche Dienste sollten niemals direkt von der DMZ aus erreichbar sein?</li> <li>Wie w\u00fcrden Sie den Jumphost-Zugriff in der Produktion einschr\u00e4nken?</li> <li>Welche zus\u00e4tzlichen Sicherheitskontrollen w\u00fcrden diese Architektur verbessern?</li> <li>Wie k\u00f6nnten diese Fernzugriff-Aktivit\u00e4ten erkannt werden?</li> </ol>"},{"location":"exercises/ex5-reconnaissance.html#haufige-probleme","title":"H\u00e4ufige Probleme","text":"<ul> <li>Problem: nmap-Befehl nicht gefunden</li> <li> <p>L\u00f6sung: Verwenden Sie <code>apt-get update &amp;&amp; apt-get install nmap</code> oder Tool ist vorinstalliert</p> </li> <li> <p>Problem: Alle Hosts erscheinen als down</p> </li> <li> <p>L\u00f6sung: In segmentierter Topologie kann Firewall ICMP blockieren. Verwenden Sie <code>-Pn</code>-Flag, um Ping zu \u00fcberspringen.</p> </li> <li> <p>Problem: Keine 10.x-Netzwerke erreichbar</p> </li> <li>L\u00f6sung: Routing mit <code>ip route</code> pr\u00fcfen. \u00dcberpr\u00fcfen, ob Lab korrekt bereitgestellt wurde.</li> </ul>"},{"location":"exercises/ex5-reconnaissance.html#erweiterte-herausforderung","title":"Erweiterte Herausforderung","text":"<ol> <li>Shell-Skript schreiben zur Automatisierung der Erkennung aller VLANs</li> <li>CSV-Bericht aller entdeckten Dienste generieren</li> <li>Auf Standard-Anmeldedaten auf entdeckten Diensten testen</li> <li>Netzwerkdiagramm basierend auf entdeckter Topologie erstellen</li> </ol>"},{"location":"exercises/ex5-reconnaissance.html#losung","title":"L\u00f6sung","text":"Zum Anzeigen der L\u00f6sung klicken"},{"location":"exercises/ex5-reconnaissance.html#host-erkennungsergebnisse","title":"Host-Erkennungsergebnisse","text":"<p>Vom Jumphost:</p> <pre><code>nmap -sn 10.10.0.0/24\n</code></pre> <p>Erwartete Entdeckungen in flacher Topologie:</p> <pre><code>10.10.0.1 (Gateway)\n10.10.0.11 (wago-plc2a-vlan10)\n10.10.0.12 (wago-plc2b-vlan10)\n</code></pre> <p>Segmentierte Topologie kann weniger Hosts aufgrund von Firewall-Regeln zeigen.</p>"},{"location":"exercises/ex5-reconnaissance.html#service-scan-ergebnisse","title":"Service-Scan-Ergebnisse","text":"<pre><code>nmap -sV -p22,80,502,8080,2455 10.10.0.11\n</code></pre> <p>Erwartete Ausgabe:</p> <pre><code>PORT     STATE SERVICE  VERSION\n22/tcp   open  ssh      OpenSSH 8.2p1 Ubuntu\n8080/tcp open  http     nginx 1.18.0\n</code></pre> <p>Andere Ports k\u00f6nnen je nach SPS-Konfiguration gefiltert oder geschlossen sein.</p>"},{"location":"exercises/ex5-reconnaissance.html#zugriffstest","title":"Zugriffstest","text":"<p>SSH zur SPS:</p> <pre><code>ssh admin@10.10.0.11\n</code></pre> <p>In flacher Topologie: Wahrscheinlich erfolgreich mit Passwort <code>admin</code>. In segmentierter Topologie: Kann durch Firewall-Regeln blockiert werden.</p> <p>Web-Interface:</p> <pre><code>curl -I http://10.10.0.11:8080\n</code></pre> <p>Gibt HTTP-Header zur\u00fcck, die CODESYS-WebVisu-Interface zeigen.</p>"},{"location":"exercises/ex5-reconnaissance.html#sicherheitsergebnisse","title":"Sicherheitsergebnisse","text":"<p>Typische entdeckte Probleme:</p> <ol> <li>SPSen per SSH mit Standard-Anmeldedaten erreichbar</li> <li>Web-Interfaces ohne Authentifizierung exponiert</li> <li>Modbus TCP ohne Authentifizierung erreichbar</li> <li>Keine Netzwerksegmentierung (flache Topologie)</li> <li>Standard-Passw\u00f6rter im Einsatz</li> <li>Unn\u00f6tige Dienste laufen</li> </ol>"},{"location":"exercises/ex5-reconnaissance.html#empfohlene-abhilfemassnahmen","title":"Empfohlene Abhilfemassnahmen","text":"<ol> <li>Zero-Trust-Netzwerksegmentierung implementieren</li> <li>Multi-Faktor-Authentifizierung f\u00fcr Remote-Zugriff verlangen</li> <li>Ungenutzte Dienste auf SPSen deaktivieren</li> <li>Standard-Anmeldedaten \u00e4ndern</li> <li>Anwendungsbewusste Firewall-Regeln implementieren</li> <li>IDS/IPS f\u00fcr Anomalieerkennung einsetzen</li> <li>VPN f\u00fcr Remote-Zugriff verlangen</li> <li>Jumphost-H\u00e4rtung implementieren</li> </ol>"},{"location":"exercises/ex6-protocol-discovery.html","title":"\u00dcbung 6: OT-Protokoll-Erkennung","text":"<p>Zeitsch\u00e4tzung: 45-50 Minuten Lab-Topologie: <code>ot-sec-flat</code> (empfohlen) oder <code>ot-sec-segmented</code> Schwierigkeit:  Fortgeschritten</p>"},{"location":"exercises/ex6-protocol-discovery.html#lernziele","title":"Lernziele","text":"<ul> <li>OT-Protokolle im Live-Verkehr entdecken</li> <li>Modbus-TCP-Kommunikation identifizieren</li> <li>CODESYS-Runtime-Protokoll analysieren</li> <li>OPC-UA-Sicherheitskonfigurationen bewerten</li> <li>PROFINET-Eigenschaften erkennen</li> <li>Sicherheitsimplikationen von Klartext-Protokollen verstehen</li> </ul>"},{"location":"exercises/ex6-protocol-discovery.html#voraussetzungen","title":"Voraussetzungen","text":"<ul> <li>\u00dcbung 1 (Wireshark-Grundlagen)</li> <li>Grundverst\u00e4ndnis von TCP/IP</li> </ul>"},{"location":"exercises/ex6-protocol-discovery.html#szenario","title":"Szenario","text":"<p>In einer OT-Umgebung ist Sichtbarkeit der Schl\u00fcssel. Im Gegensatz zu IT-Netzwerken, wo HTTPS und SSH dominieren, verlassen sich OT-Netzwerke oft auf Klartext-Protokolle wie Modbus TCP und propriet\u00e4re Protokolle wie CODESYS. In dieser \u00dcbung generieren Sie Verkehr zwischen einem HMI und einer SPS, erfassen ihn und analysieren die Protokolldetails, um zu verstehen, was ein Angreifer sehen k\u00f6nnte.</p>"},{"location":"exercises/ex6-protocol-discovery.html#aufgaben","title":"Aufgaben","text":""},{"location":"exercises/ex6-protocol-discovery.html#aufgabe-1-ot-verkehr-generieren","title":"Aufgabe 1: OT-Verkehr generieren","text":"<p>Um Verkehr zu analysieren, m\u00fcssen wir ihn zuerst generieren. Wir verwenden das HMI zur Interaktion mit der Web-Visualisierung einer SPS.</p> <ol> <li> <p>\u00d6ffnen Sie unter Ports: Chromium HMI WebVNC</p> </li> <li> <p>Navigieren Sie zum Cheat Sheet:</p> <ul> <li>URL: <code>http://10.10.0.11:8080/webvisu.htm</code></li> <li>(Falls das nicht l\u00e4dt, versuchen Sie <code>http://10.10.0.11:8080</code>)</li> </ul> </li> <li> <p>Interagieren Sie mit der Visualisierung (klicken Sie Buttons, schalten Sie Schalter), um Verkehr zu generieren.</p> </li> </ol>"},{"location":"exercises/ex6-protocol-discovery.html#aufgabe-2-verkehr-mit-wireshark-erfassen","title":"Aufgabe 2: Verkehr mit Wireshark erfassen","text":"<p>Jetzt erfassen wir den Verkehr, der zur SPS fliesst, mit den integrierten Lab-Tools.</p> <ol> <li> <p>Gehen Sie in VS Code zur Containerlab-Erweiterung (TopoViewer).</p> </li> <li> <p>Lokalisieren Sie die Verbindung zwischen <code>wago-plc2a-vlan10</code> und <code>sw-acc1</code>.</p> </li> <li> <p>Klicken Sie mit der rechten Maustaste auf die Verbindung (oder den Interface-Punkt auf der SPS-Seite) und w\u00e4hlen Sie Wireshark Capture.</p> <ul> <li>Dies startet eine Wireshark-Instanz direkt in Ihrem Browser bzw. Editor \u00fcber Edgeshark.</li> </ul> </li> <li> <p>Gehen Sie zur\u00fcck zum HMI (VNC) und interagieren Sie 10-15 Sekunden lang erneut mit der WebVisu (klicken Sie Buttons, schalten Sie Schalter).</p> </li> <li> <p>Kehren Sie zum Wireshark-Fenster zur\u00fcck. Sie sollten Pakete in Echtzeit erscheinen sehen.</p> </li> <li> <p>Stoppen Sie die Erfassung (roter quadratischer Button in Wireshark-Toolbar), um die Daten zu analysieren.</p> </li> </ol>"},{"location":"exercises/ex6-protocol-discovery.html#aufgabe-3-modbus-tcp-analysieren","title":"Aufgabe 3: Modbus TCP analysieren","text":"<ol> <li> <p>In Wireshark f\u00fcr Modbus-TCP-Verkehr filtern:</p> <pre><code>mbtcp\n</code></pre> <p>Hinweis: Falls Sie <code>mbtcp</code> nicht sehen, versuchen Sie Filter f\u00fcr Port <code>tcp.port == 502</code>.</p> </li> <li> <p>W\u00e4hlen Sie ein Paket. Erweitern Sie den Modbus-Abschnitt in den Paketdetails.</p> </li> <li> <p>Fragen:</p> <ul> <li>Welche Function Codes sehen Sie? (z.B. Read Holding Registers, Write Single Coil)</li> <li>K\u00f6nnen Sie die Werte sehen, die gelesen oder geschrieben werden?</li> <li>Gibt es Verschl\u00fcsselung oder Authentifizierung?</li> </ul> </li> </ol>"},{"location":"exercises/ex6-protocol-discovery.html#aufgabe-4-codesys-protokoll-analysieren","title":"Aufgabe 4: CODESYS-Protokoll analysieren","text":"<p>Die WebVisu kommuniziert mit der Runtime, oft \u00fcber propriet\u00e4re Protokolle oder HTTP/XML. Die Engineering-Workstation w\u00fcrde jedoch das CODESYS-Protokoll verwenden. Suchen wir danach oder nach anderem Management-Verkehr.</p> <ol> <li> <p>Filter l\u00f6schen und nach Verkehr auf Port 2455 (UDP) oder 1217 (TCP) suchen.</p> <pre><code>udp.port == 2455 || tcp.port == 1217\n</code></pre> </li> <li> <p>Falls Sie diesen Verkehr nicht sehen, liegt es m\u00f6glicherweise daran, dass wir nur WebVisu verwenden. Um CODESYS-Engineering-Verkehr zu generieren, w\u00fcrden wir die CODESYS IDE ben\u00f6tigen.</p> <p>Alternative: Schauen Sie nach HTTP-Verkehr f\u00fcr die WebVisu.</p> <pre><code>http &amp;&amp; ip.addr == 10.10.0.11\n</code></pre> </li> <li> <p>HTTP-Streams analysieren.</p> <ul> <li>Rechtsklicken Sie auf ein Paket -&gt; Follow -&gt; HTTP Stream.</li> <li>Beobachten Sie, dass die Visualisierungsdaten im Klartext \u00fcbertragen werden (es sei denn, HTTPS ist konfiguriert, was in \u00e4lteren Setups oft nicht der Standard ist).</li> </ul> </li> </ol>"},{"location":"exercises/ex6-protocol-discovery.html#aufgabe-5-opc-ua-sicherheitskonfiguration-analysieren","title":"Aufgabe 5: OPC-UA-Sicherheitskonfiguration analysieren","text":"<p>OPC UA ist der moderne Industrie-4.0-Protokollstandard. Im Gegensatz zu Modbus wurde es mit Sicherheitsfunktionen entwickelt, diese werden jedoch oft in Produktionsumgebungen deaktiviert. Ihre Aufgabe als OT-Sicherheitsexperte ist es, zu bewerten, ob die Sicherheit korrekt konfiguriert ist.</p>"},{"location":"exercises/ex6-protocol-discovery.html#hintergrund","title":"Hintergrund","text":"<p>OPC UA unterst\u00fctzt:</p> <ul> <li>Verschl\u00fcsselung (SignAndEncrypt)</li> <li>Authentifizierung (Benutzername/Passwort oder zertifikatbasiert)</li> <li>Autorisierung (rollenbasierte Zugriffskontrolle)</li> </ul> <p>Die meisten Implementierungen laufen jedoch mit <code>SecurityPolicy=None</code> und <code>Anonymous</code>-Authentifizierung aus Gr\u00fcnden der Einfachheit oder Legacy-Kompatibilit\u00e4t.</p>"},{"location":"exercises/ex6-protocol-discovery.html#opc-ua-verkehr-generieren","title":"OPC-UA-Verkehr generieren","text":"<p>Die Lab-SPSen haben OPC-UA-Server auf Port 4840 aktiviert:</p> <ul> <li><code>ctrlx-plc3-vlan20</code> unter <code>10.20.0.11:4840</code></li> <li><code>schneider-plc4-vlan30</code> unter <code>10.30.0.11:4840</code></li> </ul> <p>Wir m\u00fcssen OPC-UA-Verkehr generieren, um ihn zu analysieren. Der einfachste Ansatz ist die Nutzung des HMI-Webbrowsers.</p> <p>Verkehr vom HMI generieren</p> <ol> <li> <p>\u00d6ffnen Sie unter Ports: HMI-Chromium-Browser</p> </li> <li> <p>Gehen sie zum Cheat Sheet</p> </li> <li> <p>Navigieren Sie zu: <code>http://10.20.0.11:8080/webvisu.htm</code></p> </li> <li>Die WebVisu kann im Hintergrund \u00fcber OPC UA mit der SPS kommunizieren</li> <li>Interagieren Sie mit der Visualisierung, um Verkehr zu generieren</li> </ol> <p>Alternative: Verbindung vom Jumphost testen</p> <p>Falls Sie Terminal-Zugriff auf den Jumphost haben, pr\u00fcfen Sie, ob der OPC-UA-Port erreichbar ist:</p> <pre><code># Konnektivit\u00e4t testen\nnc -zv 10.20.0.11 4840\n\n# Einfache Verbindungsprobe senden\ntimeout 2 telnet 10.20.0.11 4840\n</code></pre> <p>Sie sollten eine etablierte Verbindung sehen, die best\u00e4tigt, dass der OPC-UA-Server l\u00e4uft.</p>"},{"location":"exercises/ex6-protocol-discovery.html#opc-ua-verkehr-erfassen","title":"OPC-UA-Verkehr erfassen","text":"<ol> <li>Starten Sie die Wireshark-Erfassung auf der Verbindung zwischen <code>ctrlx-plc3-vlan20</code> und <code>sw-acc1</code></li> <li>F\u00fchren Sie die OPC-UA-Client-Verbindung aus (Option oben)</li> <li>Stoppen Sie die Erfassung nach Abschluss der Verbindung</li> </ol>"},{"location":"exercises/ex6-protocol-discovery.html#sicherheitskonfiguration-analysieren","title":"Sicherheitskonfiguration analysieren","text":"<ol> <li> <p>Filtern Sie nach OPC-UA-Verkehr:</p> <pre><code>opcua\n</code></pre> <p>Oder nach Port:</p> <pre><code>tcp.port == 4840\n</code></pre> </li> <li> <p>Finden Sie das CreateSessionRequest-Paket:</p> <ul> <li>Erweitern: <code>OpcUa Binary Protocol -&gt; Message -&gt; CreateSessionRequest</code></li> <li>Finden: <code>SecurityPolicyUri</code></li> <li>Wert pr\u00fcfen: <code>http://opcfoundation.org/UA/SecurityPolicy#None</code> bedeutet keine Verschl\u00fcsselung</li> </ul> </li> <li> <p>Finden Sie das ActivateSessionRequest-Paket:</p> <ul> <li>Erweitern: <code>OpcUa Binary Protocol -&gt; Message -&gt; ActivateSessionRequest</code></li> <li>Pr\u00fcfen: <code>UserIdentityToken</code></li> <li>Suchen nach: <code>AnonymousIdentityToken</code> bedeutet keine Authentifizierung</li> </ul> </li> <li> <p>Analysieren Sie eine BrowseRequest/Response:</p> <ul> <li>Dies zeigt die komplette Tag-Struktur der SPS</li> <li>Alle Tag-Namen sind im Klartext sichtbar</li> <li>Ein Angreifer kann das komplette Prozessdatenmodell abbilden</li> </ul> </li> <li> <p>Schauen Sie sich ReadRequest/Response an:</p> <ul> <li>Variablenwerte werden im Klartext \u00fcbertragen</li> <li>Kein Integrit\u00e4tsschutz</li> <li>Ein Angreifer kann Echtzeit-Prozesswerte sehen</li> </ul> </li> </ol>"},{"location":"exercises/ex6-protocol-discovery.html#bewertungsfragen","title":"Bewertungsfragen","text":"<ol> <li>Welche SecurityPolicy ist konfiguriert? (Erwartet: None)</li> <li>Ist die Kommunikation verschl\u00fcsselt? (Erwartet: Nein)</li> <li>Welche Authentifizierung wird ben\u00f6tigt? (Erwartet: Anonymous - keine)</li> <li>K\u00f6nnen Sie Tag-Namen in der Browse-Response sehen? (Erwartet: Ja)</li> <li>K\u00f6nnen Sie Variablenwerte in Read-Responses sehen? (Erwartet: Ja)</li> <li>Welche IEC-62443-Anforderungen werden verletzt?<ul> <li>SR 1.1: Identifikation und Authentifizierung (FAIL - Anonymous)</li> <li>SR 3.1: Kommunikationsintegrit\u00e4t (FAIL - keine Signierung)</li> <li>SR 4.1: Informationsvertraulichkeit (FAIL - keine Verschl\u00fcsselung)</li> </ul> </li> </ol>"},{"location":"exercises/ex6-protocol-discovery.html#praxisbezug","title":"Praxisbezug","text":"<p>Dies ist einer der h\u00e4ufigsten Befunde in OT-Sicherheitsaudits. OPC UA hat ausgezeichnete Sicherheitsfunktionen, aber Organisationen deaktivieren sie, weil:</p> <ul> <li>Konfigurationskomplexit\u00e4t (wahrgenommen, nicht tats\u00e4chlich)</li> <li>Legacy-Kompatibilit\u00e4tsbedenken (manchmal berechtigt)</li> <li>Performance-Mythen (Verschl\u00fcsselungs-Overhead ist auf moderner Hardware vernachl\u00e4ssigbar)</li> <li>Mangelndes Bewusstsein (h\u00e4ufigster Grund)</li> </ul> <p>Audit-Empfehlung: Aktivieren Sie OPC-UA-Sicherheit mit <code>SecurityPolicy=Basic256Sha256</code>, <code>SecurityMode=SignAndEncrypt</code> und zertifikatbasierter Authentifizierung. Testen Sie mit bestehenden Clients, um Kompatibilit\u00e4t zu pr\u00fcfen.</p>"},{"location":"exercises/ex6-protocol-discovery.html#aufgabe-6-profinet-protokoll-erkennung","title":"Aufgabe 6: PROFINET-Protokoll-Erkennung","text":"<p>PROFINET ist das dominierende Echtzeit-Industrie-Ethernet-Protokoll in der europ\u00e4ischen Fertigung, insbesondere in der Automobil- und Prozessindustrie. Im Gegensatz zu den vorherigen Protokollen, die auf TCP/IP-Schichten operieren, l\u00e4uft PROFINET-Echtzeit-Verkehr direkt auf Layer 2 (Ethernet-Frames) f\u00fcr Mikrosekunden-genaue Steuerung.</p>"},{"location":"exercises/ex6-protocol-discovery.html#wesentliche-unterschiede","title":"Wesentliche Unterschiede","text":"Aspekt Modbus/OPC UA PROFINET RT OSI-Schicht Layer 4 (TCP) Layer 2 (Ethernet) Routbar? Ja Nein (ben\u00f6tigt L2-Nachbarschaft) Verschl\u00fcsselung M\u00f6glich Nein (Echtzeit-Einschr\u00e4nkungen) \u00dcberwachung Gerouteter TAP SPAN-Port erforderlich"},{"location":"exercises/ex6-protocol-discovery.html#warum-dies-wichtig-ist","title":"Warum dies wichtig ist","text":"<p>Das Verst\u00e4ndnis von Layer-2-Protokollen \u00e4ndert Ihren Sicherheitsbewertungsansatz:</p> <ul> <li>Keine Segmentierung \u00fcber Subnetze - PROFINET ben\u00f6tigt L2-Nachbarschaft</li> <li>Keine Verschl\u00fcsselung - Echtzeit-Performance-Anforderungen (Sub-Millisekunden-Latenz)</li> <li>Andere IDS-Platzierung - SPAN-Ports verwenden, keine gerouteten TAPs</li> <li>Sicherheit ist architektonisch - Physische Zugriffskontrolle, VLAN-Isolation, Anomalieerkennung</li> </ul>"},{"location":"exercises/ex6-protocol-discovery.html#profinet-verkehr-erfassen","title":"PROFINET-Verkehr erfassen","text":"<p>Das ABB-800xA-System (<code>abb-800xa-vlan40</code> unter <code>10.40.0.11</code>) hat aktive PROFINET-Echtzeit-Kommunikation.</p> <ol> <li> <p>Gehen Sie in VS Code zur Containerlab-Erweiterung (TopoViewer)</p> </li> <li> <p>Lokalisieren Sie die Verbindung zwischen <code>abb-800xa-vlan40</code> und <code>sw-acc2</code></p> </li> <li> <p>Klicken Sie mit der rechten Maustaste auf die Verbindung und w\u00e4hlen Sie Wireshark Capture</p> </li> <li> <p>Lassen Sie es 10-15 Sekunden erfassen, um PROFINET-Frames zu sammeln</p> </li> <li> <p>Stoppen Sie die Erfassung</p> </li> </ol>"},{"location":"exercises/ex6-protocol-discovery.html#profinet-echtzeit-verkehr-analysieren","title":"PROFINET-Echtzeit-Verkehr analysieren","text":"<p>Filter f\u00fcr PROFINET:</p> <pre><code># PROFINET-Echtzeit-Verkehr\neth.type == 0x8892\n</code></pre> <p>Oder im Wireshark-Display-Filter:</p> <pre><code>pn_io\n</code></pre> <p>Was Sie sehen sollten:</p> <ol> <li> <p>Ethertype 0x8892 - Echtzeit-Zyklus-I/O-Daten</p> <ul> <li>Keine TCP/IP-Header (dies ist Layer 2, nicht TCP/IP)</li> <li>Direkte Ethernet-Frames</li> <li>Quell-/Ziel-MAC-Adressen sichtbar</li> </ul> </li> <li> <p>FrameID in hex (typischerweise 0x8000-0x8001)</p> <ul> <li>0x8000-Bereich = RT-Zyklus-Daten</li> <li>Schauen Sie sich die Paketdetails f\u00fcr das FrameID-Feld an</li> </ul> </li> <li> <p>Zyklisches Muster</p> <ul> <li>PROFINET RT l\u00e4uft in festen Intervallen (typischerweise 1-10ms)</li> <li>In diesem Lab: ca. 4ms Zykluszeit</li> <li>Paket-Timing ist extrem regelm\u00e4ssig</li> <li>W\u00e4hlen Sie mehrere Pakete und pr\u00fcfen Sie das Zeitdelta zwischen ihnen</li> </ul> </li> <li> <p>Nutzdaten</p> <ul> <li>Rohe I/O-Daten (digital/analoge Werte)</li> <li>Keine Verschl\u00fcsselung m\u00f6glich (Echtzeit-Performance-Anforderung)</li> <li>Prozesswerte werden im Klartext \u00fcbertragen</li> </ul> </li> </ol>"},{"location":"exercises/ex6-protocol-discovery.html#bewertungsfragen_1","title":"Bewertungsfragen","text":"<ol> <li>Was ist der Ethertype? (Erwartet: 0x8892)</li> <li>Gibt es TCP/IP-Header? (Erwartet: Nein - dies ist Layer 2)</li> <li>Was ist die ungef\u00e4hre Zykluszeit? (Zeit zwischen Paketen messen - sollte ~4ms sein)</li> <li>K\u00f6nnen Sie MAC-Adressen sehen? (Erwartet: Ja - 00:03:2c:40:00:11 und 00:0b:0f:20:00:11)</li> <li>Sind die Daten verschl\u00fcsselt? (Erwartet: Nein - kann Echtzeit-Verkehr nicht verschl\u00fcsseln)</li> <li>Was passiert, wenn Sie nach <code>tcp</code> oder <code>udp</code> filtern? (Erwartet: PROFINET RT erscheint nicht - es ist Layer 2)</li> </ol>"},{"location":"exercises/ex6-protocol-discovery.html#sicherheitsimplikationen","title":"Sicherheitsimplikationen","text":"<p>Angriffsszenarien:</p> <ul> <li>Aufkl\u00e4rung: DCP-Broadcasts offenbaren alle Ger\u00e4te, Hersteller, Firmware-Versionen</li> <li>Topologie-Mapping: LLDP (oft mit PROFINET verwendet) exponiert Netzwerkarchitektur</li> <li>Paket-Injektion: Angreifer im selben L2-Segment kann RT-Frames f\u00e4lschen</li> <li>Timing-Angriffe: St\u00f6rung des zyklischen Timings kann Notabschaltungen verursachen</li> </ul> <p>Verteidigungsanforderungen:</p> <ul> <li>Physische Sicherheit: L2-Zugriff sch\u00fctzen (Switch-Ports)</li> <li>VLAN-Isolation: PROFINET-Dom\u00e4nen trennen</li> <li>Port-Security: MAC-Adressen-Filterung auf Switches</li> <li>Anomalieerkennung: Auf Timing-Unregelm\u00e4ssigkeiten, unerwartete Ger\u00e4te \u00fcberwachen</li> <li>Keine Anwendungsschicht-Sicherheit: Kann keine Verschl\u00fcsselung, TLS usw. verwenden</li> </ul> <p>IEC-62443-Kontext:</p> <p>PROFINET entstand vor IEC 62443 und wurde f\u00fcr Performance, nicht f\u00fcr Sicherheit entwickelt. Sicherheit muss durch Folgendes implementiert werden:</p> <ul> <li>Netzwerkarchitektur (Zonen und Leitungen)</li> <li>Physische Zugriffskontrolle</li> <li>\u00dcberwachung und Erkennung (nicht Pr\u00e4vention auf Protokollebene)</li> </ul>"},{"location":"exercises/ex6-protocol-discovery.html#aufgabe-7-protokollvergleich-und-sicherheitsbewertung","title":"Aufgabe 7: Protokollvergleich und Sicherheitsbewertung","text":"<p>Nachdem Sie mehrere OT-Protokolle analysiert haben, vergleichen Sie deren Sicherheitsmerkmale und verstehen Sie, wann Sie jedes in realen Umgebungen antreffen werden.</p>"},{"location":"exercises/ex6-protocol-discovery.html#protokollvergleichs-matrix","title":"Protokollvergleichs-Matrix","text":"Protokoll Schicht Port/Typ Verschl\u00fcsselung Auth Hauptanwendungsfall Sicherheitsansatz Modbus TCP L4 TCP 502 Nein Nein Legacy-SCADA, einfaches SPS-Polling Segmentierung, \u00dcberwachung, Modbus/TLS erw\u00e4gen CODESYS L4 TCP/UDP 1217, 2455 Optional Optional SPS-Engineering, Diagnose In Produktion deaktivieren, nur w\u00e4hrend Wartung verwenden OPC UA L4 TCP 4840 Ja (oft deaktiviert) Ja (oft deaktiviert) Vertikale Integration, MES/SCADA, Industrie 4.0 Integrierte Sicherheitsfunktionen aktivieren PROFINET RT L2 Ethernet 0x8892 Nein (unm\u00f6glich) Nein Echtzeit-I/O-Steuerung, Automotive, diskrete Fertigung Physische + architektonische Kontrollen"},{"location":"exercises/ex6-protocol-discovery.html#kritische-bewertungsfragen","title":"Kritische Bewertungsfragen","text":"<p>F\u00fcr jedes in einer OT-Umgebung entdeckte Protokoll fragen:</p> <ol> <li> <p>Ist dieses Protokoll notwendig?</p> <ul> <li>CODESYS-Engineering-Ports sollten in der Produktion deaktiviert sein</li> <li>Modbus kann Legacy sein und durch OPC UA ersetzt werden</li> </ul> </li> <li> <p>Ist die Sicherheit optimal konfiguriert?</p> <ul> <li>OPC UA: SecurityPolicy und Authentifizierung sollten aktiviert sein</li> <li>Modbus: Upgrade auf Modbus/TLS oder Einbindung in VPN erw\u00e4gen</li> </ul> </li> <li> <p>Ist die Netzwerkarchitektur angemessen?</p> <ul> <li>Alle Protokolle: Ordentliche VLAN-Segmentierung</li> <li>PROFINET: Muss L2-Isolation haben, kann nicht routen</li> <li>OPC UA: Kann routen, Firewall-Regeln zwischen Zonen ber\u00fccksichtigen</li> </ul> </li> <li> <p>Ist \u00dcberwachung vorhanden?</p> <ul> <li>Modbus/OPC UA: Kann auf L3/L4 \u00fcberwachen (gerouteter TAP oder Firewall-Logs)</li> <li>PROFINET: Ben\u00f6tigt L2-SPAN-Port zum Switch</li> <li>Alle: Normales Verhalten als Baseline, bei Anomalien alarmieren</li> </ul> </li> </ol>"},{"location":"exercises/ex6-protocol-discovery.html#audit-checkliste","title":"Audit-Checkliste","text":"<p>Bei der Bewertung einer OT-Umgebung:</p> <ul> <li>[ ] Alle verwendeten Protokolle inventarisieren (Wireshark auf SPAN-Ports)</li> <li>[ ] F\u00fcr OPC UA: Pr\u00fcfen, dass SecurityPolicy NICHT None ist</li> <li>[ ] F\u00fcr OPC UA: Pr\u00fcfen, dass Authentifizierung erforderlich ist (nicht Anonymous)</li> <li>[ ] F\u00fcr Modbus: Netzwerksegmentierung verhindert unbefugten Zugriff pr\u00fcfen</li> <li>[ ] F\u00fcr CODESYS: Engineering-Ports sind deaktiviert oder zugriffskontrolliert pr\u00fcfen</li> <li>[ ] F\u00fcr PROFINET: VLAN-Isolation und Port-Security pr\u00fcfen</li> <li>[ ] F\u00fcr alle: \u00dcberwachung/IDS ist vorhanden und auf OT-Protokolle abgestimmt pr\u00fcfen</li> <li>[ ] Befunde mit spezifischen IEC-62443-SR-Verletzungen dokumentieren</li> </ul>"},{"location":"exercises/ex6-protocol-discovery.html#iec-62443-sicherheitsanforderungs-mapping","title":"IEC-62443-Sicherheitsanforderungs-Mapping","text":"SR Anforderung Modbus TCP OPC UA (Fehlkonfiguriert) OPC UA (Korrekt) PROFINET SR 1.1 Benutzeridentifikation Nicht anwendbar FAIL (Anonymous) PASS (Zertifikat) Nicht anwendbar SR 3.1 Kommunikationsintegrit\u00e4t FAIL (kein Schutz) FAIL (keine Signierung) PASS (Signiert) FAIL (kein Schutz) SR 4.1 Informationsvertraulichkeit FAIL (Klartext) FAIL (keine Verschl\u00fcsselung) PASS (Verschl\u00fcsselt) FAIL (unm\u00f6glich) SR 5.1 Netzwerksegmentierung Erforderlich Erforderlich Empfohlen Kritisch"},{"location":"exercises/ex6-protocol-discovery.html#fazit-verteidigung-in-der-tiefe","title":"Fazit: Verteidigung in der Tiefe","text":"<p>Keine einzelne Protokollsicherheitsfunktion bietet vollst\u00e4ndigen Schutz. OT-Sicherheit erfordert:</p> <ol> <li>Protokollebenen-Sicherheit (wo verf\u00fcgbar) - OPC-UA-Sicherheitsfunktionen aktivieren</li> <li>Netzwerkarchitektur - Ordentliche Segmentierung, VLANs, Zugriffskontrolle</li> <li>\u00dcberwachung und Erkennung - Normales Verhalten als Baseline, bei Anomalien alarmieren</li> <li>Physische Sicherheit - Besonders f\u00fcr L2-Protokolle wie PROFINET</li> <li>Zugriffsverwaltung - Unn\u00f6tige Dienste deaktivieren (CODESYS in Produktion)</li> </ol> <p>Wichtigste Erkenntnis: Legacy-Protokolle (Modbus) erfordern kompensierende Kontrollen. Moderne Protokolle (OPC UA) haben Sicherheitsfunktionen, die aktiviert werden m\u00fcssen. Echtzeit-Protokolle (PROFINET) erfordern architektonische Sicherheit, da Protokollebenen-Sicherheit nicht m\u00f6glich ist.</p>"},{"location":"exercises/ex6-protocol-discovery.html#fazit","title":"Fazit","text":"<p>Diese \u00dcbung demonstrierte die Sicherheitsrealit\u00e4t von OT-Protokollen:</p> <ul> <li>Legacy-Protokolle (Modbus) haben keine Sicherheitsfunktionen - verlassen sich auf Segmentierung und \u00dcberwachung</li> <li>Moderne Protokolle (OPC UA) haben ausgezeichnete Sicherheitsfunktionen, die oft deaktiviert sind - auditieren und aktivieren</li> <li>Echtzeit-Protokolle (PROFINET) k\u00f6nnen keine Verschl\u00fcsselung verwenden - erfordern architektonische Kontrollen</li> <li>Alle Protokolle profitieren von Netzwerksegmentierung, \u00dcberwachung und ordentlicher Zugriffskontrolle</li> </ul> <p>Als OT-Sicherheitsexperte ist Ihre Rolle:</p> <ol> <li>Inventarisieren, welche Protokolle verwendet werden</li> <li>Ihre Sicherheitskonfiguration bewerten</li> <li>L\u00fccken gegen\u00fcber IEC-62443-Anforderungen identifizieren</li> <li>Praktische, betriebsfreundliche Massnahmen empfehlen</li> <li>\u00dcberwachung implementieren, um unbefugte Protokollnutzung zu erkennen</li> </ol> <p>Die heute analysierten Protokolle repr\u00e4sentieren 80% dessen, was Sie in realen Industrieumgebungen antreffen werden. Das Verst\u00e4ndnis ihrer Sicherheitsmerkmale ist grundlegend f\u00fcr eine effektive OT-Sicherheitsbewertung.</p>"},{"location":"exercises/ex6-protocol-discovery.html#losung","title":"L\u00f6sung","text":"Zum Anzeigen der L\u00f6sung klicken <p>```</p>"},{"location":"exercises/ex6-protocol-discovery.html#aufgabe-1-ot-verkehr-generieren_1","title":"Aufgabe 1: OT-Verkehr generieren","text":"<p>Im HMI-Desktop Chromium \u00f6ffnen und zur WebVisu navigieren: <pre><code>http://10.10.0.11:8080/webvisu.htm\n</code></pre></p> <p>Interagieren Sie mit Buttons und Schaltern in der Visualisierung, um HTTP- und m\u00f6glicherweise Modbus-Verkehr zu generieren.</p>"},{"location":"exercises/ex6-protocol-discovery.html#aufgabe-2-verkehr-erfassen","title":"Aufgabe 2: Verkehr erfassen","text":"<ol> <li>In VS Code Containerlab TopoViewer \u00f6ffnen</li> <li>Rechtsklick auf Verbindung zwischen <code>wago-plc2a-vlan10</code> und <code>sw-acc1</code></li> <li>\"Wireshark Capture\" w\u00e4hlen</li> <li>Im HMI erneut mit WebVisu interagieren</li> <li>Verkehr in Wireshark beobachten</li> </ol>"},{"location":"exercises/ex6-protocol-discovery.html#aufgabe-3-modbus-tcp-analysieren_1","title":"Aufgabe 3: Modbus TCP analysieren","text":"<p>Wireshark-Filter anwenden: <pre><code>mbtcp\n</code></pre></p> <p>Oder alternativ: <pre><code>tcp.port == 502\n</code></pre></p> <p>Erwartete Beobachtungen:</p> <ul> <li>Function Codes: Typischerweise Read Holding Registers (0x03), Write Single Coil (0x05), Write Multiple Registers (0x10)</li> <li>Werte sichtbar: Ja - alle Registerwerte sind im Klartext sichtbar</li> <li>Verschl\u00fcsselung: Nein - Modbus TCP hat keine Verschl\u00fcsselung</li> <li>Authentifizierung: Nein - keine Authentifizierung im Protokoll</li> </ul> <p>Sicherheitsimplikation: Ein Angreifer im selben Netzwerksegment kann: - Alle Prozesswerte lesen - Befehle an die SPS senden - Verkehr manipulieren (Man-in-the-Middle)</p> <p>Vom Jumphost k\u00f6nnen Sie die Modbus-Konnektivit\u00e4t testen: <pre><code>ssh admin@192.168.100.52\nnc -zv 10.10.0.11 502\n</code></pre></p> <p>Erwartete Ausgabe: <pre><code>Connection to 10.10.0.11 502 port [tcp/*] succeeded!\n</code></pre></p>"},{"location":"exercises/ex6-protocol-discovery.html#aufgabe-4-codesys-protokoll-analysieren_1","title":"Aufgabe 4: CODESYS-Protokoll analysieren","text":"<p>Filter f\u00fcr HTTP-Verkehr zur WebVisu: <pre><code>http &amp;&amp; ip.addr == 10.10.0.11\n</code></pre></p> <p>HTTP-Stream folgen: - Rechtsklick auf HTTP-Paket - Follow \u2192 HTTP Stream - Beobachten Sie Visualisierungsdaten im Klartext</p> <p>Erwartete Beobachtungen: - WebVisu verwendet HTTP (Port 8080) - Keine HTTPS-Verschl\u00fcsselung - Variablenwerte und Status im Klartext - Session-Informationen exponiert</p> <p>F\u00fcr CODESYS-Runtime-Protokoll (normalerweise von Engineering-Workstation): <pre><code>udp.port == 2455 || tcp.port == 1217\n</code></pre></p> <p>Im Lab sehen Sie m\u00f6glicherweise wenig CODESYS-Runtime-Verkehr, da keine Engineering-Workstation aktiv programmiert.</p> <p>Port-\u00dcbersicht auf der SPS:</p> <p>Sie k\u00f6nnen die offenen Ports vom Jumphost oder von der SPS selbst pr\u00fcfen: <pre><code>ssh admin@192.168.100.53  # wago-plc2a-vlan10\nss -tuln | grep LISTEN\n</code></pre></p> <p>Erwartete Ausgabe: <pre><code>tcp   LISTEN 0      5              0.0.0.0:8080       0.0.0.0:*    # WebVisu\ntcp   LISTEN 0      128            0.0.0.0:22         0.0.0.0:*    # SSH\ntcp   LISTEN 0      63          10.10.0.11:502        0.0.0.0:*    # Modbus\ntcp   LISTEN 0      10          10.10.0.11:4840       0.0.0.0:*    # OPC UA\n</code></pre></p>"},{"location":"exercises/ex6-protocol-discovery.html#aufgabe-5-opc-ua-sicherheitskonfiguration-analysieren_1","title":"Aufgabe 5: OPC-UA-Sicherheitskonfiguration analysieren","text":"<p>OPC-UA-Verkehr generieren:</p> <p>Option 1 - Vom HMI-Browser: <pre><code>http://10.20.0.11:8080/webvisu.htm  # ctrlx-plc3-vlan20\n</code></pre></p> <p>Option 2 - Konnektivit\u00e4t vom Jumphost testen: <pre><code>ssh admin@192.168.100.52\nnc -zv 10.20.0.11 4840\n</code></pre></p> <p>Erwartete Ausgabe: <pre><code>Connection to 10.20.0.11 4840 port [tcp/*] succeeded!\n</code></pre></p> <p>Wireshark-Analyse:</p> <p>Erfassen Sie Verkehr zwischen <code>ctrlx-plc3-vlan20</code> und <code>sw-acc1</code>.</p> <p>Filter f\u00fcr OPC UA: <pre><code>opcua\n</code></pre></p> <p>Oder: <pre><code>tcp.port == 4840\n</code></pre></p> <p>CreateSessionRequest analysieren:</p> <p>Erweitern: <code>OpcUa Binary Protocol \u2192 Message \u2192 CreateSessionRequest</code></p> <p>Suchen: <code>SecurityPolicyUri</code></p> <p>Erwarteter Wert: <pre><code>http://opcfoundation.org/UA/SecurityPolicy#None\n</code></pre></p> <p>Bedeutung: Keine Verschl\u00fcsselung aktiviert.</p> <p>ActivateSessionRequest analysieren:</p> <p>Erweitern: <code>OpcUa Binary Protocol \u2192 Message \u2192 ActivateSessionRequest</code></p> <p>Suchen: <code>UserIdentityToken</code></p> <p>Erwarteter Typ: <pre><code>AnonymousIdentityToken\n</code></pre></p> <p>Bedeutung: Keine Authentifizierung erforderlich.</p> <p>BrowseRequest/Response analysieren:</p> <ul> <li>Komplette OPC-UA-Node-Struktur ist sichtbar</li> <li>Alle Tag-Namen im Klartext</li> <li>Organisationsstruktur des Prozessdatenmodells exponiert</li> <li>Ein Angreifer kann vollst\u00e4ndiges Asset-Inventar erstellen</li> </ul> <p>ReadRequest/Response analysieren:</p> <ul> <li>Variablenwerte im Klartext \u00fcbertragen</li> <li>Keine Integrit\u00e4tspr\u00fcfung</li> <li>Keine Vertraulichkeit</li> <li>Echtzeit-Prozessdaten f\u00fcr Angreifer sichtbar</li> </ul> <p>Bewertungsergebnisse:</p> <ol> <li>SecurityPolicy: None (FAIL)</li> <li>Verschl\u00fcsselung: Nein (FAIL)</li> <li>Authentifizierung: Anonymous (FAIL)</li> <li>Tag-Namen sichtbar: Ja (FAIL)</li> <li>Variablenwerte sichtbar: Ja (FAIL)</li> </ol> <p>IEC-62443-Verletzungen:</p> <ul> <li>SR 1.1 (Identifikation &amp; Authentifizierung): FAIL</li> <li>SR 3.1 (Kommunikationsintegrit\u00e4t): FAIL</li> <li>SR 4.1 (Informationsvertraulichkeit): FAIL</li> </ul> <p>Empfehlung:</p> <p>OPC-UA-Server-Konfiguration \u00e4ndern: <pre><code>SecurityPolicy: Basic256Sha256\nSecurityMode: SignAndEncrypt\nAuthentication: Certificate-based\n</code></pre></p>"},{"location":"exercises/ex6-protocol-discovery.html#aufgabe-6-profinet-protokoll-erkennung_1","title":"Aufgabe 6: PROFINET-Protokoll-Erkennung","text":"<p>PROFINET-Verkehr erfassen:</p> <p>Erfassen Sie Verkehr zwischen <code>abb-800xa-vlan40</code> und <code>sw-acc2</code>.</p> <p>Wireshark-Filter:</p> <pre><code>eth.type == 0x8892\n</code></pre> <p>Oder: <pre><code>pn_io\n</code></pre></p> <p>Erwartete Beobachtungen:</p> <ol> <li>Ethertype: 0x8892 (PROFINET Echtzeit)</li> <li>Keine TCP/IP-Header: Dies ist Layer 2, nicht Layer 4</li> <li>FrameID: Typischerweise 0x8000-0x8001 (RT-Zyklus-Daten)</li> <li>Zyklisches Muster: Pakete alle ~4ms (sehr regelm\u00e4ssig)</li> <li>MAC-Adressen sichtbar:</li> <li>Quelle: 00:03:2c:40:00:11 (ABB-System)</li> <li>Ziel: 00:0b:0f:20:00:11 (PROFINET-Ger\u00e4t)</li> </ol> <p>Timing-Analyse:</p> <p>W\u00e4hlen Sie mehrere aufeinanderfolgende PROFINET-Pakete und pr\u00fcfen Sie das Zeitdelta:</p> <p>In Wireshark: - View \u2192 Time Display Format \u2192 Seconds Since Previous Displayed Packet - Erwartung: ~0.004 Sekunden (4ms Zykluszeit)</p> <p>Bewertungsergebnisse:</p> <ol> <li>Ethertype: 0x8892 (Layer 2 Echtzeit)</li> <li>TCP/IP-Header: Nein - direkter Ethernet-Frame</li> <li>Zykluszeit: ~4ms (sehr deterministisch)</li> <li>MAC-Adressen: Ja, sichtbar</li> <li>Verschl\u00fcsselung: Nein - unm\u00f6glich bei Echtzeit</li> <li>Nach tcp/udp filtern: PROFINET RT erscheint nicht</li> </ol> <p>Sicherheitsimplikationen:</p> <ul> <li>Kein Routing m\u00f6glich (Layer 2)</li> <li>Keine Verschl\u00fcsselung m\u00f6glich</li> <li>Physischer Zugang = volle Kontrolle</li> <li>VLAN-Isolation ist kritisch</li> <li>Port Security erforderlich</li> <li>Anomalieerkennung basierend auf Timing</li> </ul> <p>PROFINET DCP (Discovery):</p> <p>F\u00fcr PROFINET-Ger\u00e4teerkennung: <pre><code>pn_dcp\n</code></pre></p> <p>DCP-Broadcasts offenbaren: - Ger\u00e4tename - Hersteller - IP-Konfiguration - Rolle im Netzwerk</p>"},{"location":"exercises/ex6-protocol-discovery.html#aufgabe-7-protokollvergleich","title":"Aufgabe 7: Protokollvergleich","text":"<p>Zusammenfassung der Analyse:</p> Protokoll Verschl\u00fcsselung Auth Hauptrisiko Verteidigung Modbus TCP Nein Nein Klartext-Zugriff Segmentierung + \u00dcberwachung CODESYS Optional, meist Nein Optional Engineering-Zugriff In Produktion deaktivieren OPC UA Ja (oft deaktiviert) Ja (oft deaktiviert) Fehlkonfiguration Sicherheitsfunktionen aktivieren PROFINET RT Unm\u00f6glich Nein Layer-2-Angriffe Physische + VLAN-Isolation <p>Audit-Checkliste erf\u00fcllt:</p> <ul> <li>[x] Protokolle inventarisiert (Modbus, OPC UA, PROFINET, HTTP)</li> <li>[x] OPC-UA-SecurityPolicy gepr\u00fcft (None = FAIL)</li> <li>[x] OPC-UA-Authentifizierung gepr\u00fcft (Anonymous = FAIL)</li> <li>[x] Modbus-Segmentierung gepr\u00fcft</li> <li>[x] CODESYS-Ports identifiziert (sollten deaktiviert sein)</li> <li>[x] PROFINET-VLAN-Isolation gepr\u00fcft</li> <li>[x] IEC-62443-Verletzungen dokumentiert</li> </ul> <p>Wichtigste Erkenntnisse:</p> <ol> <li>Legacy-Protokolle (Modbus): Keine Sicherheitsfunktionen \u2192 Kompensierende Kontrollen erforderlich</li> <li>Moderne Protokolle (OPC UA): Sicherheit vorhanden, aber oft deaktiviert \u2192 Audit und Aktivierung erforderlich</li> <li>Echtzeit-Protokolle (PROFINET): Verschl\u00fcsselung unm\u00f6glich \u2192 Architektonische Sicherheit kritisch</li> <li>Alle Protokolle: Profitieren von Segmentierung, \u00dcberwachung und Zugriffskontrolle</li> </ol> <p>N\u00e4chste Schritte:</p> <ol> <li>OPC-UA-Sicherheitsfunktionen aktivieren (h\u00f6chste Priorit\u00e4t)</li> <li>Netzwerksegmentierung durchsetzen (siehe \u00dcbung 7)</li> <li>CODESYS-Engineering-Ports f\u00fcr Produktion deaktivieren</li> <li>IDS/IPS f\u00fcr OT-Protokoll-Anomalien implementieren</li> <li>Regelm\u00e4ssige Protokoll-Audits durchf\u00fchren</li> </ol>"},{"location":"exercises/ex7-segmentation-firewall.html","title":"\u00dcbung 7: Netzwerksegmentierung und Firewall-Design","text":"<p>Zeitsch\u00e4tzung: 35-45 Minuten Lab-Topologie: <code>ot-sec-segmented</code> (prim\u00e4r), <code>ot-sec-flat</code> (Vergleich) Schwierigkeit:  Fortgeschritten bis Experte</p>"},{"location":"exercises/ex7-segmentation-firewall.html#lernziele","title":"Lernziele","text":"<ul> <li>Zonenbasierte Segmentierung verstehen (Purdue-Modell-Konzepte)</li> <li>Kommunikationsmatrix f\u00fcr OT-Ger\u00e4te erstellen</li> <li>Firewall-Regeln entwerfen, um Verkehr auf notwendige Protokolle zu beschr\u00e4nken</li> <li>Sicherheitslage von flachen vs. segmentierten Netzwerken vergleichen</li> </ul>"},{"location":"exercises/ex7-segmentation-firewall.html#voraussetzungen","title":"Voraussetzungen","text":"<ul> <li>\u00dcbung 1 &amp; 6</li> <li>Grundverst\u00e4ndnis von Firewalls</li> </ul>"},{"location":"exercises/ex7-segmentation-firewall.html#szenario","title":"Szenario","text":"<p>In der <code>ot-sec-flat</code>-Topologie befanden sich alle Ger\u00e4te in derselben Broadcast-Dom\u00e4ne. Wenn ein Ger\u00e4t kompromittiert wurde, konnte der Angreifer auf alles zugreifen. In <code>ot-sec-segmented</code> haben wir VLANs, die Funktionen trennen: - VLAN 10 (Hygiene): SPSen - VLAN 20 (Prozess): SPSen - VLAN 40 (Leitwarte): HMI - VLAN 50 (Engineering): Workstations</p> <p>Segmentierung allein reicht jedoch nicht aus, wenn die Firewall allen Verkehr zwischen Zonen erlaubt. Wir m\u00fcssen \"Least Privilege\" implementieren.</p>"},{"location":"exercises/ex7-segmentation-firewall.html#aufgaben","title":"Aufgaben","text":""},{"location":"exercises/ex7-segmentation-firewall.html#aufgabe-1-kommunikationsflusse-kartieren","title":"Aufgabe 1: Kommunikationsfl\u00fcsse kartieren","text":"<ol> <li> <p>Identifizieren Sie die legitimen Kommunikationspfade, die f\u00fcr den Betrieb der Anlage notwendig sind:</p> <ul> <li>HMI (VLAN 40) muss Daten von SPSen (VLAN 10, 20, 30) lesen/schreiben.</li> <li>Engineering-Station (VLAN 50) muss SPSen programmieren.</li> <li>SPSen ben\u00f6tigen normalerweise keinen Zugang zum Internet.</li> <li>SPSen m\u00fcssen m\u00f6glicherweise miteinander kommunizieren (Inter-Controller-Kommunikation).</li> </ul> </li> <li> <p>Frage: Muss das HMI per SSH in die SPS? Muss es sie anpingen? Muss es auf den Webserver zugreifen?</p> <ul> <li>Antwort: Typischerweise ben\u00f6tigt HMI nur Modbus TCP (502) oder ein propriet\u00e4res Protokoll (z.B. 1217/2455 f\u00fcr CODESYS). WebVisu verwendet HTTP (80/8080).</li> </ul> </li> </ol>"},{"location":"exercises/ex7-segmentation-firewall.html#aufgabe-2-kommunikationsmatrix-erstellen","title":"Aufgabe 2: Kommunikationsmatrix erstellen","text":"<p>Eine Kommunikationsmatrix definiert erlaubten Verkehr. F\u00fcllen Sie die unten stehende Tabelle aus (gedanklich oder auf Papier):</p> Quelle Ziel Protokoll Port Aktion HMI (10.40.0.12) SPS (10.10.0.11) Modbus TCP 502 Erlauben HMI (10.40.0.12) SPS (10.10.0.11) HTTP (WebVisu) 8080 Erlauben HMI (10.40.0.12) SPS (10.10.0.11) SSH 22 Blockieren Any Any Any Any Blockieren"},{"location":"exercises/ex7-segmentation-firewall.html#aufgabe-3-aktuelle-firewall-regeln-analysieren","title":"Aufgabe 3: Aktuelle Firewall-Regeln analysieren","text":"<ol> <li> <p>SSH zur <code>gw-firewall</code> (Mikrotik):     <pre><code>ssh admin@192.168.100.11\n</code></pre>     (Passwort: <code>admin</code>)</p> </li> <li> <p>Aktuelle Forwarding-Regeln anzeigen:     <pre><code>/ip firewall filter print where chain=forward\n</code></pre></p> </li> <li> <p>Suchen Sie nach der Regel, die Leitwarte (VLAN 40) zu Hygiene (VLAN 10) erlaubt.</p> <ul> <li>Sie sieht wahrscheinlich so aus: <code>action=accept chain=forward in-interface=vlan40 out-interface=vlan10</code></li> <li>Analyse: Diese Regel erlaubt alle Protokolle. Dies ist zu permissiv.</li> </ul> </li> </ol>"},{"location":"exercises/ex7-segmentation-firewall.html#aufgabe-4-restriktive-regeln-entwerfen-und-implementieren-optionalerweitert","title":"Aufgabe 4: Restriktive Regeln entwerfen und implementieren (Optional/Erweitert)","text":"<p>Hinweis: Diese Aufgabe erfordert Vertrautheit mit der RouterOS-Syntax. Gehen Sie mit Vorsicht vor.</p> <p>Wir m\u00f6chten die breite \"Allow VLAN 40 to VLAN 10\"-Regel durch spezifische Regeln f\u00fcr Modbus und HTTP ersetzen.</p>"},{"location":"exercises/ex7-segmentation-firewall.html#expertenansicht-komplexitat-vs-wartbarkeit","title":"Expertenansicht: Komplexit\u00e4t vs. Wartbarkeit","text":"<p>Warnung: Bei Firewall-Regels\u00e4tzen kann die Granularit\u00e4t sehr schnell sehr komplex werden. Es ist verlockend, extrem fein granulare Regeln zu erstellen (z.B. separate Regeln f\u00fcr jedes einzelne Ger\u00e4t, jeden Port, jede Protokollvariante), aber dies f\u00fchrt zu Regels\u00e4tzen mit hunderten von Eintr\u00e4gen, die niemand mehr versteht oder warten kann.</p> <p>H\u00e4ufige Fallen:</p> <ul> <li>Zu viele spezifische Host-zu-Host-Regeln statt zonenbasierter Regeln</li> <li>Mehrfache \u00fcberlappende Regeln, bei denen unklar ist, welche greift</li> <li>Fehlende Dokumentation oder veraltete Kommentare</li> <li>\"Notfall\"-Regeln, die tempor\u00e4r sein sollten, aber permanent werden</li> <li>Regeln, die niemand mehr zu l\u00f6schen wagt, weil unbekannt ist, was sie tun</li> </ul> <p>Empfehlung: Einfach und verwaltbar halten:</p> <ol> <li>Zonenbasierte Policies bevorzugen statt einzelne Hosts (z.B. \"VLAN 40 zu VLAN 10\" statt \"Host A zu Host B\")</li> <li>Serviceobjekte gruppieren (z.B. \"OT-Basisdienste\" = Modbus + OPC-UA + HTTP)</li> <li>Klare Namenskonventionen (z.B. \"ALLOW_LEITWARTE_zu_HYGIENE_OT-Services\")</li> <li>Regelm\u00e4ssig aufr\u00e4umen - Nicht verwendete Regeln entfernen</li> <li>Dokumentieren - Gesch\u00e4ftsbegr\u00fcndung in Kommentaren festhalten</li> <li>Testen - Vor Produktivsetzung in Testumgebung validieren</li> </ol> <p>Faustregel: Wenn Ihr Regelsatz mehr als 50 Regeln hat und keine klare Struktur, ist es Zeit f\u00fcr eine Vereinfachung. Ein gut gestalteter Regelsatz mit 20 verst\u00e4ndlichen Regeln ist sicherer als ein chaotischer mit 200 Regeln.</p> <ol> <li> <p>Spezifische Regeln hinzuf\u00fcgen (oben oder vor der Drop-Regel platziert):</p> <pre><code># Modbus TCP vom HMI zur SPS erlauben\n/ip firewall filter add chain=forward action=accept src-address=10.40.0.12 dst-address=10.10.0.11 protocol=tcp dst-port=502 comment=\"Allow HMI to PLC Modbus\" place-before=0\n\n# HTTP (WebVisu) vom HMI zur SPS erlauben\n/ip firewall filter add chain=forward action=accept src-address=10.40.0.12 dst-address=10.10.0.11 protocol=tcp dst-port=8080 comment=\"Allow HMI to PLC Web\" place-before=0\n</code></pre> </li> <li> <p>Breite Regel deaktivieren:     Finden Sie die Nummer der Regel <code>allow Control Room to Hygiene</code> mit <code>/ip firewall filter print</code>. Nehmen wir an, sie ist Nummer <code>X</code>.     <pre><code>/ip firewall filter disable X\n</code></pre></p> </li> <li> <p>\u00dcberpr\u00fcfen:</p> <ul> <li>K\u00f6nnen Sie noch von HMI aus auf die WebVisu zugreifen? (Sollte JA sein)</li> <li>K\u00f6nnen Sie per SSH vom HMI zur SPS? (Sollte NEIN sein, falls die Standard-Policy Drop ist oder keine andere Regel passt).</li> <li>Hinweis: Die aktuelle Lab-Konfiguration hat eine <code>default forward drop</code>-Regel, die <code>disabled=yes</code> ist. Um dies vollst\u00e4ndig durchzusetzen, m\u00fcssten Sie diese Drop-Regel am Ende aktivieren.</li> </ul> <pre><code># Standard-Drop-Regel am Ende aktivieren\n/ip firewall filter enable [find comment=\"default forward drop\"]\n</code></pre> </li> </ol>"},{"location":"exercises/ex7-segmentation-firewall.html#aufgabe-5-flat-vs-segmentiert-vergleichen","title":"Aufgabe 5: Flat vs. Segmentiert vergleichen","text":"<ol> <li> <p>Flaches Netzwerk:</p> <ul> <li>Angreifer auf HMI kann ARP-Spoofing auf die SPS durchf\u00fchren.</li> <li>Angreifer kann auf jeden Port auf der SPS zugreifen.</li> <li>Kein zentraler Punkt zum Filtern von Verkehr.</li> </ul> </li> <li> <p>Segmentiertes Netzwerk (mit Firewall):</p> <ul> <li>ARP-Spoofing ist auf das VLAN beschr\u00e4nkt.</li> <li>Firewall setzt Policy durch (z.B. \"Nur Modbus erlaubt\").</li> <li>Zentrales Logging von verweigerten Versuchen (falls Logging aktiviert ist).</li> </ul> </li> </ol>"},{"location":"exercises/ex7-segmentation-firewall.html#fazit","title":"Fazit","text":"<p>Segmentierung ist die Grundlage der OT-Sicherheit, muss aber von strikten Firewall-Regeln begleitet werden. Durch den Wechsel von \"Allow Any\" zu \"Allow Specific Ports\" reduzieren wir die Angriffsfl\u00e4che erheblich.</p>"},{"location":"exercises/ex7-segmentation-firewall.html#losung","title":"L\u00f6sung","text":"Zum Anzeigen der L\u00f6sung klicken"},{"location":"exercises/ex7-segmentation-firewall.html#aufgabe-1-kommunikationsflusse-kartieren_1","title":"Aufgabe 1: Kommunikationsfl\u00fcsse kartieren","text":"<p>Legitime Kommunikationspfade:</p> <ol> <li> <p>HMI (VLAN 40) \u2192 SPSen (VLAN 10, 20, 30)</p> <ul> <li>Modbus TCP (Port 502): JA - f\u00fcr Prozesssteuerung</li> <li>HTTP/WebVisu (Port 8080): JA - f\u00fcr Visualisierung</li> <li>OPC UA (Port 4840): JA - moderne Alternative</li> <li>SSH (Port 22): NEIN - nur f\u00fcr Engineering, nicht HMI</li> </ul> </li> <li> <p>Engineering-Station (VLAN 50) \u2192 SPSen</p> <ul> <li>CODESYS Runtime (Port 2455, 1217): JA - f\u00fcr Programmierung</li> <li>SSH (Port 22): JA - f\u00fcr Wartung</li> <li>HTTP (Port 8080): JA - f\u00fcr WebVisu-Zugriff</li> </ul> </li> <li> <p>SPSen \u2192 Internet</p> <ul> <li>NEIN - SPSen sollten keinen direkten Internet-Zugang haben</li> <li>Ausnahme: NTP f\u00fcr Zeitsynchronisation (kontrolliert \u00fcber Firewall)</li> </ul> </li> <li> <p>SPSen untereinander</p> <ul> <li>JA - Inter-Controller-Kommunikation m\u00f6glich</li> <li>Protokolle: Modbus TCP, OPC UA, propriet\u00e4re Protokolle</li> </ul> </li> </ol> <p>Antwort auf die Frage:</p> <ul> <li>Muss HMI per SSH in die SPS? NEIN - SSH ist f\u00fcr Engineering/Wartung, nicht f\u00fcr normale HMI-Funktionen</li> <li>Muss HMI SPS anpingen? JA - f\u00fcr Verf\u00fcgbarkeitspr\u00fcfungen ist ICMP sinnvoll</li> <li>Muss HMI auf Webserver zugreifen? JA - WebVisu l\u00e4uft auf HTTP (Port 8080)</li> </ul>"},{"location":"exercises/ex7-segmentation-firewall.html#aufgabe-2-kommunikationsmatrix-erstellen_1","title":"Aufgabe 2: Kommunikationsmatrix erstellen","text":"<p>Erweiterte Kommunikationsmatrix:</p> Quelle Ziel Protokoll Port Aktion Begr\u00fcndung HMI (10.40.0.12) SPS (10.10.0.11) Modbus TCP 502 ERLAUBEN Prozessdaten lesen/schreiben HMI (10.40.0.12) SPS (10.10.0.11) HTTP 8080 ERLAUBEN WebVisu-Zugriff HMI (10.40.0.12) SPS (10.10.0.11) OPC UA 4840 ERLAUBEN Alternative zu Modbus HMI (10.40.0.12) SPS (10.10.0.11) ICMP - ERLAUBEN Verf\u00fcgbarkeitspr\u00fcfung HMI (10.40.0.12) SPS (10.10.0.11) SSH 22 BLOCKIEREN Nicht f\u00fcr HMI-Betrieb n\u00f6tig EWS (10.50.0.11) SPS (10.10.0.11) SSH 22 ERLAUBEN Engineering/Wartung EWS (10.50.0.11) SPS (10.10.0.11) CODESYS 2455, 1217 ERLAUBEN Programmierung EWS (10.50.0.11) SPS (10.10.0.11) HTTP 8080 ERLAUBEN WebVisu-Konfiguration SPS (10.10.0.11) Internet Any Any BLOCKIEREN Keine direkte Internet-Verbindung Any Any Any Any BLOCKIEREN Default-Deny-Policy"},{"location":"exercises/ex7-segmentation-firewall.html#aufgabe-3-aktuelle-firewall-regeln-analysieren_1","title":"Aufgabe 3: Aktuelle Firewall-Regeln analysieren","text":"<p>SSH zur Firewall:</p> <pre><code>ssh admin@192.168.100.11\n</code></pre> <p>Passwort: <code>admin</code></p> <p>Alternativ mit sshpass (f\u00fcr Automatisierung): <pre><code>sshpass -p admin ssh admin@192.168.100.11\n</code></pre></p> <p>Firewall-Regeln anzeigen:</p> <pre><code>/ip firewall filter print where chain=forward\n</code></pre> <p>Erwartete Ausgabe (ot-sec-flat):</p> <pre><code>Flags: X - disabled, I - invalid; D - dynamic \n 0    ;;; allow established,related connections\n      chain=forward action=accept connection-state=established,related \n\n 1    ;;; allow forwarding ICMP\n      chain=forward action=accept protocol=icmp \n\n 2    ;;; allow SSH to the jumphost from internet\n      chain=forward action=accept protocol=tcp dst-address=2.2.2.2 \n      in-interface-list=ext dst-port=22 \n\n 3    ;;; allow all traffic from DMZ to VLAN10\n      chain=forward action=accept in-interface=dmz-ext out-interface=vlan10 \n\n 4    ;;; default forward drop\n      chain=forward action=accept log=yes log-prefix=\"default forward drop\"\n</code></pre> <p>Erwartete Ausgabe (ot-sec-segmented):</p> <pre><code>Flags: X - disabled, I - invalid; D - dynamic \n 0    ;;; allow established,related connections\n      chain=forward action=accept connection-state=established,related\n\n 1    ;;; allow forwarding ICMP\n      chain=forward action=accept protocol=icmp\n\n 2    ;;; allow SSH to the jumphost from internet\n      chain=forward action=accept protocol=tcp dst-address=2.2.2.2\n      in-interface-list=ext dst-port=22\n\n 3    ;;; allow Control Room to Hygiene\n      chain=forward action=accept in-interface=vlan40 out-interface=vlan10\n\n 4    ;;; allow Control Room to Process\n      chain=forward action=accept in-interface=vlan40 out-interface=vlan20\n\n 5    ;;; allow Control Room to Disposal\n      chain=forward action=accept in-interface=vlan40 out-interface=vlan30\n\n 6    ;;; allow Parameterization to Hygiene\n      chain=forward action=accept in-interface=vlan50 out-interface=vlan10\n\n ... weitere Regeln ...\n</code></pre> <p>Analyse:</p> <ul> <li>Flat-Topologie: Regel 3 erlaubt ALL traffic von DMZ zu VLAN 10 - zu permissiv</li> <li>Segmented-Topologie: Regel 3 erlaubt ALL traffic von VLAN 40 zu VLAN 10 - zu permissiv</li> <li>Problem: Keine Port-Einschr\u00e4nkungen, keine Protokoll-Spezifizierung</li> <li>Risiko: SSH, unn\u00f6tige Dienste sind erreichbar</li> </ul>"},{"location":"exercises/ex7-segmentation-firewall.html#aufgabe-4-restriktive-regeln-implementieren","title":"Aufgabe 4: Restriktive Regeln implementieren","text":"<p>WARNUNG: Diese \u00c4nderungen k\u00f6nnen die Netzwerkverbindung unterbrechen. In Produktion immer in Wartungsfenster durchf\u00fchren und Rollback-Plan haben.</p> <p>Schritt 1: Spezifische Regel f\u00fcr Modbus TCP hinzuf\u00fcgen</p> <pre><code>/ip firewall filter add chain=forward action=accept \\\n    src-address=10.40.0.12 dst-address=10.10.0.11 \\\n    protocol=tcp dst-port=502 \\\n    comment=\"Allow HMI to PLC Modbus\" place-before=0\n</code></pre> <p>Schritt 2: Spezifische Regel f\u00fcr WebVisu HTTP hinzuf\u00fcgen</p> <pre><code>/ip firewall filter add chain=forward action=accept \\\n    src-address=10.40.0.12 dst-address=10.10.0.11 \\\n    protocol=tcp dst-port=8080 \\\n    comment=\"Allow HMI to PLC WebVisu\" place-before=0\n</code></pre> <p>Schritt 3: Spezifische Regel f\u00fcr OPC UA hinzuf\u00fcgen</p> <pre><code>/ip firewall filter add chain=forward action=accept \\\n    src-address=10.40.0.12 dst-address=10.10.0.11 \\\n    protocol=tcp dst-port=4840 \\\n    comment=\"Allow HMI to PLC OPC-UA\" place-before=0\n</code></pre> <p>Schritt 4: Regeln \u00fcberpr\u00fcfen</p> <pre><code>/ip firewall filter print where chain=forward\n</code></pre> <p>Sie sollten jetzt die neuen spezifischen Regeln ganz oben sehen.</p> <p>Schritt 5: Breite \"Allow any\"-Regel identifizieren</p> <p>Finden Sie die Regel-Nummer der breiten Regel:</p> <pre><code>/ip firewall filter print where chain=forward\n</code></pre> <p>In <code>ot-sec-segmented</code>: Suchen Sie nach \"allow Control Room to Hygiene\" (z.B. Regel #3) In <code>ot-sec-flat</code>: Suchen Sie nach \"allow all traffic from DMZ to VLAN10\" (z.B. Regel #3)</p> <p>Schritt 6: Breite Regel deaktivieren</p> <pre><code>/ip firewall filter disable [find comment=\"allow Control Room to Hygiene\"]\n</code></pre> <p>Oder f\u00fcr flat: <pre><code>/ip firewall filter disable [find comment=\"allow all traffic from DMZ to VLAN10\"]\n</code></pre></p> <p>Schritt 7: Default-Drop aktivieren (Optional)</p> <p>In <code>ot-sec-flat</code> ist die Default-Drop-Regel tats\u00e4chlich auf \"accept\" gesetzt. Um echte Sicherheit zu haben:</p> <pre><code>/ip firewall filter set [find comment=\"default forward drop\"] action=drop\n</code></pre> <p>ACHTUNG: Dies blockiert allen Verkehr, der nicht explizit erlaubt ist. Stellen Sie sicher, dass alle notwendigen Regeln vorhanden sind!</p> <p>Schritt 8: Testen</p> <p>Von einem anderen Terminal (nicht \u00fcber SSH zur Firewall!):</p> <pre><code># Test 1: HMI kann WebVisu erreichen (sollte funktionieren)\ndocker exec clab-ot-sec-flat-pilz-hmi01-vlan40 curl -I --connect-timeout 3 http://10.10.0.11:8080\n\n# Test 2: HMI kann Modbus erreichen (sollte funktionieren)\ndocker exec clab-ot-sec-flat-pilz-hmi01-vlan40 nc -zv 10.10.0.11 502\n\n# Test 3: HMI kann SSH NICHT erreichen (sollte blockiert sein, falls Default-Drop aktiv)\ndocker exec clab-ot-sec-flat-pilz-hmi01-vlan40 nc -zv -w 2 10.10.0.11 22\n</code></pre> <p>Erwartete Ergebnisse:</p> <p>Test 1 &amp; 2: Erfolgreich Test 3: Connection timed out oder refused (wenn Default-Drop aktiv)</p> <p>Rollback (falls n\u00f6tig):</p> <pre><code># Breite Regel wieder aktivieren\n/ip firewall filter enable [find comment=\"allow Control Room to Hygiene\"]\n\n# Default-Drop wieder auf accept setzen\n/ip firewall filter set [find comment=\"default forward drop\"] action=accept\n</code></pre>"},{"location":"exercises/ex7-segmentation-firewall.html#aufgabe-5-flat-vs-segmentiert-vergleichen_1","title":"Aufgabe 5: Flat vs. Segmentiert vergleichen","text":"<p>Vergleichstabelle:</p> Aspekt Flat Network Segmented Network (mit Firewall) Broadcast-Dom\u00e4ne Eine grosse Dom\u00e4ne Mehrere kleine VLANs ARP-Spoofing-Reichweite Alle Ger\u00e4te betroffen Auf VLAN beschr\u00e4nkt Lateral Movement Einfach - direkter Zugang Schwierig - Firewall blockiert Angriffsfl\u00e4che Alle Ports auf allen Ger\u00e4ten Nur erlaubte Ports/Protokolle Verkehrsfilterung Keine Zentral an Firewall \u00dcberwachung Verteilt, komplex Zentral an Firewall Incident Response Schwierig zu isolieren Kann Zonen isolieren Compliance IEC-62443 SR 5.1 FAIL IEC-62443 SR 5.1 PASS <p>Angriffsszenario - Flat Network:</p> <ol> <li>Angreifer kompromittiert HMI (10.40.0.12)</li> <li>F\u00fchrt ARP-Spoofing durch \u2192 Man-in-the-Middle auf gesamtem Netzwerk</li> <li>Direkter Zugriff auf SPS \u00fcber SSH (Port 22)</li> <li>Direkter Zugriff auf alle Engineering-Ports</li> <li>Kann sich lateral zu allen anderen Ger\u00e4ten bewegen</li> <li>Keine zentrale \u00dcberwachung des Verkehrs</li> </ol> <p>Angriffsszenario - Segmented Network:</p> <ol> <li>Angreifer kompromittiert HMI (10.40.0.12 in VLAN 40)</li> <li>ARP-Spoofing nur in VLAN 40 m\u00f6glich</li> <li>Versuch, auf SPS (10.10.0.11 in VLAN 10) zuzugreifen</li> <li>Firewall blockiert SSH (Port 22) \u2192 Zugriff verweigert</li> <li>Firewall erlaubt nur Modbus, HTTP, OPC UA</li> <li>Firewall loggt alle Zugriffsversuche</li> <li>IDS/IPS kann Anomalien erkennen</li> <li>Security-Team wird alarmiert</li> <li>VLAN 10 kann isoliert werden ohne VLAN 40 zu beeinflussen</li> </ol> <p>Fazit:</p> <ul> <li>Flat Network: Einfach zu verwalten, aber katastrophal bei Kompromittierung</li> <li>Segmented Network: Komplexer, aber deutlich sicherer und IEC-62443-konform</li> <li>Best Practice: Segmentierung + spezifische Firewall-Regeln + Monitoring</li> </ul>"},{"location":"exercises/ex7-segmentation-firewall.html#zusatzliche-best-practices","title":"Zus\u00e4tzliche Best Practices","text":"<p>1. Logging aktivieren:</p> <pre><code>/ip firewall filter set [find comment=\"default forward drop\"] log=yes log-prefix=\"fw-drop\"\n</code></pre> <p>2. Address Lists f\u00fcr bessere Verwaltung:</p> <pre><code># HMI-Ger\u00e4te definieren\n/ip firewall address-list add list=hmi-devices address=10.40.0.12\n/ip firewall address-list add list=hmi-devices address=10.40.0.13\n\n# SPS-Ger\u00e4te definieren\n/ip firewall address-list add list=plc-devices address=10.10.0.11\n/ip firewall address-list add list=plc-devices address=10.10.0.12\n/ip firewall address-list add list=plc-devices address=10.20.0.11\n\n# Regel mit Address Lists\n/ip firewall filter add chain=forward action=accept \\\n    src-address-list=hmi-devices dst-address-list=plc-devices \\\n    protocol=tcp dst-port=502 \\\n    comment=\"Allow HMI to PLCs Modbus\"\n</code></pre> <p>3. Port-Objekte (Service Groups):</p> <pre><code># In RouterOS k\u00f6nnen Sie mit Address Lists arbeiten, aber keine Port-Groups\n# Alternative: Mehrere spezifische Regeln oder Kommentare zur Gruppierung\n</code></pre> <p>4. Regelm\u00e4ssige Audits:</p> <pre><code># Alle Regeln mit Z\u00e4hlern anzeigen\n/ip firewall filter print stats\n\n# Nicht genutzte Regeln identifizieren (bytes=0)\n/ip firewall filter print stats where bytes=0\n</code></pre> <p>5. Change Management:</p> <ul> <li>Alle Firewall-\u00c4nderungen dokumentieren</li> <li>Backup vor \u00c4nderungen erstellen:   <pre><code>/system backup save name=before-firewall-change\n</code></pre></li> <li>In Testumgebung validieren</li> <li>Schrittweise in Produktion ausrollen</li> </ul>"},{"location":"exercises/ex7-segmentation-firewall.html#zusammenfassung-lessons-learned","title":"Zusammenfassung: Lessons Learned","text":"<ol> <li>Segmentierung allein reicht nicht - Firewall-Regeln sind essentiell</li> <li>Default-Deny ist kritisch - \"Allow any\" macht Segmentierung wertlos</li> <li>Least Privilege durchsetzen - Nur absolut notwendige Ports erlauben</li> <li>Monitoring ist Pflicht - Logging und Alerting aktivieren</li> <li>Dokumentation ist entscheidend - Wissen, warum jede Regel existiert</li> <li>Testen, testen, testen - Vor Produktivsetzung validieren</li> <li>IEC 62443 SR 5.1 - Netzwerksegmentierung ist Grundanforderung</li> </ol>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html","title":"Security Analysis: OT Network Segmented Topology","text":"<p>Analysis Date: November 12, 2025 Topology: ot-sec-segmented.clab.yml Analyst: Security Assessment</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#executive-summary","title":"Executive Summary","text":"<p>This document provides a comprehensive security analysis of the segmented OT network architecture. The analysis evaluates the network against industry best practices including IEC 62443, NIST SP 800-82, and the Purdue Model for industrial networks.</p> <p>Overall Security Posture: MODERATE with CRITICAL VULNERABILITIES</p> <p>While the segmented architecture demonstrates several security improvements over flat networks, multiple critical and high-severity issues were identified that significantly compromise the security posture.</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#network-architecture-overview","title":"Network Architecture Overview","text":""},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#security-zones","title":"Security Zones","text":"<p>The network implements the following security zones:</p> <ul> <li>Internet Zone (1.1.1.0/24): External connectivity</li> <li>DMZ Zone (2.2.2.0/24, VLAN 60): Jumphost and external access</li> <li>VLAN 10 - Hygiene (10.10.0.0/24): Cleaning/hygiene processes</li> <li>VLAN 20 - Process (10.20.0.0/24): Main production processes</li> <li>VLAN 30 - Disposal (10.30.0.0/24): Waste disposal systems</li> <li>VLAN 40 - Control Room (10.40.0.0/24): HMI and SCADA systems</li> <li>VLAN 50 - Parameterization (10.50.0.0/24): Engineering workstations</li> </ul>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#network-devices","title":"Network Devices","text":"<ul> <li>gw-firewall (192.168.100.11): MikroTik RouterOS 7.18 - Gateway/Firewall</li> <li>sw-dist (192.168.100.12): MikroTik RouterOS 7.18 - Distribution Switch</li> <li>sw-acc1 (192.168.100.13): MikroTik RouterOS 7.18 - Access Switch 1</li> <li>sw-acc2 (192.168.100.14): MikroTik RouterOS 7.18 - Access Switch 2</li> </ul>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#critical-vulnerabilities","title":"Critical Vulnerabilities","text":""},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#1-firewall-bypass-default-allow-rule-critical","title":"1. FIREWALL BYPASS - DEFAULT ALLOW RULE (CRITICAL)","text":"<p>Location: <code>gw-firewall</code> line 81 <pre><code>/ip firewall filter add action=accept chain=forward comment=\"allow any for testing\" disabled=no\n</code></pre></p> <p>Risk Level: CRITICAL</p> <p>Impact: - This rule bypasses ALL firewall segmentation controls - Effectively creates a flat network despite VLAN segmentation - Negates the entire security architecture - Allows lateral movement between all zones - Permits unrestricted access from Control Room to Process zones - Enables direct access from DMZ to all internal zones</p> <p>Best Practice Violation: - IEC 62443-3-3: Zone and conduit security enforcement - NIST SP 800-82: Principle of least privilege - Defense-in-depth strategy completely compromised</p> <p>Recommendation: - IMMEDIATELY REMOVE this rule in production environments - Implement explicit deny-by-default policy - Add specific allow rules only for documented business requirements - Log all denied traffic for security monitoring</p> <p>Fix: <pre><code>/ip firewall filter remove [find comment=\"allow any for testing\"]\n# Ensure default drop rule is enabled\n/ip firewall filter set [find comment=\"default forward drop\"] disabled=no\n</code></pre></p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#2-weak-authentication-credentials-critical","title":"2. WEAK AUTHENTICATION CREDENTIALS (CRITICAL)","text":"<p>Location: All network devices and endpoints</p> <p>Current Configuration: <pre><code>Username: admin\nPassword: admin\n</code></pre></p> <p>Risk Level: CRITICAL</p> <p>Impact: - Trivial credential guessing attack - No defense against brute force - Enables unauthorized device access - Permits configuration tampering - Allows malware deployment to PLCs - Facilitates industrial espionage</p> <p>Best Practice Violation: - IEC 62443-3-3 SR 1.1: Human user identification and authentication - IEC 62443-3-3 SR 1.5: Authenticator management - NIST SP 800-53 IA-5: Authenticator management</p> <p>Recommendation: - Implement strong, unique passwords per device (minimum 16 characters) - Use centralized authentication (RADIUS/TACACS+) - Implement multi-factor authentication for critical systems - Enforce password complexity policies - Implement account lockout after failed attempts - Regular password rotation schedule</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#3-default-drop-rule-disabled-critical","title":"3. DEFAULT DROP RULE DISABLED (CRITICAL)","text":"<p>Location: <code>gw-firewall</code> line 83 <pre><code>/ip firewall filter add action=drop chain=forward comment=\"default forward drop\" disabled=yes\n</code></pre></p> <p>Risk Level: CRITICAL</p> <p>Impact: - No default-deny security posture - Unintended traffic may be permitted - Security policy violations may go undetected - Difficult to audit and verify security controls</p> <p>Best Practice Violation: - Fundamental security principle: Default deny - IEC 62443-3-3: Explicit security policies required</p> <p>Recommendation: <pre><code>/ip firewall filter set [find comment=\"default forward drop\"] disabled=no\n</code></pre></p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#high-severity-issues","title":"High-Severity Issues","text":""},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#4-overly-permissive-zone-to-zone-access-high","title":"4. OVERLY PERMISSIVE ZONE-TO-ZONE ACCESS (HIGH)","text":"<p>Location: <code>gw-firewall</code> firewall rules</p> <p>Current Configuration: <pre><code># DMZ can access Process and Control Room\nallow DMZ to Process (line 73)\nallow DMZ to Control Room (line 74)\n\n# Control Room can access all production zones\nallow Control Room to Hygiene (line 75)\nallow Control Room to Process (line 76)\nallow Control Room to Disposal (line 77)\n\n# Parameterization can access all zones\nallow Parameterization to all zones (lines 78-81)\n</code></pre></p> <p>Risk Level: HIGH</p> <p>Impact: - Violates Purdue Model separation of levels - Excessive lateral movement opportunities - Single compromised workstation can pivot to all zones - DMZ compromise leads to production access - Control Room compromise affects all processes</p> <p>Best Practice Violation: - IEC 62443-3-3: Minimize attack surface - Purdue Model: Strict level separation - NIST SP 800-82: Defense-in-depth</p> <p>Recommendation: - Implement granular, protocol-specific rules - Use application-layer filtering (deep packet inspection) - Restrict DMZ access to specific services only (e.g., SSH to jumphost) - Control Room should read-only access to production, not bidirectional - Parameterization should use time-limited access windows - Implement network access control (NAC)</p> <p>Example Improved Rules: <pre><code># DMZ to specific service only\n/ip firewall filter add action=accept chain=forward \\\n  in-interface=dmz-ext out-interface=vlan20 \\\n  protocol=tcp dst-port=502 src-address=2.2.2.2 \\\n  comment=\"DMZ: Jumphost Modbus to Process\"\n\n# Control Room read-only monitoring\n/ip firewall filter add action=accept chain=forward \\\n  in-interface=vlan40 out-interface=vlan20 \\\n  protocol=tcp dst-port=502 connection-state=new \\\n  comment=\"Control Room: Read-only Modbus to Process\"\n</code></pre></p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#5-no-protocol-filtering-or-dpi-high","title":"5. NO PROTOCOL FILTERING OR DPI (HIGH)","text":"<p>Location: All firewall rules</p> <p>Current Configuration: - Rules permit entire interface-to-interface traffic - No port-specific restrictions - No protocol validation - No application-layer inspection</p> <p>Risk Level: HIGH</p> <p>Impact: - Malicious traffic can use any protocol - No detection of protocol violations - Tunneling and encapsulation attacks possible - Cannot enforce industrial protocol security</p> <p>Best Practice Violation: - IEC 62443-3-3 SR 3.1: Communication integrity - NIST SP 800-82: Protocol validation</p> <p>Recommendation: - Implement port-specific rules for industrial protocols:   - Modbus TCP: 502   - EtherNet/IP: 44818, 2222   - OPC UA: 4840   - S7comm: 102   - BACnet: 47808 - Deploy industrial protocol firewall or DPI - Use protocol anomaly detection - Implement payload inspection where possible</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#6-unrestricted-icmp-high","title":"6. UNRESTRICTED ICMP (HIGH)","text":"<p>Location: <code>gw-firewall</code> lines 69-70 <pre><code>/ip firewall filter add action=accept chain=input comment=\"allow ICMP to the device\" protocol=icmp\n/ip firewall filter add action=accept chain=forward comment=\"allow forwarding ICMP\" protocol=icmp\n</code></pre></p> <p>Risk Level: HIGH</p> <p>Impact: - Network reconnaissance trivially easy - Zone mapping via ping sweeps - Enables covert channels - Facilitates DDoS amplification - Timing-based side-channel attacks</p> <p>Best Practice Violation: - IEC 62443-3-3 SR 7.6: Network and security configuration settings - Defense-in-depth: Minimize information disclosure</p> <p>Recommendation: - Rate-limit ICMP (max 5 packets/second) - Restrict ICMP types (allow only echo-request/reply, TTL-exceeded) - Block ICMP from external interfaces - Log excessive ICMP for anomaly detection</p> <p>Example Configuration: <pre><code>/ip firewall filter add action=accept chain=input \\\n  protocol=icmp icmp-options=8:0 limit=5,10:packet \\\n  comment=\"Rate-limited ping to device\"\n</code></pre></p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#7-no-network-access-control-nac-high","title":"7. NO NETWORK ACCESS CONTROL (NAC) (HIGH)","text":"<p>Location: Access switches sw-acc1 and sw-acc2</p> <p>Current Configuration: - BPDU guard enabled on edge ports (good) - Edge ports configured correctly (good) - No MAC authentication - No 802.1X authentication - No dynamic VLAN assignment</p> <p>Risk Level: HIGH</p> <p>Impact: - Rogue devices can connect to any VLAN - No device authentication before network access - Compromised devices can impersonate PLCs - Physical security bypass trivial</p> <p>Best Practice Violation: - IEC 62443-3-3 SR 1.7: Strength of password-based authentication - IEC 62443-3-3 SR 1.1: Unique identification and authentication - NIST SP 800-82: Network access control</p> <p>Recommendation: - Implement 802.1X authentication on all access ports - Use MAC authentication bypass (MAB) for devices without 802.1X - Deploy dynamic VLAN assignment based on device identity - Implement port security (MAC address limits) - Use guest VLAN for unknown devices - Monitor and alert on new MAC addresses</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#medium-severity-issues","title":"Medium-Severity Issues","text":""},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#8-dhcp-security-weaknesses-medium","title":"8. DHCP SECURITY WEAKNESSES (MEDIUM)","text":"<p>Location: <code>gw-firewall</code> DHCP configuration</p> <p>Current Configuration: - DHCP enabled on VLAN 10 only - Static IP reservations not visible - No DHCP snooping - No IP-MAC binding enforcement</p> <p>Risk Level: MEDIUM</p> <p>Impact: - DHCP spoofing possible - Rogue DHCP server attacks - IP address conflicts - ARP spoofing easier to execute - Man-in-the-middle attacks facilitated</p> <p>Best Practice Violation: - IEC 62443-3-3 SR 3.1: Communication integrity - NIST SP 800-82: Secure network protocols</p> <p>Recommendation: - Implement DHCP snooping on all switches - Configure trusted DHCP server ports only - Build DHCP binding database - Enable dynamic ARP inspection (DAI) - Use static IP assignments for critical assets (PLCs, HMI) - Implement IP Source Guard</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#9-no-network-segmentation-at-layer-2-medium","title":"9. NO NETWORK SEGMENTATION AT LAYER 2 (MEDIUM)","text":"<p>Location: sw-dist, sw-acc1, sw-acc2</p> <p>Current Configuration: - VLANs configured (good) - Proper VLAN tagging (good) - All VLANs visible on all trunk ports - No private VLANs - No VLAN pruning</p> <p>Risk Level: MEDIUM</p> <p>Impact: - VLAN hopping possible via double-tagging - Unnecessary broadcast domains - Higher attack surface - Lateral movement via layer 2</p> <p>Best Practice Violation: - Defense-in-depth principle - VLAN security best practices</p> <p>Recommendation: - Implement VLAN pruning (only allow needed VLANs on trunks) - Use native VLAN 99 (good practice already in place) - Disable DTP (Dynamic Trunking Protocol) - Consider Private VLANs for further isolation - Implement Q-in-Q for additional segmentation</p> <p>Example Configuration: <pre><code># Only allow necessary VLANs on each trunk\n/interface bridge vlan\n  # sw-dist to sw-acc1: Only VLANs 10,20,30,40,50\n  set [find comment=Parameterization] tagged=ether12,ether10 untagged=\"\"\n</code></pre></p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#10-weak-dns-security-medium","title":"10. WEAK DNS SECURITY (MEDIUM)","text":"<p>Location: <code>gw-firewall</code> DNS configuration</p> <p>Current Configuration: <pre><code>/ip dns set allow-remote-requests=yes\n</code></pre> - Static DNS entries configured - No DNSSEC validation - DNS open to all clients - No DNS filtering or threat intelligence</p> <p>Risk Level: MEDIUM</p> <p>Impact: - DNS cache poisoning possible - DNS hijacking attacks - No protection against malicious domains - Malware C2 via DNS tunneling - Data exfiltration via DNS</p> <p>Best Practice Violation: - NIST SP 800-81: Secure Domain Name System (DNS) Deployment Guide - IEC 62443-3-3 SR 3.1: Communication integrity</p> <p>Recommendation: - Implement DNS filtering (block malicious domains) - Enable DNSSEC validation - Use DNS RPZ (Response Policy Zones) - Restrict DNS to specific sources - Log DNS queries for anomaly detection - Use threat intelligence feeds - Consider DNS over HTTPS/TLS for external queries</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#11-no-time-synchronization-security-medium","title":"11. NO TIME SYNCHRONIZATION SECURITY (MEDIUM)","text":"<p>Location: <code>gw-firewall</code> NTP configuration</p> <p>Current Configuration: <pre><code>/system ntp server set enabled=yes\n</code></pre> - NTP server enabled - No authentication - No source restrictions - Accepts requests from anywhere</p> <p>Risk Level: MEDIUM</p> <p>Impact: - NTP amplification DDoS attacks - Time manipulation attacks - Log correlation issues - Certificate validation failures - Cryptographic key generation weaknesses</p> <p>Best Practice Violation: - NIST SP 1800-15: Securing Small-Business and Home IoT Devices - IEC 62443-3-3 SR 3.9: Protection of audit information</p> <p>Recommendation: - Implement NTP authentication (symmetric keys or Autokey) - Restrict NTP clients to known sources - Use NTP client mode only for firewall (don't serve time to internet) - Deploy dedicated NTP server in management network - Monitor for NTP anomalies</p> <p>Example Configuration: <pre><code># Restrict NTP to local networks only\n/ip firewall filter add action=accept chain=input \\\n  dst-port=123 protocol=udp \\\n  src-address-list=local-networks \\\n  comment=\"NTP from local only\"\n</code></pre></p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#12-management-interface-exposure-medium","title":"12. MANAGEMENT INTERFACE EXPOSURE (MEDIUM)","text":"<p>Location: <code>gw-firewall</code> input chain rules</p> <p>Current Configuration: <pre><code>/ip firewall filter add action=accept chain=input \\\n  comment=\"allow access from MGMT networks\" \\\n  src-address-list=mgmt\n</code></pre> - Entire RFC1918 space in mgmt list (10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16) - HTTP access allowed from jumphost - SSH access overly permissive</p> <p>Risk Level: MEDIUM</p> <p>Impact: - Lateral movement from compromised endpoints - Management interface attacks from production networks - Unnecessary attack surface</p> <p>Best Practice Violation: - IEC 62443-3-3 SR 1.3: Account management - Least privilege principle</p> <p>Recommendation: - Restrict management access to dedicated management VLAN only - Use jump server for all management access - Implement bastion host architecture - Disable unnecessary services (HTTP, Telnet) - Use SSH with key-based authentication only - Implement IP whitelisting for management - Two-factor authentication for critical devices</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#13-insufficient-logging-and-monitoring-medium","title":"13. INSUFFICIENT LOGGING AND MONITORING (MEDIUM)","text":"<p>Location: <code>gw-firewall</code> and all switches</p> <p>Current Configuration: - Remote syslog configured (good) - Default drop rules log (good when enabled) - No detailed traffic logging - No flow monitoring (NetFlow/IPFIX) - No IDS/IPS integration</p> <p>Risk Level: MEDIUM</p> <p>Impact: - Security incidents may go undetected - Difficult incident response and forensics - No baseline for anomaly detection - Cannot prove compliance</p> <p>Best Practice Violation: - IEC 62443-3-3 SR 3.3: Security audit - IEC 62443-2-1: Audit and accountability - NIST SP 800-82: Security event logging</p> <p>Recommendation: - Enable comprehensive logging:   - All firewall denies   - Authentication events   - Configuration changes   - Interface state changes - Deploy SIEM for log aggregation and correlation - Implement NetFlow/IPFIX for traffic analysis - Deploy IDS/IPS (Suricata/Snort with OT rulesets) - Regular log review and retention policy - Alert on critical events</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#14-no-network-redundancy-medium","title":"14. NO NETWORK REDUNDANCY (MEDIUM)","text":"<p>Location: Network topology</p> <p>Current Configuration: - Single uplink from sw-dist to gw-firewall - No bonding or link aggregation (despite \"bond\" comments) - Single point of failure at multiple levels - No spanning-tree configured for redundancy</p> <p>Risk Level: MEDIUM (Availability)</p> <p>Impact: - Single link failure causes zone isolation - Gateway failure causes complete outage - No high availability - Extended downtime in case of failure</p> <p>Best Practice Violation: - IEC 62443-3-3 SR 7.2: Resource management - High availability requirements for industrial systems</p> <p>Recommendation: - Implement link aggregation (LACP) between devices - Deploy redundant firewalls (VRRP/HSRP) - Configure spanning-tree (RSTP/MSTP) - Use ring topology for switches where possible - Implement redundant power supplies - Plan for firmware update redundancy</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#low-severity-issues","title":"Low-Severity Issues","text":""},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#15-unnecessary-services-enabled-low","title":"15. UNNECESSARY SERVICES ENABLED (LOW)","text":"<p>Location: All devices</p> <p>Services Observed: - HTTP enabled on firewall - DNS server on firewall - DHCP server on firewall - NTP server on firewall</p> <p>Risk Level: LOW</p> <p>Impact: - Increased attack surface - Additional vulnerability points - Resource consumption</p> <p>Recommendation: - Disable HTTP, use HTTPS only (or CLI only) - Deploy dedicated DNS server - Deploy dedicated DHCP server - Use NTP client mode only</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#16-mtu-configuration-low","title":"16. MTU CONFIGURATION (LOW)","text":"<p>Location: All links</p> <p>Current Configuration: - MTU 1500 on all links - VLAN interfaces MTU 1500</p> <p>Risk Level: LOW</p> <p>Impact: - Potential fragmentation issues - Suboptimal performance for jumbo frames - No impact on security</p> <p>Recommendation: - Consider MTU 9000 for internal OT networks (if devices support) - Ensure consistent MTU across paths - Not a security issue, but operational consideration</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#missing-security-controls","title":"Missing Security Controls","text":""},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#17-no-intrusion-detection-system-critical-missing","title":"17. NO INTRUSION DETECTION SYSTEM (CRITICAL MISSING)","text":"<p>Required: IDS/IPS with industrial protocol awareness</p> <p>Recommendation: - Deploy Suricata or Snort with ET-Open + OT-specific rulesets - Monitor for:   - Modbus function code anomalies   - Unauthorized PLC programming   - S7 PUT/GET commands   - OPC UA certificate violations - Place sensors at zone boundaries - Use span/mirror ports on switches for visibility</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#18-no-asset-inventory-and-management-high-missing","title":"18. NO ASSET INVENTORY AND MANAGEMENT (HIGH MISSING)","text":"<p>Required: Automated asset discovery and tracking</p> <p>Recommendation: - Deploy industrial asset management solution - Maintain device inventory with:   - Device type and manufacturer   - Firmware versions   - Network location   - Device function   - Security criticality rating - Automated vulnerability scanning (passive) - Configuration baseline monitoring</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#19-no-industrial-protocol-gateway-high-missing","title":"19. NO INDUSTRIAL PROTOCOL GATEWAY (HIGH MISSING)","text":"<p>Required: Protocol break for IT/OT boundary</p> <p>Recommendation: - Deploy industrial DMZ with protocol gateway - Break protocols at zone boundaries - Implement data diodes for one-way traffic - Use industrial firewall with DPI - Consider Claroty, Nozomi, or open-source alternatives</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#20-no-backup-and-recovery-procedures-medium-missing","title":"20. NO BACKUP AND RECOVERY PROCEDURES (MEDIUM MISSING)","text":"<p>Required: Configuration backups and disaster recovery</p> <p>Recommendation: - Automated daily configuration backups - Version control for network configurations - PLC program backups - Documented recovery procedures - Regular restoration testing - Offline backup storage</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#compliance-mapping","title":"Compliance Mapping","text":""},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#iec-62443-3-3-security-levels","title":"IEC 62443-3-3 Security Levels","text":"<p>Current Assessment: Security Level 1 (SL1) - Protection against casual or coincidental violation</p> <p>Target: Security Level 2 (SL2) - Protection against intentional violation using simple means</p> <p>Gap Analysis:</p> Requirement Current Status Gap SR 1.1 Human user identification Weak credentials HIGH SR 1.3 Account management No centralized auth MEDIUM SR 1.7 Password authentication Default passwords CRITICAL SR 2.1 Authorization enforcement Firewall bypassed CRITICAL SR 3.1 Communication integrity No protocol validation HIGH SR 3.3 Security audit Limited logging MEDIUM SR 5.1 Network segmentation VLANs present but bypassed CRITICAL SR 7.6 Network/security config Insecure defaults HIGH"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#nist-sp-800-82-recommendations","title":"NIST SP 800-82 Recommendations","text":"Recommendation Implementation Status Priority Network segmentation Partial - bypassed by firewall rule CRITICAL Access control Weak - default credentials CRITICAL Security monitoring Basic - needs enhancement HIGH Incident response Not addressed MEDIUM Defense-in-depth Partial implementation HIGH Secure protocols Not enforced HIGH"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#recommendations-summary","title":"Recommendations Summary","text":""},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#immediate-actions-critical-priority","title":"Immediate Actions (Critical Priority)","text":"<ol> <li>REMOVE \"allow any for testing\" firewall rule</li> <li>ENABLE default-drop firewall rule</li> <li>CHANGE all default passwords to strong, unique credentials</li> <li>IMPLEMENT explicit zone-to-zone rules with port restrictions</li> <li>DEPLOY IDS/IPS at zone boundaries</li> </ol>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#short-term-actions-30-days","title":"Short-Term Actions (30 days)","text":"<ol> <li>Implement 802.1X or MAC authentication on access ports</li> <li>Deploy centralized authentication (RADIUS)</li> <li>Configure protocol-specific firewall rules</li> <li>Implement DHCP snooping and dynamic ARP inspection</li> <li>Enable comprehensive logging and SIEM integration</li> <li>Deploy asset inventory system</li> <li>Rate-limit ICMP and restrict to essential types</li> <li>Implement DNS security measures</li> </ol>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#medium-term-actions-90-days","title":"Medium-Term Actions (90 days)","text":"<ol> <li>Deploy industrial protocol gateway at IT/OT boundary</li> <li>Implement redundancy (LACP, VRRP, spanning-tree)</li> <li>Establish configuration management and backup procedures</li> <li>Implement network access control (NAC)</li> <li>Deploy threat intelligence integration</li> <li>Conduct vulnerability assessment of OT devices</li> <li>Develop incident response procedures</li> </ol>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#long-term-actions-6-12-months","title":"Long-Term Actions (6-12 months)","text":"<ol> <li>Achieve IEC 62443-3-3 Security Level 2 compliance</li> <li>Implement security monitoring and SOC integration</li> <li>Deploy data diodes for critical unidirectional flows</li> <li>Implement multi-factor authentication</li> <li>Establish security awareness training program</li> <li>Regular penetration testing</li> <li>Continuous improvement process</li> </ol>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#conclusion","title":"Conclusion","text":"<p>The segmented network architecture demonstrates good foundational design with proper VLAN segmentation and zone definition. However, the critical \"allow any\" firewall rule completely negates the security benefits of this architecture, effectively creating a flat network.</p> <p>Key Findings:</p> <ul> <li>Architecture: Good (defense-in-depth design with zones)</li> <li>Implementation: Poor (security controls bypassed or disabled)</li> <li>Overall Risk: HIGH (critical vulnerabilities present)</li> </ul> <p>Priority Actions:</p> <ol> <li>Remove firewall bypass rule</li> <li>Enable default-drop policy</li> <li>Change all default passwords</li> <li>Implement granular access controls</li> <li>Deploy monitoring and detection capabilities</li> </ol> <p>Once these critical issues are addressed, the network will provide a solid foundation for industrial security. The current state leaves the network highly vulnerable to both external attacks and insider threats.</p>"},{"location":"llms/SECURITY_ANALYSIS_SEGMENTED_NETWORK.html#references","title":"References","text":"<ul> <li>IEC 62443-3-3: Industrial communication networks - Network and system security - Part 3-3: System security requirements and security levels</li> <li>NIST SP 800-82 Rev. 3: Guide to Operational Technology (OT) Security</li> <li>NIST SP 800-53 Rev. 5: Security and Privacy Controls for Information Systems and Organizations</li> <li>Purdue Enterprise Reference Architecture (PERA)</li> <li>ISA/IEC 62443 Standards Series</li> <li>SANS Industrial Control Systems Security Best Practices</li> </ul>"}]}